(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    767293,      18166]
NotebookOptionsPosition[    753960,      17948]
NotebookOutlinePosition[    754465,      17966]
CellTagsIndexPosition[    754422,      17963]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["eomccgen", "Title",
 CellChangeTimes->{{3.858323676094317*^9, 3.858323685587489*^9}, {
   3.860053063669647*^9, 3.860053080799135*^9}, 3.860567213204568*^9, {
   3.860658728132913*^9, 3.860658750101995*^9}, {3.860659713971147*^9, 
   3.86065972043897*^9}, {3.861948416617939*^9, 3.861948425045961*^9}, {
   3.876453977987728*^9, 3.87645397959604*^9}, 3.8764547510775967`*^9, {
   3.88848332256433*^9, 3.888483360315955*^9}, {3.8922628436796417`*^9, 
   3.892262850692889*^9}},ExpressionUUID->"60337e77-32f7-4c0c-ad67-\
85dc0cdc42d1"],

Cell[CellGroupData[{

Cell["Extra modules and functions", "Section",
 CellChangeTimes->{{3.8502124694131107`*^9, 3.850212483911498*^9}, {
   3.8508075976382303`*^9, 3.850807637386962*^9}, {3.85157491870508*^9, 
   3.8515749220559587`*^9}, {3.8515796859330683`*^9, 3.851579698913176*^9}, {
   3.858836125731333*^9, 3.85883613064154*^9}, 3.858836657468422*^9, {
   3.859628781424562*^9, 3.859628786169898*^9}, {3.887431861796212*^9, 
   3.887431864700734*^9}, {3.891066467743038*^9, 3.891066471058053*^9}, {
   3.892262837471383*^9, 
   3.892262859932382*^9}},ExpressionUUID->"1b8c064c-e9a6-48fb-b021-\
965f16e7d98c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "module", " ", "replace", " ", "and", " ", "evalauate", " ", 
    "contracted", " ", "strings", " ", "to", " ", "obtain", " ", "the", " ", 
    "sign"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sign", "[", 
     RowBox[{"list2_", ",", "Strings_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ls", ",", "let1", ",", "num1", ",", "parnum", ",", "l2", ",", "dim", 
        ",", "F6", ",", "F7", ",", "ln1"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ls", "=", 
        RowBox[{"{", "}"}]}], ";", "   ", 
       RowBox[{"let1", "=", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"num1", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Flatten", "[", "Strings", "]"}], "[", 
              RowBox[{"[", "i1", "]"}], "]"}], "[", 
             RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"ls", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Flatten", "[", "Strings", "]"}], "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"ls", ",", 
             RowBox[{
              RowBox[{"Flatten", "[", "Strings", "]"}], "[", 
              RowBox[{"[", "i1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", "Strings", "]"}], "]"}]}], "}"}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"let1", "=", 
        RowBox[{
         RowBox[{"ImportString", "[", 
          RowBox[{
           RowBox[{"ExportString", "[", 
            RowBox[{"ls", ",", "\"\<CSV\>\""}], "]"}], " ", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<CSV\>\"", ",", "\"\<RawData\>\""}], "}"}]}], "]"}], 
         " ", "//", "InputForm"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"let1", "=", 
        RowBox[{"Flatten", "/@", " ", "let1"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"num1", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"i1", ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"let1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"parnum", "=", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"let1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ln1", "=", 
        RowBox[{"Length", "[", "list2", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"l2", "[", "i1", "]"}], "=", 
          RowBox[{"Plus", "@@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Lookup", "[", 
               RowBox[{
                RowBox[{"AssociationThread", "[", 
                 RowBox[{
                  RowBox[{"let1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "->", "num1"}], "]"}], ",",
                 "#", ",", "0"}], "]"}], "&"}], "/@", 
             RowBox[{"ToString", "/@", 
              RowBox[{"Flatten", "[", 
               RowBox[{"list2", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "]"}]}]}], ")"}]}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", "ln1"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"F6", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i1", "<", "i2"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"l2", "[", "i3", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "*", "i1"}], "+", "1"}], "]"}], "]"}], "<", 
                  RowBox[{
                   RowBox[{"l2", "[", "i3", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "*", "i2"}], "+", "1"}], "]"}], "]"}], "<", 
                  RowBox[{
                   RowBox[{"l2", "[", "i3", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "*", "i1"}], "+", "2"}], "]"}], "]"}]}], "&&", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"l2", "[", "i3", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "*", "i1"}], "+", "2"}], "]"}], "]"}], "<", 
                  RowBox[{
                   RowBox[{"l2", "[", "i3", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "*", "i2"}], "+", "2"}], "]"}], "]"}]}]}], "||", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"l2", "[", "i3", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "*", "i2"}], "+", "1"}], "]"}], "]"}], "<", 
                  RowBox[{
                   RowBox[{"l2", "[", "i3", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "*", "i1"}], "+", "1"}], "]"}], "]"}], "<", 
                  RowBox[{
                   RowBox[{"l2", "[", "i3", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "*", "i2"}], "+", "2"}], "]"}], "]"}]}], "&&", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"l2", "[", "i3", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "*", "i2"}], "+", "2"}], "]"}], "]"}], "<", 
                  RowBox[{
                   RowBox[{"l2", "[", "i3", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "*", "i1"}], "+", "2"}], "]"}], "]"}]}]}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"F6", ",", 
                 RowBox[{"-", "1"}]}], "]"}], " ", ",", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"F6", ",", "1"}], "]"}]}], " ", "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i1", ",", "0", ",", 
             RowBox[{"parnum", "-", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i2", ",", 
             RowBox[{"parnum", "-", "1"}]}], "}"}]}], "]"}], " ", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i3", ",", 
           RowBox[{"Length", "[", "list2", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"F6", "==", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"dim", "=", "0"}], ",", 
         RowBox[{"dim", "=", 
          RowBox[{
           RowBox[{"Length", "[", "F6", "]"}], "/", 
           RowBox[{"Length", "[", "list2", "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"F7", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{"F6", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i1", "*", "dim"}], " ", "+", "i2"}], "]"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", "dim"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", "0", ",", 
            RowBox[{"ln1", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "F7", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.893148719219298*^9, 3.8931487421132517`*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"3f0aec66-9050-44b2-ae2c-5c06ec05ac87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "module", " ", "replace", " ", "the", " ", "the", " ", 
    "arbitraty", " ", "indexes", " ", "for", " ", "particle", " ", "or", " ", 
    "hole", " ", "indexes"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"krontonint", "[", 
     RowBox[{"list3_", ",", "Strings_", ",", "N_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"comp1", ",", "lint", ",", "comp2", ",", "L"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"list3", "===", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"L", "=", 
           RowBox[{"{", "}"}]}], ";", " ", 
          RowBox[{"comp2", "=", 
           RowBox[{"{", "}"}]}], ";"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"comp1", "=", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Complement", "[", " ", 
              RowBox[{
               RowBox[{"list3", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"q1", ",", "___"}], "}"}], "|", 
                  RowBox[{"{", 
                   RowBox[{"q2", ",", "___"}], "}"}], "|", 
                  RowBox[{"{", 
                   RowBox[{"q4", ",", "___"}], "}"}], "|", 
                  RowBox[{"{", 
                   RowBox[{"q3", ",", "___"}], "}"}], "|", 
                  RowBox[{"{", 
                   RowBox[{"___", ",", "q1"}], "}"}], "|", 
                  RowBox[{"{", 
                   RowBox[{"___", ",", "q2"}], "}"}], "|", 
                  RowBox[{"{", 
                   RowBox[{"___", ",", "q4"}], "}"}], "|", 
                  RowBox[{"{", 
                   RowBox[{"___", ",", "q3"}], "}"}]}], "]"}], "@", "  ", 
                RowBox[{"list3", "[", 
                 RowBox[{"[", "i1", "]"}], "]"}]}]}], "]"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", 
               RowBox[{"Length", "[", "list3", "]"}]}], "}"}]}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"lint", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Strings", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ">", "2"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"q1", ",", "q2", ",", "q3", ",", "q4"}], "}"}], " ", 
                "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"i1", ",", 
                 RowBox[{"Length", "[", "list3", "]"}]}], "}"}]}], "]"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"q1", ",", "q2"}], "}"}], " ", "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "->", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"comp1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"i1", ",", 
                 RowBox[{"Length", "[", "list3", "]"}]}], "}"}]}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"comp2", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"q1", ",", "___"}], "}"}], "|", 
                RowBox[{"{", 
                 RowBox[{"q2", ",", "___"}], "}"}], "|", 
                RowBox[{"{", 
                 RowBox[{"q4", ",", "___"}], "}"}], "|", 
                RowBox[{"{", 
                 RowBox[{"q3", ",", "___"}], "}"}], "|", 
                RowBox[{"{", 
                 RowBox[{"___", ",", "q1"}], "}"}], "|", 
                RowBox[{"{", 
                 RowBox[{"___", ",", "q2"}], "}"}], "|", 
                RowBox[{"{", 
                 RowBox[{"___", ",", "q4"}], "}"}], "|", 
                RowBox[{"{", 
                 RowBox[{"___", ",", "q3"}], "}"}]}], "]"}], "@", "  ", 
              RowBox[{"list3", "[", 
               RowBox[{"[", "i1", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
             
             RowBox[{"{", 
              RowBox[{"i1", ",", 
               RowBox[{"Length", "[", "list3", "]"}]}], "}"}]}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"L", "=", 
           RowBox[{"Part", "[", 
            RowBox[{"lint", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"comp2", "=", 
           RowBox[{"Part", "[", 
            RowBox[{"comp2", ",", "1"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"N", "==", "1"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "L", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"N", "==", "2"}], ",", 
           RowBox[{"Return", "[", 
            RowBox[{"{", "comp2", "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "lint", "]"}], "}"}], "]"}]}], "]"}]}], 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[77]:=",ExpressionUUID->"640196ee-c3f9-4f5b-a744-91a3bfc0728c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "Function", " ", "replace", " ", "\"\<{\>\"", " ", "and", 
    " ", "\"\<[\>\"", " ", "for", " ", "\"\<[[\>\""}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ChangeSqParforDSq", "[", "Quantitie_", "]"}], ":=", 
   RowBox[{"Quiet", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"ToExpression", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"StringReplace", "[", 
              RowBox[{"#1", ",", 
               RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<]]\>\""}]}], "]"}], "&"}],
             ")"}], "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"StringReplace", "[", 
               RowBox[{"#1", ",", 
                RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<[[\>\""}]}], "]"}], 
              "&"}], ")"}], "[", 
            RowBox[{"ExportString", "[", 
             RowBox[{"#1", ",", "\"\<CSV\>\""}], "]"}], "]"}], "]"}], "]"}], 
         "]"}], "&"}], ")"}], "/@", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"StringReplace", "[", 
               RowBox[{"#1", ",", 
                RowBox[{"\"\<}\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "&"}], 
             ")"}], "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{"#1", ",", 
                 RowBox[{"\"\<{\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "&"}],
               ")"}], "[", 
             RowBox[{"ExportString", "[", 
              RowBox[{
               RowBox[{"#1", "/.", "\[VeryThinSpace]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["t", "1"], "\[Rule]", "t1"}], ",", 
                  RowBox[{
                   SubscriptBox["t", "2"], "\[Rule]", "t2"}], ",", 
                  RowBox[{
                   SubscriptBox["t", "3"], "\[Rule]", "t3"}], ",", 
                  RowBox[{
                   SubscriptBox["t", "4"], "\[Rule]", "t4"}], ",", 
                  RowBox[{
                   SubscriptBox["t", "5"], "\[Rule]", "t5"}]}], "}"}]}], ",", 
               "\"\<CSV\>\""}], "]"}], "]"}], "]"}], "]"}], "]"}], "&"}], 
        ")"}], "/@", "Quantitie"}]}], "/.", "\[VeryThinSpace]", 
     RowBox[{
     "\[CapitalATilde]\.8f\[CapitalAHat]\.87", "\[Rule]", "\[Chi]"}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[78]:=",ExpressionUUID->"d84f8c34-9ce1-486e-b049-5642d8cbda76"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "module", " ", "generates", " ", "of", " ", "the", " ", "all",
     " ", "possible", " ", "contractions", " ", "of", " ", "a", " ", "given", 
    " ", "matrix", " ", "element"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CWick", "[", "sqstr_", "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"list2", ",", "list3", ",", "delkron"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"list2", ",", "list3", ",", "delkron"}], "}"}], "=", 
         RowBox[{"eomcontractexternal", "[", "sqstr", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"list2", ",", "list3", ",", "delkron"}], "}"}], "=", 
           RowBox[{"eomcontract", "[", "sqstr", "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Output\>\"", ",", "Bold", ",", "24"}], "]"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<Fully contrated term\>\"", ",", "Bold", ",", "Orange"}], "]"}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sign", "[", 
              RowBox[{
               RowBox[{"{", "#", "}"}], ",", "sqstr"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Partition", "[", 
                RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Partition", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"list2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "2"}]}], "]"}], 
                 "&"}], "@", 
                RowBox[{"Flatten", "[", "list2", "]"}]}], ")"}]}], ")"}]}], 
           "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Times", "@@", " ", "#"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Subscript", "[", 
                  RowBox[{"\[Delta]", ",", "#"}], "]"}], "&"}], "/@", 
                RowBox[{"Partition", "[", 
                 RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Partition", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"list2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "2"}]}], "]"}], 
                 "&"}], "@", 
                RowBox[{"Flatten", "[", "list2", "]"}]}], ")"}]}], ")"}]}], 
           ")"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RemoveContracted", "[", 
      RowBox[{"a1_", ",", "a2_", ",", "delkron_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"deletecontracted", ",", "delcont1", ",", "delcont2"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"deletecontracted", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Floor", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", "k1", "]"}], ",", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"delkron", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], "+", "1"}], 
                    ")"}], "/", "2"}], "]"}], " ", "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"i1", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"delkron", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                "]"}], "  ", "//", " ", "Flatten"}], " ", "//", " ", 
              "DeleteDuplicates"}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j1", ",", 
               RowBox[{"Length", "[", "delkron", "]"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", 
             RowBox[{"{", 
              RowBox[{"a1", ",", "a2"}], "}"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"deletecontracted", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"deletecontracted", "[", 
               RowBox[{"[", "l1", "]"}], "]"}], "[", 
              RowBox[{"[", "k1", "]"}], "]"}], "[", 
             RowBox[{"[", "j1", "]"}], "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l1", ",", 
             RowBox[{"Length", "[", "deletecontracted", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"deletecontracted", "[", 
               RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{"deletecontracted", "[", 
                RowBox[{"[", "l1", "]"}], "]"}], "[", 
               RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"delcont1", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Delete", "[", 
            RowBox[{"a1", ",", 
             RowBox[{
              RowBox[{"deletecontracted", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "j1", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"deletecontracted", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"delcont2", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Delete", "[", 
            RowBox[{"a2", ",", 
             RowBox[{
              RowBox[{"deletecontracted", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", "j1", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"deletecontracted", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"delcont1", ",", "delcont2"}], "}"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"selectcorrectcontract", "[", 
      RowBox[{"nonunicdisc_", ",", "Strings_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "cont", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cont", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", "nonunicdisc", "]"}], "]"}], "]"}], "==", 
            RowBox[{"2", 
             RowBox[{"Length", "[", "Strings", "]"}]}]}], ",", 
           "nonunicdisc"}], "]"}]}], " ", ";", " ", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "cont", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8526287766681952`*^9, 3.852628787988392*^9}, {
   3.8526288293025894`*^9, 3.852628831542564*^9}, {3.852629192058259*^9, 
   3.852629193308221*^9}, {3.852629439698511*^9, 3.852629441392788*^9}, 
   3.853564728902742*^9, {3.854093893363677*^9, 3.854093899123505*^9}, {
   3.854107476155182*^9, 3.854107485869829*^9}, {3.854107918263681*^9, 
   3.85410793976665*^9}, 3.858323030899839*^9, 3.8586717706523952`*^9, {
   3.858836110045773*^9, 3.858836142952353*^9}, {3.869569848453067*^9, 
   3.8695698963768044`*^9}, {3.871454157029682*^9, 3.8714541579555492`*^9}, {
   3.871960697879822*^9, 3.871960699378051*^9}, {3.872043987387521*^9, 
   3.8720439884802837`*^9}, {3.872235676648345*^9, 3.872235677695427*^9}, 
   3.872239609186417*^9, 3.873884417473219*^9, {3.873950005135022*^9, 
   3.873950006165221*^9}, {3.8740575868789263`*^9, 3.874057612945642*^9}, {
   3.874062200678677*^9, 3.874062208464533*^9}, {3.874390414706092*^9, 
   3.874390417602138*^9}, 3.874395086010051*^9, {3.874398305711453*^9, 
   3.8743983071960907`*^9}, {3.874400182138673*^9, 3.874400237649761*^9}, {
   3.874400291147744*^9, 3.874400292156527*^9}, {3.874404694945841*^9, 
   3.87440471749612*^9}, {3.8744706494297523`*^9, 3.874470650124021*^9}, {
   3.8745575265616627`*^9, 3.8745575278459377`*^9}, {3.8750055604226513`*^9, 
   3.875005591622548*^9}, {3.8750057474027147`*^9, 3.875005748182899*^9}, {
   3.875007034467967*^9, 3.875007035006282*^9}, {3.875085700271628*^9, 
   3.8750857104125233`*^9}, {3.875085744769845*^9, 3.8750857558961267`*^9}, 
   3.87509199763717*^9, {3.87509259386423*^9, 3.875092604898686*^9}, {
   3.8751689820036497`*^9, 3.87516898556632*^9}, {3.875169757361759*^9, 
   3.8751697731110497`*^9}, {3.8751736630472307`*^9, 
   3.8751736634541397`*^9}, {3.875590919399149*^9, 3.8755909213430653`*^9}, 
   3.87561386056814*^9, {3.8759382242079153`*^9, 3.875938225226067*^9}, {
   3.8764515940646772`*^9, 3.876451601203299*^9}, {3.8764764227611647`*^9, 
   3.876476456459012*^9}, {3.876476504234042*^9, 3.876476522001642*^9}, 
   3.876476556050539*^9, {3.8764765931964703`*^9, 3.876476637341012*^9}, {
   3.8764767124266653`*^9, 3.8764767585222883`*^9}, {3.87647880385577*^9, 
   3.876478805062677*^9}, {3.8765412117400227`*^9, 3.876541216193763*^9}, 
   3.87654141617789*^9, {3.876544072152307*^9, 3.876544085015476*^9}, {
   3.8765446681838017`*^9, 3.876544676013085*^9}, 3.8765451311872587`*^9, {
   3.876545981524226*^9, 3.876545992057579*^9}, {3.876549628700348*^9, 
   3.8765496400346746`*^9}, {3.876552654922326*^9, 3.876552666236319*^9}, {
   3.8765531114297743`*^9, 3.876553121306868*^9}, {3.8765532825831547`*^9, 
   3.876553291383691*^9}, {3.876554149472795*^9, 3.876554158700481*^9}, {
   3.876554477292754*^9, 3.876554478229725*^9}, {3.876554568666531*^9, 
   3.876554578372072*^9}, {3.876554876872505*^9, 3.876554887278171*^9}, {
   3.876554932652501*^9, 3.876554948159121*^9}, {3.8765549861385117`*^9, 
   3.876555017687264*^9}, {3.8775883068837957`*^9, 3.877588309091662*^9}, {
   3.87769919755348*^9, 3.877699221631906*^9}, {3.8842594535952682`*^9, 
   3.884259489842861*^9}, 3.8853873118037786`*^9, {3.8854565310965223`*^9, 
   3.885456531751882*^9}, {3.885902014887568*^9, 3.8859020152114077`*^9}, {
   3.887433347066554*^9, 3.887433362912197*^9}, {3.8874334082818327`*^9, 
   3.887433409712965*^9}, {3.8874334639390783`*^9, 3.887433477524508*^9}, {
   3.887433560728463*^9, 3.887433624479241*^9}, {3.887433687942443*^9, 
   3.887433688726173*^9}, {3.887441165650762*^9, 3.887441170558424*^9}, {
   3.88785916628734*^9, 3.887859189679192*^9}, {3.887859229453341*^9, 
   3.887859230835679*^9}, {3.8883948796386137`*^9, 3.8883948807080383`*^9}, {
   3.888395070745466*^9, 3.888395191371517*^9}, {3.890114122383515*^9, 
   3.8901141743872833`*^9}, 3.890130964277749*^9, 3.890131144065652*^9, {
   3.890131304516203*^9, 3.890131345936509*^9}, {3.890149788811089*^9, 
   3.8901498084964*^9}, {3.890189376357831*^9, 3.890189382136073*^9}, {
   3.89087809953622*^9, 3.890878138804772*^9}, {3.890878174047179*^9, 
   3.8908781787468348`*^9}, {3.890878222747286*^9, 3.8908782647543907`*^9}, {
   3.890878338260988*^9, 3.890878358067317*^9}, {3.89088580486794*^9, 
   3.890885809859004*^9}, 3.890886086021397*^9, {3.890886440688209*^9, 
   3.890886442368664*^9}, 3.890886735037331*^9, 3.8908932423547707`*^9, {
   3.8910580347882643`*^9, 3.891058128979375*^9}, {3.8910581605631237`*^9, 
   3.891058269060792*^9}, 3.891065202989421*^9, {3.891065239995488*^9, 
   3.891065321467197*^9}, {3.891065414939633*^9, 3.8910655157077427`*^9}, 
   3.8910659056751013`*^9, {3.8910659826732893`*^9, 3.891065983162395*^9}, 
   3.891332005155711*^9, 3.891333626545979*^9, {3.8914164681859093`*^9, 
   3.8914164701012*^9}, {3.8915761463135643`*^9, 3.89157617386794*^9}, {
   3.89158126423907*^9, 3.891581386732595*^9}, {3.891590010588151*^9, 
   3.891590034099626*^9}, {3.891590085226859*^9, 3.891590143124735*^9}, {
   3.891590175463994*^9, 3.891590217886615*^9}, {3.8921824368742533`*^9, 
   3.892182488024996*^9}, {3.8922609211995373`*^9, 3.892260940395903*^9}, {
   3.8922624848144903`*^9, 3.8922624893540077`*^9}, {3.8922627454297857`*^9, 
   3.892262769205822*^9}, {3.892273542973521*^9, 3.892273605424766*^9}, {
   3.893145635329509*^9, 3.893145647245016*^9}, {3.893148565373061*^9, 
   3.893148571040669*^9}, {3.893148612522415*^9, 3.893148647527958*^9}, 
   3.89314868892039*^9, {3.8931487519590483`*^9, 3.8931488617257643`*^9}, {
   3.8945869120759153`*^9, 3.894586916369512*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"ad2d5759-89d8-40d3-a748-224610d23fcc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Module", " ", "to", " ", "calculate", " ", "Hr", " ", "or", " ", "lH"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"HrorlH", "[", 
     RowBox[{"LeftRigthEOM_", ",", "Strings_", ",", "ManyBodyBlocks_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "BooleanLeftRigth", ",", "StringT", ",", "SQBraKet", ",", "SQwBraKet", 
        ",", "JustDeltaKronecker", ",", "DeltatoRule", ",", "PositionPH", ",",
         "RorLvector", ",", "JustManyBodyTerms", ",", "ManyBodyBlocksLorR"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"BooleanLeftRigth", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"LeftRigthEOM", "===", 
           RowBox[{"{", "\"\<R\>\"", "}"}]}], "||", 
          RowBox[{"LeftRigthEOM", "===", 
           RowBox[{"{", "\"\<r\>\"", "}"}]}]}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"StringT", "=", 
        RowBox[{"Strings", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SQBraKet", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"StringT", "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "[", 
                 RowBox[{"[", "i1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"StringT", "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "[", 
                 RowBox[{"[", "i1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"StringT", "[", 
                RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j1", ",", 
            RowBox[{"Length", "[", "StringT", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SQwBraKet", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], 
                    ",", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#1"}], "]"}], "&"}],
                  "/@", " ", "#"}], ")"}], "&"}], "/@", "#"}], ")"}], "&"}], "/@", 
           RowBox[{"SQBraKet", "[", 
            RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", 
            RowBox[{"Length", "[", "SQBraKet", "]"}]}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"JustDeltaKronecker", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cases", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\[Delta]", ",", 
                    RowBox[{"{", 
                    RowBox[{"_", ",", "_"}], "}"}]}], "]"}], ",", 
                    "Infinity"}], "]"}], "&"}], "/@", "  ", "#"}], ")"}]}], 
              " ", "&"}], "/@", " ", "#"}], ")"}], " ", "&"}], "/@", 
          "ManyBodyBlocks"}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"This", " ", "is", " ", "for", " ", "\"\<R and L\>\""}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"DeltatoRule", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Rule", "@@@", 
                RowBox[{"If", "[", 
                 RowBox[{"BooleanLeftRigth", ",", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Reverse", "[", "#", "]"}], "&"}], "/@", "#"}], 
                   ")"}], ",", "#"}], "]"}]}], "&"}], "/@", " ", "#"}], ")"}],
             "&"}], "/@", " ", 
           RowBox[{"JustDeltaKronecker", "[", 
            RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", 
            RowBox[{"Length", "[", "JustDeltaKronecker", "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"PositionPH", "=", 
        RowBox[{"Transpose", "@", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Flatten", "[", "#", "]"}], "&"}], "@", 
              RowBox[{"Position", "[", 
               RowBox[{"#", ",", "i1"}], "]"}]}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"StringTake", "[", " ", 
                    RowBox[{
                    RowBox[{"ToString", "[", "#", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "]"}], "===", 
                   "\"\<h\>\""}], "&"}], "/@", "#"}], ")"}], "&"}], "/@", 
              RowBox[{"If", "[", 
               RowBox[{"BooleanLeftRigth", ",", 
                RowBox[{
                 RowBox[{"SQwBraKet", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"SQwBraKet", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], ")"}]}],
            "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", 
             RowBox[{"{", 
              RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"RorLvector", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"BooleanLeftRigth", ",", "r", ",", "l"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Flatten", "@", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"If", "[", 
                   RowBox[{"BooleanLeftRigth", ",", "\[IndentingNewLine]", 
                    RowBox[{"Sort", "@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"SQwBraKet", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"PositionPH", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sort", "@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"SQwBraKet", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"PositionPH", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}]}]}], "]"}], 
                  ")"}], "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"i1", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"PositionPH", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], 
                "]"}]}]}], "]"}], "]"}], "\[IndentingNewLine]", "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j1", ",", 
            RowBox[{"Length", "[", "PositionPH", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"JustManyBodyTerms", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"Subscript", "[", 
                   RowBox[{"\[Delta]", ",", 
                    RowBox[{"{", 
                    RowBox[{"_", ",", "_"}], "}"}]}], "]"}], ",", 
                  "Infinity"}], "]"}], "&"}], "/@", "#"}], ")"}], "&"}], "/@",
             " ", "#"}], ")"}], "&"}], "/@", " ", "ManyBodyBlocks"}]}], ";", 
       "\[IndentingNewLine]", " ", 
       RowBox[{"ManyBodyBlocksLorR", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Total", "@", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Quiet", "[", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"RorLvector", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"JustManyBodyTerms", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], " ", "/.", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"DeltatoRule", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                   RowBox[{"[", "i1", "]"}], "]"}]}], ")"}], "]"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"i1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{
                   RowBox[{"JustManyBodyTerms", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
             ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"JustManyBodyTerms", "[", 
                RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{"Length", "[", "JustManyBodyTerms", "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", " ", "ManyBodyBlocksLorR", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.899198776410202*^9, 3.8991990542119427`*^9}, {
  3.8992091111101274`*^9, 3.899209130896841*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"8815d0e0-14e8-4c59-8dc4-657854ebcb50"]
}, Closed]],

Cell[CellGroupData[{

Cell["AmplStr  ", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.8502124694131107`*^9, 3.850212483911498*^9}, {
   3.8508075976382303`*^9, 3.850807637386962*^9}, {3.85157491870508*^9, 
   3.8515749220559587`*^9}, {3.8515796859330683`*^9, 3.851579698913176*^9}, {
   3.877520426883108*^9, 3.877520427957204*^9}, {3.8874317974112186`*^9, 
   3.887431856185697*^9}, {3.890149733487874*^9, 3.890149738743699*^9}, {
   3.89106648426544*^9, 3.8910664985052423`*^9}, 3.892262478118381*^9, 
   3.892262871054908*^9, 3.8992015810082903`*^9, 
   3.8992665256700277`*^9},ExpressionUUID->"45305d48-fb62-4d1f-b210-\
5af8db641bcf"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "AmplStr", " ", "requires", " ", "ClusterOperator", " ", "and", " ", 
    "EOMOperator", " ", "to", " ", "generate", " ", "the", " ", "Coupled", 
    " ", "Cluster", " ", "Amplitudes", " ", "and", " ", "the", " ", "Strings",
     " ", "which", " ", "correspond", " ", "to", " ", "the", " ", "EOM"}], 
   "-", 
   RowBox[{"CC", " ", "matrix", " ", "in", " ", "second"}], "-", 
   RowBox[{"quantized", " ", 
    RowBox[{"form", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.892262876736196*^9, 3.892262927233398*^9}, {
   3.892262971987235*^9, 3.892263031837388*^9}, {3.892267352486554*^9, 
   3.8922673613208733`*^9}, 3.892267417642708*^9},
 CellLabel->"In[83]:=",ExpressionUUID->"273c427f-a4ec-4188-91d7-53b2719b7f78"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AmplStr", "[", 
    RowBox[{"ClusterOperator_", ",", "EOMOperator_", ",", 
     RowBox[{"LeftRigthEOM", ":", 
      RowBox[{"{", "_String", "}"}], ":", "0"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "alphab", ",", "alphab1", ",", "ClusNum", ",", "EomNum", ",", 
       "EomNumClustNum", ",", "BooleanLeftRigth", ",", "ClustOp", ",", "Bra", 
       ",", "Ket", ",", "NonTruncPolinom", ",", "TruncNum", ",", 
       "TruncClustExp", ",", "Coefficients", ",", "prueb", ",", "numop0", ",",
        "numop1", ",", "numop2", ",", "Amplitudes", ",", "SQAmplitudes", ",", 
       "StringF", ",", "StringV", ",", "StringS"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"alphab", "=", 
       RowBox[{"{", 
        RowBox[{
        "Occ", ",", "p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5", ",", 
         "p6", ",", "p7", ",", "p8", ",", "p9", ",", "p10", ",", "Vir", ",", 
         "h1", ",", "h2", ",", "h3", ",", "h4", ",", "h5", ",", "h6", ",", 
         "h7", ",", "h8", ",", "h9", ",", "h10"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"alphab1", "=", 
       RowBox[{"{", 
        RowBox[{
        "Occ", ",", "v1", ",", "v2", ",", "v3", ",", "v4", ",", "v5", ",", 
         "v6", ",", "v7", ",", "v8", ",", "v9", ",", "v10", ",", "Vir", ",", 
         "o1", ",", "o2", ",", "o3", ",", "o4", ",", "o5", ",", "o6", ",", 
         "o7", ",", "o8", ",", "o9", ",", "o10"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ClusNum", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"#", ",", "_Integer"}], "]"}], "&"}], " ", "/@", 
        RowBox[{"ToExpression", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"Characters", " ", "@", "ClusterOperator"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"EomNum", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"#", ",", "_Integer"}], "]"}], "&"}], " ", "/@", 
        RowBox[{"ToExpression", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"Characters", " ", "@", "EOMOperator"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Determine", " ", "the", " ", "base", " ", "in", " ", "which", " ", 
        "the", " ", "similarity", " ", "transformed", " ", "Hamiltonian", " ",
         "is", " ", "diagobalized"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"EomNumClustNum", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"Flatten", "[", "EomNum", "]"}], "]"}], "==", "0"}], ",", 
         "ClusNum", ",", "EomNum"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"BooleanLeftRigth", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"LeftRigthEOM", "===", 
          RowBox[{"{", "\"\<R\>\"", "}"}]}], "||", 
         RowBox[{"LeftRigthEOM", "===", 
          RowBox[{"{", "\"\<r\>\"", "}"}]}], "||", 
         RowBox[{"LeftRigthEOM", "===", "0"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Bra", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"BooleanLeftRigth", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Map", "[", "SuperDagger", "]"}], "@", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Map", "[", "SuperDagger", "]"}], "@", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "&"}], "@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"alphab", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"Position", "[", 
                    RowBox[{"alphab", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Vir", ",", "Occ"}], "}"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ";;", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"Position", "[", 
                    RowBox[{"alphab", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Vir", ",", "Occ"}], "}"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", 
                 RowBox[{
                  RowBox[{"EomNumClustNum", "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "[", 
                  RowBox[{"[", "i1", "]"}], "]"}]}]}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"EomNumClustNum", "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
          " ", "//", " ", "Flatten"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j1", ",", 
           RowBox[{"Length", "[", "EomNumClustNum", "]"}]}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Ket", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"BooleanLeftRigth", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Map", "[", "SuperDagger", "]"}], "@", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Map", "[", "SuperDagger", "]"}], "@", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "&"}], "@", "\[IndentingNewLine]", 
           RowBox[{"Reverse", "[", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"alphab", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"alphab", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Vir", ",", "Occ"}], "}"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "+", 
                  RowBox[{"Max", "[", 
                   RowBox[{"Flatten", "[", "EomNumClustNum", "]"}], "]"}], 
                  "+", "1"}], ";;", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"alphab", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Vir", ",", "Occ"}], "}"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "+", 
                  RowBox[{
                   RowBox[{"EomNum", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                   RowBox[{"[", "i1", "]"}], "]"}], "+", 
                  RowBox[{"Max", "[", 
                   RowBox[{"Flatten", "[", "EomNumClustNum", "]"}], "]"}]}]}],
                 "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"EomNum", "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "]"}]}], "//", " ", "Flatten"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j1", ",", 
           RowBox[{"Length", "[", "EomNum", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", "temp", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"BooleanLeftRigth", ",", "Null", ",", 
        RowBox[{
         RowBox[{"temp", "=", "Bra"}], ";", "   ", 
         RowBox[{"Bra", "=", "Ket"}], ";", " ", 
         RowBox[{"Ket", "=", "temp"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ClustOp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         SubscriptBox["T", "i1"], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", 
           RowBox[{"ClusNum", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Non", " ", "Truncated", " ", "Clsuter", " ", "Expansion"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"NonTruncPolinom", "=", 
       RowBox[{
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Series", "[", 
            RowBox[{
             RowBox[{"Exp", "[", "p", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "0", ",", "4"}], "}"}]}], "]"}], "]"}], " ", "/.",
           "  ", 
          RowBox[{"p", " ", "->", " ", 
           RowBox[{"(", 
            RowBox[{"ClustOp", " ", "//", " ", "Total"}], ")"}]}]}], "]"}], 
        " ", "/.", 
        RowBox[{"Plus", " ", "->", " ", "List"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[ScriptT]", "i1"], "=", 
         RowBox[{"Exponent", "[", 
          RowBox[{"NonTruncPolinom", ",", 
           SubscriptBox["T", "i1"]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i1", ",", 
          RowBox[{"ClustOp", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TruncNum", "=", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"2", "*", "i1", " ", 
            SubscriptBox["\[ScriptT]", "i1"]}], ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", 
             RowBox[{"ClustOp", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "<=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "#", "]"}], "&"}], "/@", "Bra"}], 
                 "]"}], "-", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "#", "]"}], "&"}], "/@", "Ket"}], 
                 "]"}]}], ")"}], "+", "4"}]}], "&"}], ")"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Truncated", " ", "Cluster", " ", "Expancion"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"TruncClustExp", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"NonTruncPolinom", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", "TruncNum"}], "}"}]}], "]"}], "  ", "//", " ", 
        "Flatten"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numop0", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"TruncClustExp", ",", 
           SubscriptBox["T", "i1"]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", 
           RowBox[{"ClustOp", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"numop1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"numop0", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], " ", 
          RowBox[{
           RowBox[{"ClustOp", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "[", 
           RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", 
           RowBox[{"Length", "[", "numop0", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numop2", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Map", "[", "Total", "]"}], " ", "@", 
          RowBox[{"Transpose", "@", 
           RowBox[{"numop1", "[", 
            RowBox[{"[", 
             RowBox[{";;", "i1"}], "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", 
           RowBox[{"Length", "[", "numop1", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Coefficients", "=", 
         RowBox[{"TruncClustExp", " ", "/.", "  ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["T", "i1"], "  ", "->", " ", 
             RowBox[{"1", "/", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"i1", "!"}], ")"}], "2"]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"ClustOp", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}],
         ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Extract", " ", "and", " ", "sort", " ", "the", " ", "letters", " ", 
        "of", " ", "the", " ", "aphabet", " ", "to", " ", "generate", " ", 
        "the", " ", "excitations"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"prueb", "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"numop1", "[", 
                   RowBox[{"[", "k1", "]"}], "]"}], "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "==", "0"}], "||", 
                RowBox[{"k1", "<=", "1"}]}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"alphab1", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"alphab1", ",", "Vir"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ";;", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"alphab1", ",", "Vir"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"numop1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}]}], "]"}], "]"}], ",", 
                 RowBox[{"alphab1", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"alphab1", ",", "Occ"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ";;", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"alphab1", ",", "Occ"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"numop1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}]}], "]"}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"alphab1", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"alphab1", ",", "Vir"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "1", "+", 
                    RowBox[{
                    RowBox[{"numop2", "[", 
                    RowBox[{"[", 
                    RowBox[{"k1", "-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}], ";;", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"alphab1", ",", "Vir"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"numop2", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}]}], "]"}], "]"}], ",", 
                 RowBox[{"alphab1", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"alphab1", ",", "Occ"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "1", "+", 
                    RowBox[{
                    RowBox[{"numop2", "[", 
                    RowBox[{"[", 
                    RowBox[{"k1", "-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}], ";;", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"alphab1", ",", "Occ"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"numop2", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}]}], "]"}], "]"}]}], 
                "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"numop2", "[", 
                RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
          "  ", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Vir", "->", 
             RowBox[{"Sequence", "[", "]"}]}], ",", 
            RowBox[{"Occ", "->", 
             RowBox[{"Sequence", "[", "]"}]}]}], "}"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", 
           RowBox[{"Length", "[", "numop2", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Obtain", " ", "the", " ", "Coupled", " ", "Cluster", " ", 
        "amplitudes"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Amplitudes", "=", 
       RowBox[{"{", 
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Map", "[", "Flatten", "]"}], "@", 
            RowBox[{"Transpose", " ", "@", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Table", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["t", 
                    RowBox[{
                    RowBox[{"ClustOp", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}]], "@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"numop1", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "===", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{
                    RowBox[{"prueb", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], ",", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"prueb", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"ClustOp", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"numop1", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], ",", 
                    RowBox[{"-", "j1"}]}], "]"}]}], "]"}], "]"}]}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"{", 
                    RowBox[{"j1", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"i1", ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{
                    RowBox[{"ClustOp", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"numop1", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"ClustOp", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}]}], "}"}]}], "]"}]}], 
                    "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"k1", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"numop1", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"l1", ",", 
                 RowBox[{"Length", "[", "numop1", "]"}]}], "}"}]}], "]"}]}]}],
            " ", "/.", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "}"}], "->", " ", 
             RowBox[{"Sequence", "[", "]"}]}], "}"}]}], ",", 
          RowBox[{"{", "}"}]}], "]"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Obtain", " ", "the", " ", "Secaond", " ", "quantized", " ", 
        "operators", " ", "asociated", " ", "with", " ", "Coupled", " ", 
        "Cluster", " ", "amplitudes"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"SQAmplitudes", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Amplitudes", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "m1", "]"}], "]"}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{
            RowBox[{"Amplitudes", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "m1", "]"}], "]"}], ",", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Amplitudes", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Amplitudes", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}]}], 
                    "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"Map", "[", "SuperDagger", "]"}], "@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Amplitudes", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Amplitudes", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}], "+", 
                    "1"}], ";;"}], "]"}], "]"}]}]}], "}"}], "]"}], "[", 
                RowBox[{"[", "k1", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"k1", ",", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Reverse", "/@", 
                   RowBox[{"Transpose", "@", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"i1", ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Amplitudes", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Amplitudes", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}]}], 
                    "]"}]}]}], "]"}]}], "}"}]}], "]"}], "\[IndentingNewLine]",
              ",", 
             RowBox[{"{", 
              RowBox[{"l1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{"Amplitudes", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "m1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
          "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"m1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"Amplitudes", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Bra", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"Flatten", "[", "EomNum", "]"}], "]"}], "==", "0"}], ",", 
         RowBox[{"Insert", "[", 
          RowBox[{"Bra", ",", 
           RowBox[{"{", "}"}], ",", "1"}], "]"}], ",", "Bra"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringF", "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Bra", "[", 
                RowBox[{"[", "l1", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 SuperscriptBox["q1", "\[Dagger]"], ",", "q2"}], "}"}], ",", 
               RowBox[{"SQAmplitudes", "[", 
                RowBox[{"[", "j1", "]"}], "]"}], ",", 
               RowBox[{"Ket", "[", 
                RowBox[{"[", "k1", "]"}], "]"}]}], "}"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j1", ",", 
               RowBox[{"Length", "[", "SQAmplitudes", "]"}]}], "}"}]}], "]"}],
            "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", 
             RowBox[{"Length", "[", "Ket", "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"l1", ",", 
           RowBox[{"Length", "[", "Bra", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringV", "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Bra", "[", 
                RowBox[{"[", "l1", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 SuperscriptBox["q1", "\[Dagger]"], ",", 
                 SuperscriptBox["q2", "\[Dagger]"], ",", "q4", ",", "q3"}], 
                "}"}], ",", 
               RowBox[{"SQAmplitudes", "[", 
                RowBox[{"[", "j1", "]"}], "]"}], ",", 
               RowBox[{"Ket", "[", 
                RowBox[{"[", "k1", "]"}], "]"}]}], "}"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j1", ",", 
               RowBox[{"Length", "[", "SQAmplitudes", "]"}]}], "}"}]}], "]"}],
            "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", 
             RowBox[{"Length", "[", "Ket", "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"l1", ",", 
           RowBox[{"Length", "[", "Bra", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"StringS", "=", 
       RowBox[{"{", 
        RowBox[{"StringF", ",", "StringV"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"Amplitudes", ",", "StringS"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.876469479707465*^9, 3.876469541626397*^9}, {
   3.876469833025949*^9, 3.876469834295375*^9}, {3.876469962692398*^9, 
   3.8764700219866323`*^9}, {3.876470087520525*^9, 3.8764701116505938`*^9}, {
   3.876470361899016*^9, 3.87647039448167*^9}, 3.876827662335021*^9, 
   3.876827801970155*^9, {3.8873557883372517`*^9, 3.887355789959927*^9}, 
   3.887447999616041*^9, 3.888389426186451*^9, 3.8883894899811573`*^9, {
   3.89014971678718*^9, 3.890149717984064*^9}, {3.8901513834893312`*^9, 
   3.890151417086669*^9}, 3.890179907040265*^9, {3.890189333464217*^9, 
   3.890189340494206*^9}, {3.890190296251422*^9, 3.890190304545581*^9}, {
   3.890227441294989*^9, 3.890227450215667*^9}, 3.8908132111025352`*^9, {
   3.8908136271019087`*^9, 3.8908136569625797`*^9}, {3.890877463341674*^9, 
   3.890877481823605*^9}, 3.890879378582157*^9, {3.8910577214177313`*^9, 
   3.8910577214337273`*^9}, {3.8910595688482733`*^9, 
   3.8910595847617683`*^9}, {3.891331089315598*^9, 3.891331132611553*^9}, {
   3.891332136350214*^9, 3.89133213743365*^9}, {3.891332171915275*^9, 
   3.8913321999752293`*^9}, 3.891332355168339*^9, {3.891419456808421*^9, 
   3.891419459214349*^9}, {3.8914195287818117`*^9, 3.891419585109877*^9}, {
   3.891420099553585*^9, 3.8914201001067333`*^9}, {3.891581183709898*^9, 
   3.8915812051316547`*^9}, {3.892182069030719*^9, 3.892182084759596*^9}, 
   3.892262479419626*^9, {3.892262937997223*^9, 3.8922629380129023`*^9}, {
   3.892263107545919*^9, 3.892263122141374*^9}, {3.894586938670865*^9, 
   3.894586940083849*^9}, {3.898926237479339*^9, 3.898926301120777*^9}, 
   3.8989267646134005`*^9, {3.8989271843659067`*^9, 3.8989272010994616`*^9}, {
   3.8989398002571363`*^9, 3.898939801319401*^9}, {3.899199846686528*^9, 
   3.8991998605262966`*^9}, {3.899258727094612*^9, 3.8992587614056187`*^9}, {
   3.899258827564337*^9, 3.8992588455832386`*^9}, {3.8992601031211944`*^9, 
   3.8992601125171204`*^9}, 3.899266414154997*^9},
 CellLabel->"In[84]:=",ExpressionUUID->"ca81e8f7-53c9-4895-bc77-7844713abb6f"]
}, Closed]],

Cell[CellGroupData[{

Cell["ManyBodyHamiltonian ", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.8502124694131107`*^9, 3.850212483911498*^9}, {
   3.8508075976382303`*^9, 3.850807637386962*^9}, {3.85157491870508*^9, 
   3.8515749220559587`*^9}, {3.8515796859330683`*^9, 3.851579698913176*^9}, {
   3.877520426883108*^9, 3.877520427957204*^9}, {3.884340155021543*^9, 
   3.88434027692699*^9}, {3.887431783420391*^9, 3.887431793894289*^9}, {
   3.887431858495245*^9, 3.887431858530387*^9}, {3.891066509502339*^9, 
   3.891066513849218*^9}, 
   3.892263141262623*^9},ExpressionUUID->"5c729b93-e4ec-40a4-bfbd-\
8ff5fa424dcf"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "The", " ", "module", " ", "requires", " ", "the", " ", "input", " ", 
     "StringS", " ", "to", " ", "generate", " ", "a", " ", "unique", " ", 
     "list", " ", "of", " ", "many"}], "-", 
    RowBox[{
    "body", " ", "terms", " ", "in", " ", "second", " ", "quantized", " ", 
     "form", " ", 
     RowBox[{"i", ".", "e", ".", "  ", "ManyBodyStrings"}]}]}], " ", "=", " ", 
   FormBox[
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Chi]", 
       RowBox[{"p", ",", "q"}]], ",", 
      SubscriptBox["\[Chi]", 
       RowBox[{"p", ",", "q", ",", "r", ",", "s"}]], ",", 
      SubscriptBox["\[Chi]", 
       RowBox[{"p", ",", "q", ",", "r", ",", "s", ",", "t", ",", "u", ","}]], 
      ",", "..."}], "}"}],
    TraditionalForm]}], "*)"}]], "Input",
 CellChangeTimes->{{3.892263145684202*^9, 3.892263188662774*^9}, {
  3.8922632350769453`*^9, 3.892263264054186*^9}, {3.89226743512183*^9, 
  3.89226743849461*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"3f09b14d-1926-4c2f-8030-c8d745e0bf99"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ManyBodyHamiltonian", "[", "StringS_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "StringT", ",", "SQBraKet", ",", "lCre", ",", "lAnh", ",", 
      "ExternContract", ",", "ExtDelKron", ",", "PreInter", ",", "DelKron2", 
      ",", "ManbodyTerms0", ",", "ManbodyTerms1", ",", "ManyBodyTermsV", ",", 
      "ManyBodyTermsF", ",", "PosManyBody0", ",", "ManyBodyBlock0", ",", 
      "DelKron1", ",", "ManyBodyBlock1", ",", "TFHolesMB0", ",", "TFHolesMB1",
       ",", "PositZeroTerms", ",", "ManyBodyBlock2", ",", "PositZeroTerms1", 
      ",", "ManyBodyBlock3", ",", "ManyBodyBlock4", ",", "ManyBodyHOp0", ",", 
      "ManyBodyHOp1", ",", "MBTwS0", ",", "MBTwS1", ",", "MBTwS2", ",", 
      "SepBraKet", ",", "ConractManyBodyStr", ",", "KronMany", ",", 
      "StringBraHamKet", ",", "SignManyBody", ",", "PreManyBody", ",", 
      "ManyBodyStrings", ",", "SQwBraKet", ",", "PosCont", ",", 
      "IntervalContMatch", ",", "SignContDelt", ",", "NonContractedPos", ",", 
      "NonContracteInter"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"StringT", "=", 
      RowBox[{"StringS", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Exctract", " ", "the", " ", "Second", " ", "Quantized", " ", 
       "operators", " ", "form", " ", "the", " ", "Bra", " ", "and", " ", 
       "the", " ", "Ket"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"SQBraKet", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringT", "[", 
                RowBox[{"[", "j1", "]"}], "]"}], "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringT", "[", 
                RowBox[{"[", "j1", "]"}], "]"}], "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"StringT", "[", 
              RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"j1", ",", 
          RowBox[{"Length", "[", "StringT", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lCre", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"SQBraKet", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                   RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], 
                 ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"SQBraKet", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "[", 
                  RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"SQBraKet", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{"SQBraKet", "[", 
                  RowBox[{"[", "l1", "]"}], "]"}], "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"SQBraKet", "[", 
               RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"l1", ",", 
           RowBox[{"Length", "[", "SQBraKet", "]"}]}], "}"}]}], "]"}], " ", "/.",
        " ", 
       RowBox[{"Null", " ", "->", " ", 
        RowBox[{"Sequence", "[", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lAnh", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"SQBraKet", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                   RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], 
                 ",", "Null", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"SQBraKet", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "[", 
                  RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"SQBraKet", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{"SQBraKet", "[", 
                  RowBox[{"[", "l1", "]"}], "]"}], "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"SQBraKet", "[", 
               RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"l1", ",", 
           RowBox[{"Length", "[", "SQBraKet", "]"}]}], "}"}]}], "]"}], "/.", 
       " ", 
       RowBox[{"Null", " ", "->", " ", 
        RowBox[{"Sequence", "[", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Quick", " ", 
       RowBox[{"Wick", "'"}], "s", " ", "Contract", " ", "between", " ", 
       "the", " ", "Bra", " ", "and", " ", "the", " ", "Ket"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ExternContract", "=", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"SQBraKet", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ">=", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"SQBraKet", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "+", "i1"}]}], ",", 
               "Null", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"Element", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SQBraKet", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SQBraKet", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "i1"}], ",", 
                   "NegativeIntegers"}], "]"}], ",", "Null", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SQBraKet", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SQBraKet", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "i1"}], ")"}],
                     "/", "2"}], ")"}], ">", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SQBraKet", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "Null", ",", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SQBraKet", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SQBraKet", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "i1"}], ")"}],
                     "/", "2"}], ")"}]}], "]"}]}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "4", ",", "6", ",", "8", ",", "10"}], 
                "}"}]}], "}"}]}], "]"}], "  ", "/.", " ", 
           RowBox[{"Null", " ", "->", " ", 
            RowBox[{"Sequence", "[", "]"}]}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"SQBraKet", "[", 
              RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k1", ",", 
          RowBox[{"Length", "[", "SQBraKet", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ExtDelKron", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"permbraket", "=", 
              RowBox[{"Subsets", "[", 
               RowBox[{
                RowBox[{"Union", "[", 
                 RowBox[{
                  RowBox[{"Tuples", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"lCre", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"lAnh", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"Tuples", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"lAnh", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"lCre", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "]"}], 
                ",", 
                RowBox[{"{", "j1", "}"}]}], "]"}]}], " ", ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"permbraket", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}], "]"}], "==",
                    " ", 
                   RowBox[{"2", "*", "j1"}]}], ",", 
                  RowBox[{"permbraket", "[", 
                   RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i1", ",", 
                  RowBox[{"Length", "[", "permbraket", "]"}]}], "}"}]}], 
               "]"}], " ", "/.", " ", 
              RowBox[{"Null", " ", "->", " ", 
               RowBox[{"Sequence", "[", "]"}]}]}]}], "\[IndentingNewLine]", 
            ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{
               RowBox[{"ExternContract", "[", 
                RowBox[{"[", "l1", "]"}], "]"}], "[", 
               RowBox[{"[", "k1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"ExternContract", "[", 
              RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"l1", ",", 
          RowBox[{"Length", "[", "ExternContract", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Remove", "  ", "the", " ", "many"}], "-", 
       RowBox[{
       "body", " ", "terms", " ", "in", " ", "each", " ", "block", " ", "of", 
        " ", "the", " ", "EOM"}], "-", 
       RowBox[{"CC", " ", "matrix"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"PreInter", "=", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Length", "/@", " ", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"i1", ",", 
                   RowBox[{"Alternatives", "@@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ExtDelKron", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i1", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"lCre", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"lAnh", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"lCre", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"lAnh", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}], 
                "]"}]}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"j1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ExtDelKron", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                   RowBox[{"[", "l1", "]"}], "]"}], "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            " ", ",", 
            RowBox[{"{", 
             RowBox[{"k1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"ExtDelKron", "[", 
                 RowBox[{"[", "m1", "]"}], "]"}], "[", 
                RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"l1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"ExtDelKron", "[", 
              RowBox[{"[", "m1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"m1", ",", 
          RowBox[{"Length", "[", "ExtDelKron", "]"}]}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"DelKron2", "=", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"\[Chi]", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"ExtDelKron", "[", 
                  RowBox[{"[", "l1", "]"}], "]"}], "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", "j1", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"GatherBy", "[", 
                    RowBox[{
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"PreInter", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"PreInter", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "&"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"PreInter", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                 "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{"ExtDelKron", "[", 
                  RowBox[{"[", "l1", "]"}], "]"}], "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"ExtDelKron", "[", 
               RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"l1", ",", 
           RowBox[{"Length", "[", "ExtDelKron", "]"}]}], "}"}]}], "]"}], " ", 
       "//", " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Obtain", " ", "all", " ", "the", "  ", "many", " ", "body", " ", 
       "terms"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ManbodyTerms0", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Subscript", "[", 
                RowBox[{"\[Chi]", ",", 
                 RowBox[{"Table", "[", "\[IndentingNewLine]", " ", 
                  RowBox[{
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ExtDelKron", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"lCre", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"lAnh", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"lCre", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"lAnh", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}], 
                  "]"}]}], "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"j1", ",", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"GatherBy", "[", 
                    RowBox[{
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"PreInter", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"PreInter", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "&"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"PreInter", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                  "[", 
                  RowBox[{"[", "k1", "]"}], "]"}]}], "}"}]}], "]"}], " ", 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"k1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{"ExtDelKron", "[", 
                  RowBox[{"[", "m1", "]"}], "]"}], "[", 
                 RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"l1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"ExtDelKron", "[", 
               RowBox[{"[", "m1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"m1", ",", 
           RowBox[{"Length", "[", "ExtDelKron", "]"}]}], "}"}]}], "]"}], "//",
        " ", "Flatten"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Impose", " ", "a", " ", "condition", " ", "to", " ", "remove", " ", 
        "the", " ", "blocks", " ", "that", " ", "corresponds", " ", "to", " ",
         "CC", " ", "in", " ", "the", " ", "many"}], "-", 
       RowBox[{"body", " ", "terms", " ", "list"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ManbodyTerms1", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ManbodyTerms0", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", 
           RowBox[{"Length", "[", "ManbodyTerms0", "]"}]}], "}"}]}], "]"}], 
       " ", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"GatherBy", "[", 
          RowBox[{
           RowBox[{"Range", "@", 
            RowBox[{"Length", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Length", " ", "/@", 
                RowBox[{
                 RowBox[{"ManbodyTerms0", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i1", ",", 
                 RowBox[{"Length", "[", "ManbodyTerms0", "]"}]}], "}"}]}], 
              "]"}], " ", "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Length", " ", "/@", 
                RowBox[{
                 RowBox[{"ManbodyTerms0", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i1", ",", 
                 RowBox[{"Length", "[", "ManbodyTerms0", "]"}]}], "}"}]}], 
              "]"}], " ", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Impose", " ", "a", " ", "condition", " ", "to", " ", "remove", " ", 
        "the", " ", "blocks", " ", "that", " ", "corresponds", " ", "to", " ",
         "CC", " ", "in", " ", "the", " ", "many"}], "-", 
       RowBox[{"body", " ", "terms", " ", "list"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"ManbodyTerms1", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"ManbodyTerms1", ",", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
                 RowBox[{"Partition", "[", 
                  RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "/@", 
               "ManbodyTerms1"}], ")"}]}], ",", 
            RowBox[{"N_", "/;", 
             RowBox[{"N", ">", "4"}]}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"The", " ", "N"}], ">", 
        RowBox[{"4", " ", "was", " ", "changed", " ", "for", " ", "N"}], ">=",
         "4"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ManbodyTerms1", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"ManbodyTerms1", ",", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
               RowBox[{"Partition", "[", 
                RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "/@", 
             "ManbodyTerms1"}], ")"}]}], ",", 
          RowBox[{"N_", "/;", 
           RowBox[{"N", ">=", "4"}]}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ManbodyTerms1", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"ManbodyTerms1", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", "#", "}"}], "&"}], "/@", 
           RowBox[{"Flatten", "[", "#", "]"}]}], "&"}], "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Count", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"n_", "/;", 
                   RowBox[{
                    RowBox[{"n", "[", 
                    RowBox[{"[", "0", "]"}], "]"}], "===", 
                    "SuperDagger"}]}]}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
                   RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "/@", 
                 "ManbodyTerms1"}], ")"}]}], ")"}], ",", 
             RowBox[{"N_", "/;", 
              RowBox[{"N", ">", "2"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Count", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"n_", "/;", 
                   RowBox[{
                    RowBox[{"n", "[", 
                    RowBox[{"[", "0", "]"}], "]"}], "=!=", 
                    "SuperDagger"}]}]}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
                   RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "/@", 
                 "ManbodyTerms1"}], ")"}]}], ")"}], ",", 
             RowBox[{"N_", "/;", 
              RowBox[{"N", ">", "2"}]}]}], "]"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ManyBodyTermsV", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Insert", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"ManbodyTerms1", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"ManbodyTerms1", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"3", ";;", "4"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
            
            RowBox[{"Unevaluated", "[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"StringT", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ";;", "3"}], "]"}], "]"}]}], "]"}], ",", "2"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{"StringT", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"k1", ",", 
          RowBox[{"Length", "[", "ManbodyTerms1", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ManyBodyTermsF", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Insert", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"ManbodyTerms1", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"ManbodyTerms1", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"3", ";;", "4"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
            
            RowBox[{"Unevaluated", "[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"StringS", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ";;", "3"}], "]"}], "]"}]}], "]"}], ",", "2"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringS", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"k1", ",", 
          RowBox[{"Length", "[", "ManbodyTerms1", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"From", " ", "here", " ", "the", " ", "EOM"}], "-", 
       RowBox[{
       "CC", " ", "equations", " ", "are", " ", "genearted", " ", "in", " ", 
        "terms", " ", "of", " ", "many", " ", "body", " ", "terms"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"PosManyBody0", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Flatten", "[", "#", "]"}], "&"}], "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sort", "[", "#", "]"}], "&"}], "@", 
                    RowBox[{"Flatten", "[", "#", "]"}]}], "&"}], "/@", 
                   "ManbodyTerms1"}], ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sort", "[", "#", "]"}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"SQBraKet", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}], ",", "#"}], "]"}],
                     "&"}], "@", 
                    RowBox[{"Flatten", "[", "#", "]"}]}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ExtDelKron", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], ")"}]}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Sort", "[", "#", "]"}], "&"}], "@", 
                    RowBox[{"Flatten", "[", "#", "]"}]}], "&"}], "/@", 
                  "ManbodyTerms1"}]}], "]"}]}], ")"}]}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"ExtDelKron", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
          "  ", "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"SQBraKet", "[", 
              RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"k1", ",", 
          RowBox[{"Length", "[", "SQBraKet", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Obtain", " ", "all", " ", "the", " ", "strings", " ", "of", " ", 
        "the", " ", "bra", " ", "and", " ", "ket", " ", "for", " ", "each", 
        " ", "block", " ", "and", " ", "for", " ", "each", " ", 
        "intermediate", "\[IndentingNewLine]", "Positions", " ", "of", " ", 
        "the", " ", "Many"}], "-", 
       RowBox[{
       "Body", " ", "Terms", " ", "in", " ", "each", " ", "block", " ", "of", 
        " ", "delta", " ", "Kroneckers"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ManyBodyBlock0", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Sort", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", 
                "ManbodyTerms1"}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"PosManyBody0", " ", "/.", " ", 
                    RowBox[{
                    RowBox[{"{", "}"}], "->", " ", 
                    RowBox[{"Sequence", "[", "]"}]}]}], " ", "/.", "  ", 
                    RowBox[{
                    RowBox[{"{", "}"}], "->", " ", 
                    RowBox[{"Sequence", "[", "]"}]}]}], ")"}], "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}], " ", "]"}], "]"}]}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"PosManyBody0", " ", "/.", " ", 
                    RowBox[{
                    RowBox[{"{", "}"}], "->", " ", 
                    RowBox[{"Sequence", "[", "]"}]}]}], " ", "/.", "  ", 
                   RowBox[{
                    RowBox[{"{", "}"}], "->", " ", 
                    RowBox[{"Sequence", "[", "]"}]}]}], ")"}], "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], " ",
           "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"PosManyBody0", " ", "/.", " ", 
                 RowBox[{
                  RowBox[{"{", "}"}], "->", " ", 
                  RowBox[{"Sequence", "[", "]"}]}]}], " ", "/.", "  ", 
                RowBox[{
                 RowBox[{"{", "}"}], "->", " ", 
                 RowBox[{"Sequence", "[", "]"}]}]}], ")"}], "[", 
              RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], " ", 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"k1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"PosManyBody0", " ", "/.", " ", 
              RowBox[{
               RowBox[{"{", "}"}], "->", " ", 
               RowBox[{"Sequence", "[", "]"}]}]}], " ", "/.", "  ", 
             RowBox[{
              RowBox[{"{", "}"}], "->", " ", 
              RowBox[{"Sequence", "[", "]"}]}]}], ")"}], "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Remove", " ", "all", " ", "the", " ", "empty", " ", "positions", " ", 
       "from", "  ", "delkron"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"DelKron1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Delete", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ExtDelKron", "[", 
              RowBox[{"[", "j1", "]"}], "]"}], "[", 
             RowBox[{"[", "i1", "]"}], "]"}], ",", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"PosManyBody0", "[", 
                RowBox[{"[", "j1", "]"}], "]"}], "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"PosManyBody0", "[", 
              RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"j1", ",", 
          RowBox[{"Length", "[", "PosManyBody0", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"DelKron1", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"DelKron1", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"PosManyBody0", "[", 
              RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
            RowBox[{"{", "}"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"{", 
         RowBox[{"i1", ",", 
          RowBox[{"Length", "[", "PosManyBody0", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Obtain", " ", "the", " ", "chi", "  ", "of", " ", "each", " ", "many", 
       " ", "body", " ", "term"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ManyBodyBlock1", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Sort", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Complement", "[", 
                   RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"SQBraKet", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}], ",", "#"}], "]"}],
                   "&"}], "@", 
                 RowBox[{"Flatten", "[", "#", "]"}]}], "&"}], "/@", 
               RowBox[{
                RowBox[{
                 RowBox[{"DelKron1", "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"DelKron1", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"DelKron1", "[", 
              RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"k1", ",", 
          RowBox[{"Length", "[", "DelKron1", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"All", " ", "the", "  ", "the", " ", "holes"}], " ", "=", " ", 
       
       RowBox[{"True", " ", "in", "  ", "ManyBodyBlock0"}]}], "  ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"TFHolesMB0", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", "#", "]"}], "&"}], "@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringTake", "[", " ", 
                    RowBox[{
                    RowBox[{"ToString", "[", "#", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "]"}], "===", 
                    "\"\<h\>\""}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyBlock0", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], ")"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], 
                    ",", "True", ",", "False"}], "]"}], "&"}], "/@", "  ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyBlock1", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}]}], "}"}]}], " ", "//", 
               " ", "Transpose"}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ManyBodyBlock0", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                   RowBox[{"[", "k1", "]"}], "]"}], "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"ManyBodyBlock0", "[", 
                 RowBox[{"[", "l1", "]"}], "]"}], "[", 
                RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"ManyBodyBlock0", "[", 
              RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l1", ",", 
          RowBox[{"Length", "[", "ManyBodyBlock0", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"All", " ", "the", "  ", "the", " ", "holes"}], " ", "=", " ", 
       
       RowBox[{"True", " ", "in", "  ", "ManyBodyBlock0"}]}], "  ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"TFHolesMB1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", "#", "]"}], "&"}], "@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringTake", "[", " ", 
                    RowBox[{
                    RowBox[{"ToString", "[", "#", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "]"}], "===", 
                    "\"\<h\>\""}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyBlock1", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], ")"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], 
                    ",", "True", ",", "False"}], "]"}], "&"}], "/@", "  ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyBlock1", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}]}], "}"}]}], " ", "//", 
               " ", "Transpose"}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ManyBodyBlock1", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                   RowBox[{"[", "k1", "]"}], "]"}], "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"ManyBodyBlock1", "[", 
                 RowBox[{"[", "l1", "]"}], "]"}], "[", 
                RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"ManyBodyBlock1", "[", 
              RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l1", ",", 
          RowBox[{"Length", "[", "ManyBodyBlock1", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"PositZeroTerms", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Flatten", "[", "#", "]"}], "&"}], "@", 
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"TFHolesMB0", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], ",", "#"}], "]"}]}], 
                "&"}], "/@", 
               RowBox[{
                RowBox[{
                 RowBox[{"TFHolesMB1", "[", 
                  RowBox[{"[", "l1", "]"}], "]"}], "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", "j1", "]"}], "]"}]}], ")"}], " ", "/.", " ", 
             RowBox[{
              RowBox[{"{", "}"}], "->", 
              RowBox[{"Sequence", "[", "]"}]}]}], "\[IndentingNewLine]", ",", 
            
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"ManyBodyBlock0", "[", 
                 RowBox[{"[", "l1", "]"}], "]"}], "[", 
                RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"ManyBodyBlock0", "[", 
              RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l1", ",", 
          RowBox[{"Length", "[", "ManyBodyBlock0", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "ManyBodyBlock1", "  ", "but", " ", "without", " ", "the", " ", 
       "SuperDagger"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ManyBodyBlock2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], 
                  ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
                " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"ManyBodyBlock1", "[", 
                   RowBox[{"[", "l1", "]"}], "]"}], "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ManyBodyBlock1", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                   RowBox[{"[", "k1", "]"}], "]"}], "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"ManyBodyBlock1", "[", 
                 RowBox[{"[", "l1", "]"}], "]"}], "[", 
                RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"ManyBodyBlock1", "[", 
              RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l1", ",", 
          RowBox[{"Length", "[", "ManyBodyBlock1", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"PositZeroTerms1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Flatten", "[", "#", "]"}], "&"}], "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"TFHolesMB0", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], ",", "#"}], "]"}]}], 
                 "&"}], "/@", 
                RowBox[{
                 RowBox[{
                  RowBox[{"TFHolesMB1", "[", 
                   RowBox[{"[", "l1", "]"}], "]"}], "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "[", 
                 RowBox[{"[", "j1", "]"}], "]"}]}], ")"}], " ", ",", 
              RowBox[{"{", "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"ManyBodyBlock0", "[", 
                 RowBox[{"[", "l1", "]"}], "]"}], "[", 
                RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"ManyBodyBlock0", "[", 
              RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l1", ",", 
          RowBox[{"Length", "[", "ManyBodyBlock0", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ManyBodyBlock3", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Delete", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"ManyBodyBlock2", "[", 
                 RowBox[{"[", "l1", "]"}], "]"}], "[", 
                RowBox[{"[", "k1", "]"}], "]"}], "[", 
               RowBox[{"[", "j1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"PositZeroTerms1", "[", 
                 RowBox[{"[", "l1", "]"}], "]"}], "[", 
                RowBox[{"[", "k1", "]"}], "]"}], "[", 
               RowBox[{"[", "j1", "]"}], "]"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"PositZeroTerms1", "[", 
                 RowBox[{"[", "l1", "]"}], "]"}], "[", 
                RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"PositZeroTerms1", "[", 
              RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l1", ",", 
          RowBox[{"Length", "[", "PositZeroTerms1", "]"}]}], "}"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"ManyBodyBlock4", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], 
                    ",", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#1"}], "]"}], "&"}],
                  "/@", "\[IndentingNewLine]", 
                 RowBox[{"Flatten", "[", "#", "]"}]}], "&"}], "@", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"ManyBodyBlock0", "[", 
                   RowBox[{"[", "l1", "]"}], "]"}], "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"PositZeroTerms", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"PositZeroTerms", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                   RowBox[{"[", "k1", "]"}], "]"}], "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"PositZeroTerms", "[", 
                 RowBox[{"[", "l1", "]"}], "]"}], "[", 
                RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"PositZeroTerms", "[", 
              RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l1", ",", 
          RowBox[{"Length", "[", "PositZeroTerms", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ManyBodyHOp0", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", 
          SuperscriptBox["q2", "\[Dagger]"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"q1", ",", "q2", ",", 
          SuperscriptBox["q4", "\[Dagger]"], ",", 
          SuperscriptBox["q3", "\[Dagger]"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"q1", ",", "q2", ",", "q3", ",", 
          SuperscriptBox["q6", "\[Dagger]"], ",", 
          SuperscriptBox["q5", "\[Dagger]"], ",", 
          SuperscriptBox["q4", "\[Dagger]"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"q1", ",", "q2", ",", "q3", ",", "q4", ",", 
          SuperscriptBox["q8", "\[Dagger]"], ",", 
          SuperscriptBox["q7", "\[Dagger]"], ",", 
          SuperscriptBox["q6", "\[Dagger]"], ",", 
          SuperscriptBox["q5", "\[Dagger]"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"q1", ",", "q2", ",", "q3", ",", "q4", ",", "q5", ",", 
          SuperscriptBox["q10", "\[Dagger]"], ",", 
          SuperscriptBox["q9", "\[Dagger]"], ",", 
          SuperscriptBox["q8", "\[Dagger]"], ",", 
          SuperscriptBox["q7", "\[Dagger]"], ",", 
          SuperscriptBox["q6", "\[Dagger]"]}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ManyBodyHOp1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"ManyBodyHOp0", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "]"}], "/", "2"}]}], "]"}], 
          "&"}], "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "[", 
                RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], ",", 
              RowBox[{"#1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "#1"}], "]"}], "&"}], "/@", 
           RowBox[{"ManyBodyHOp0", "[", 
            RowBox[{"[", "i1", "]"}], "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i1", ",", 
          RowBox[{"Length", "[", "ManyBodyHOp0", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Just", " ", "the", " ", "bra", " ", "and", " ", "the", " ", "ket", " ",
        "ManyBodyTerms1", " ", "without", " ", "the", " ", "SuperDagger"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"MBTwS0", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], 
                    ",", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#1"}], "]"}], "&"}],
                    "/@", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "/@", 
                 RowBox[{"Partition", "[", 
                  RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "/@", 
               "ManbodyTerms1"}], ")"}], "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"PosManyBody0", " ", "/.", " ", 
                 RowBox[{
                  RowBox[{"{", "}"}], "->", " ", 
                  RowBox[{"Sequence", "[", "]"}]}]}], " ", "/.", "  ", 
                RowBox[{
                 RowBox[{"{", "}"}], "->", " ", 
                 RowBox[{"Sequence", "[", "]"}]}]}], ")"}], "[", 
              RowBox[{"[", "j1", "]"}], "]"}], "[", 
             RowBox[{"[", "i1", "]"}], "]"}], "  ", ")"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"PosManyBody0", " ", "/.", " ", 
                 RowBox[{
                  RowBox[{"{", "}"}], "->", " ", 
                  RowBox[{"Sequence", "[", "]"}]}]}], " ", "/.", "  ", 
                RowBox[{
                 RowBox[{"{", "}"}], "->", " ", 
                 RowBox[{"Sequence", "[", "]"}]}]}], ")"}], "[", 
              RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"j1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"PosManyBody0", " ", "/.", " ", 
              RowBox[{
               RowBox[{"{", "}"}], "->", " ", 
               RowBox[{"Sequence", "[", "]"}]}]}], " ", "/.", "  ", 
             RowBox[{
              RowBox[{"{", "}"}], "->", " ", 
              RowBox[{"Sequence", "[", "]"}]}]}], ")"}], "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"MBTwS1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Join", " ", "@@", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"MBTwS0", "[", 
                   RowBox[{"[", "l1", "]"}], "]"}], "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"PositZeroTerms", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"PositZeroTerms", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                   RowBox[{"[", "k1", "]"}], "]"}], "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"PositZeroTerms", "[", 
                 RowBox[{"[", "l1", "]"}], "]"}], "[", 
                RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"PositZeroTerms", "[", 
              RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l1", ",", 
          RowBox[{"Length", "[", "PositZeroTerms", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"MBTwS2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"MBTwS1", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                   RowBox[{"[", "k1", "]"}], "]"}], "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "[", 
                 RowBox[{"[", "i1", "]"}], "]"}], "/.", 
                RowBox[{"AssociationThread", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyBlock4", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                   RowBox[{"[", "i1", "]"}], "]"}], "->", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyBlock3", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                   RowBox[{"[", "i1", "]"}], "]"}]}], "]"}]}], ")"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MBTwS1", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                   RowBox[{"[", "k1", "]"}], "]"}], "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            " ", ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"MBTwS1", "[", 
                 RowBox[{"[", "l1", "]"}], "]"}], "[", 
                RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"MBTwS1", "[", 
              RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l1", ",", 
          RowBox[{"Length", "[", "MBTwS1", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Separate", " ", "again", " ", "in", " ", "to", " ", "Bra", " ", "and",
         " ", "Ket"}], ",", " ", 
       RowBox[{"and", " ", "creation", " ", "or", " ", "anihilation"}]}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"SepBraKet", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Table", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"MBTwS2", "[", 
                    RowBox[{"[", "n1", "]"}], "]"}], "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringTake", "[", " ", 
                    RowBox[{
                    RowBox[{"ToString", "[", "#", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "]"}], "===", 
                    "\"\<h\>\""}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"MBTwS2", "[", 
                    RowBox[{"[", "n1", "]"}], "]"}], "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], ",", "j1"}], "]"}], 
                    "]"}], "]"}], "]"}], "\[IndentingNewLine]", ",", 
                   RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"MBTwS2", "[", 
                    RowBox[{"[", "n1", "]"}], "]"}], "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"j1", ",", 
                   RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], "]"}], 
               " ", "//", " ", "Transpose"}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"k1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MBTwS2", "[", 
                    RowBox[{"[", "n1", "]"}], "]"}], "[", 
                   RowBox[{"[", "m1", "]"}], "]"}], "[", 
                  RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "  ", "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"l1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"MBTwS2", "[", 
                 RowBox[{"[", "n1", "]"}], "]"}], "[", 
                RowBox[{"[", "m1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"m1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"MBTwS2", "[", 
              RowBox[{"[", "n1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n1", ",", 
          RowBox[{"Length", "[", "MBTwS2", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "all", " ", "the", " ", "strings", " ", "that", " ", "are", " ", 
       "applied", " ", "to", " ", "the", " ", "Many", " ", "body", " ", 
       "terms", " ", "are", " ", "created"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"PreManyBody", "=", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Quiet", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["\[Chi]", 
                  RowBox[{
                   RowBox[{"Length", "[", "#", "]"}], "/", "2"}]], " ", "[", 
                 RowBox[{"[", 
                  RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], "/@", 
               
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "]"}], 
                  "&"}], "/@", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"SepBraKet", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "[", 
                  RowBox[{"[", "i1", "]"}], "]"}]}], ")"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{"SepBraKet", "[", 
                   RowBox[{"[", "k1", "]"}], "]"}], "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            " ", "/.", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Chi]", "1"], "->", "\[Chi]1"}], ",", 
              RowBox[{
               SubscriptBox["\[Chi]", "2"], "->", "\[Chi]2"}], ",", 
              RowBox[{
               SubscriptBox["\[Chi]", "3"], "->", "\[Chi]3"}], ",", 
              RowBox[{
               SubscriptBox["\[Chi]", "4"], "->", "\[Chi]4"}], ",", 
              RowBox[{
               SubscriptBox["\[Chi]", "5"], "->", "\[Chi]5"}], ",", 
              RowBox[{
               SubscriptBox["\[Chi]", "6"], "->", "\[Chi]6"}], ",", 
              RowBox[{
               SubscriptBox["\[Chi]", "7"], "->", "\[Chi]7"}], ",", 
              RowBox[{
               SubscriptBox["\[Chi]", "8"], "->", "\[Chi]8"}]}], "}"}]}], 
           "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"SepBraKet", "[", 
              RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k1", ",", 
          RowBox[{"Length", "[", "SepBraKet", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Generate", " ", "the", " ", "kronecker", " ", "deltas", " ", "that", 
       " ", "are", " ", "not", " ", "applied", " ", "to", " ", "the", " ", 
       "many", " ", "body", " ", "terms"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"KronMany", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Join", "@@", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"(", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", "2"}], "]"}], "&"}], " ", "/@", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], 
                    ",", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#1"}], "]"}], "&"}],
                     "/@", " ", 
                    RowBox[{"Flatten", "[", "#", "]"}]}], "&"}], "/@", 
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"DelKron1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"PositZeroTerms1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "]"}]}], ")"}]}], 
                  ")"}], "}"}], "]"}]}], ")"}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{"DelKron1", "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"j1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"DelKron1", "[", 
               RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], " ", 
         "/.", " ", 
         RowBox[{"Null", " ", "->", " ", 
          RowBox[{"Sequence", "[", "]"}]}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"k1", ",", 
          RowBox[{"Length", "[", "DelKron1", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SQwBraKet", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#1", "[", 
                    RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], 
                  ",", 
                  RowBox[{"#1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "#1"}], "]"}], "&"}], 
               "/@", " ", "#"}], ")"}], "&"}], "/@", "#"}], ")"}], "&"}], "/@", 
         RowBox[{"SQBraKet", "[", 
          RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i1", ",", 
          RowBox[{"Length", "[", "SQBraKet", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Position", " ", "of", " ", "of", " ", "each", " ", "Particle", " ", 
       "Hole", " ", "index", " ", "in", " ", "the", " ", "contraction"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"PosCont", "=", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"SQwBraKet", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "]"}], ",", "#"}], "]"}],
                     "&"}], " ", "/@", " ", "#"}], ")"}], "]"}], "&"}], "/@", 
                
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"KronMany", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                   RowBox[{"[", "k1", "]"}], "]"}], "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "[", 
                 RowBox[{"[", "i1", "]"}], "]"}]}], ")"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"KronMany", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                   RowBox[{"[", "k1", "]"}], "]"}], "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"KronMany", "[", 
                 RowBox[{"[", "l1", "]"}], "]"}], "[", 
                RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"KronMany", "[", 
              RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l1", ",", 
          RowBox[{"Length", "[", "KronMany", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"IntervalContMatch", "=", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"PosCont", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                   RowBox[{"[", "k1", "]"}], "]"}], "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "===", 
                 RowBox[{"{", "}"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"PosCont", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                   RowBox[{"[", "k1", "]"}], "]"}], "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "}"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "&"}], "/@", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"UpperTriangularize", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntervalIntersection", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Interval", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"PosCont", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}], ")"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", "#"}], "]"}], "&"}],
                     "/@", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Interval", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"PosCont", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}], ")"}]}], ")"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"PosCont", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    ",", "1"}], "]"}], " ", "/.", " ", 
                   RowBox[{"0", "->", 
                    RowBox[{"Sequence", "[", "]"}]}]}], ")"}]}]}], "]"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"j1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"PosCont", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                   RowBox[{"[", "l1", "]"}], "]"}], "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"PosCont", "[", 
                 RowBox[{"[", "m1", "]"}], "]"}], "[", 
                RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"l1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"PosCont", "[", 
              RowBox[{"[", "m1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"m1", ",", 
          RowBox[{"Length", "[", "PosCont", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Obtain", " ", "all", " ", "the", " ", "Sings", " ", "of", " ", 
       "contractions", " ", "of", " ", "the", " ", "Kronecker", " ", 
       "deltas"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"SignContDelt", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], "#"], "&"}], "@", 
               RowBox[{"(", 
                RowBox[{"Count", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"PosCont", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", "#"}], "]"}], "&"}],
                     "/@", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntervalContMatch", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"PosCont", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}], "]"}], ",", "1"}], "]"}], ")"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"j1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"PosCont", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                   RowBox[{"[", "l1", "]"}], "]"}], "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"PosCont", "[", 
                 RowBox[{"[", "m1", "]"}], "]"}], "[", 
                RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"l1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"PosCont", "[", 
              RowBox[{"[", "m1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"m1", ",", 
          RowBox[{"Length", "[", "PosCont", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NonContractedPos", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SQwBraKet", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "@", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"SQwBraKet", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", "#"}], "]"}], "&"}],
                    "/@", " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"SepBraKet", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}], ")"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i1", ",", "2"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"SepBraKet", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                   RowBox[{"[", "l1", "]"}], "]"}], "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"SepBraKet", "[", 
                 RowBox[{"[", "m1", "]"}], "]"}], "[", 
                RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"l1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"SepBraKet", "[", 
              RowBox[{"[", "m1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"m1", ",", 
          RowBox[{"Length", "[", "SepBraKet", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Obtain", " ", "all", " ", "the", " ", "Sings", " ", "of", "  ", "the", 
       " ", "indexes", " ", "that", " ", "are", " ", "not", " ", 
       "contracted"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"NonContracteInter", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], 
               RowBox[{"Total", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"NonContractedPos", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "<", "i1"}], "&"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"PosCont", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}],
                     "]"}], "]"}], ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"NonContractedPos", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", ">", "i1"}], "&"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"PosCont", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}],
                     "]"}], "]"}]}], "}"}], "]"}]], "\[IndentingNewLine]", 
              ",", 
              RowBox[{"{", 
               RowBox[{"j1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"PosCont", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                   RowBox[{"[", "l1", "]"}], "]"}], "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{"PosCont", "[", 
                 RowBox[{"[", "m1", "]"}], "]"}], "[", 
                RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"l1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"PosCont", "[", 
              RowBox[{"[", "m1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"m1", ",", 
          RowBox[{"Length", "[", "PosCont", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SignManyBody", "=", 
      RowBox[{"SignContDelt", " ", "NonContracteInter"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ManyBodyStrings", "=", 
      RowBox[{"{", 
       RowBox[{"ManyBodyTermsF", ",", "ManyBodyTermsV"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Times", "@@", "#"}], "&"}], "/@", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"KronMany", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}], "===", 
                    RowBox[{"{", "}"}]}], ",", "1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subscript", "[", 
                    RowBox[{"\[Delta]", ",", "#"}], "]"}], "&"}], "/@", " ", 
                    RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", "2"}], "]"}]}], "&"}], " ", "@", " ", 
                    RowBox[{"Flatten", "[", "#", "]"}]}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"KronMany", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}]}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"SignManyBody", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"PreManyBody", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], ")"}]}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"i1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{
                   RowBox[{"KronMany", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
             " ", "//", "Flatten"}], ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"KronMany", "[", 
                RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{"Length", "[", "KronMany", "]"}]}], "}"}]}], "]"}], ",", 
        "ManyBodyStrings"}], "}"}], "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.876469479707465*^9, 3.876469541626397*^9}, {
   3.876469833025949*^9, 3.876469834295375*^9}, {3.876469962692398*^9, 
   3.8764700219866323`*^9}, {3.876470087520525*^9, 3.8764701116505938`*^9}, {
   3.876470361899016*^9, 3.87647039448167*^9}, 3.876827662335021*^9, 
   3.876827801970155*^9, 3.884340144203458*^9, {3.885460138295292*^9, 
   3.885460207542097*^9}, {3.885989828424094*^9, 3.8859898630986357`*^9}, {
   3.886065343945444*^9, 3.886065364403928*^9}, {3.886578929779893*^9, 
   3.886578930651986*^9}, {3.886596609211134*^9, 3.886596627728816*^9}, 
   3.886596661217135*^9, {3.886598927826646*^9, 3.886598932239602*^9}, 
   3.886600062830682*^9, 3.88725703014791*^9, {3.887274288430537*^9, 
   3.887274315379643*^9}, 3.887367665274271*^9, 3.887367734955081*^9, {
   3.8873681701626368`*^9, 3.88736817746696*^9}, 3.890814070892705*^9, {
   3.89105772145481*^9, 3.891057721616835*^9}, {3.8910592749966373`*^9, 
   3.891059355075392*^9}, 3.891064618621401*^9, {3.891501783729856*^9, 
   3.891501792858597*^9}, {3.891501918582526*^9, 3.8915019271246023`*^9}, {
   3.8915030723889103`*^9, 3.8915030953505087`*^9}, {3.891503171077804*^9, 
   3.891503253395855*^9}, {3.892260941131016*^9, 3.892260942773932*^9}, {
   3.892263323205473*^9, 3.892263352292506*^9}, {3.893077553638213*^9, 
   3.8930775562938757`*^9}, {3.893125587475699*^9, 3.893125613787375*^9}, {
   3.89312565000106*^9, 3.893125650633862*^9}, {3.893125710547516*^9, 
   3.893125761724613*^9}, {3.893128255044078*^9, 3.893128257979031*^9}, {
   3.8931287986230297`*^9, 3.893128800087388*^9}, 3.893128950191256*^9, 
   3.894586989940793*^9, {3.894588101990758*^9, 3.894588120599286*^9}, {
   3.894588162868374*^9, 3.8945882550221233`*^9}, {3.8987470034297476`*^9, 
   3.8987470666217456`*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"86f446cc-8121-424b-969b-991b96e89d63"]
}, Closed]],

Cell[CellGroupData[{

Cell["WicksContract ", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.850212664358878*^9, 3.8502126771346684`*^9}, {
   3.85157954112372*^9, 3.8515795729983664`*^9}, {3.8516892834589653`*^9, 
   3.851689284844758*^9}, {3.858842674216196*^9, 3.858842803867488*^9}, {
   3.858843034882577*^9, 3.858843046037135*^9}, 3.8588444984561167`*^9, {
   3.858929589023733*^9, 3.858929600925139*^9}, {3.860557256827732*^9, 
   3.860557323546199*^9}, {3.860567231137411*^9, 3.8605672311374693`*^9}, {
   3.861864719032872*^9, 3.861864730057736*^9}, {3.8618648804597187`*^9, 
   3.861864885676948*^9}, {3.8740599273331413`*^9, 3.8740599316856422`*^9}, {
   3.877687842043283*^9, 3.8776878447096567`*^9}, {3.885383206694233*^9, 
   3.885383224858076*^9}, {3.887431867470304*^9, 3.887431867521755*^9}, {
   3.891066525893366*^9, 3.8910665493242893`*^9}, {3.892263280685519*^9, 
   3.8922632842352533`*^9}},ExpressionUUID->"e9f99a08-7c66-4f0d-adeb-\
d35819a90a9c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"WicksContract", " ", "requires", " ", "the", " ", "input", " ", 
    RowBox[{"ManyBodyStrings", ".", " ", "It"}], " ", "generates", " ", "all",
     " ", "possible", " ", "contractions", " ", "between", " ", "the", " ", 
    "Bra"}], "-", 
   RowBox[{"Hamiltonian", " ", "and", " ", "Ket"}], "-", 
   RowBox[{
    RowBox[{"Hamiltonian", ".", " ", "The"}], " ", "output", " ", "consists", 
    " ", "of", " ", "a", " ", "list", " ", "of", " ", "delta", " ", 
    "Kroneckers", " ", "and", " ", "the", " ", "corresponding", " ", 
    RowBox[{"signs", "."}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.892263291559908*^9, 3.892263313040102*^9}, {
   3.892263406627734*^9, 3.89226341654707*^9}, {3.8922634468248997`*^9, 
   3.892263525266551*^9}, {3.892263607129928*^9, 3.892263630338973*^9}, {
   3.892267453648526*^9, 3.8922674713435173`*^9}, 3.892267859561878*^9, {
   3.892780095985214*^9, 3.892780106500206*^9}, {3.894588905345767*^9, 
   3.894588910764904*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"9d08ad4c-3daf-4aab-b14e-7fac1e7f4a5d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WicksContract", "[", "ManyBodyStrings_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Op1", ",", "Op2", ",", " ", "Op3", ",", "Op4", ",", "Op5", ",", "Op6",
         ",", "Op7", ",", "Op8", ",", "ConHcKa", ",", "ConHaKc", ",", 
        "conHcKa2", ",", "conHaKc2", ",", "ValConHK", ",", 
        "remainOpHamiltonian", ",", "remainOpHamiltonian1", ",", " ", 
        "BoolString", ",", "numHcont", " ", ",", "FullContract", ",", 
        "ConHClust", ",", "RandomHClust", ",", "NonRepHTs", ",", 
        "PositionConected", ",", "CombineHTs", ",", "RemainHTs", ",", 
        "contBrHTs", ",", "contBrHTs2", ",", "contractBrHTs", ",", "SignCont",
         ",", "ManyBodyTermsF", ",", "ManyBodyTermsT"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ManyBodyTermsF", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"ManyBodyTermsT", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ManyBodyStrings", "[", 
                   RowBox[{"[", "X1", "]"}], "]"}], "[", 
                  RowBox[{"[", "Y1", "]"}], "]"}], "[", 
                 RowBox[{"[", "Z1", "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", " ", 
               RowBox[{"Op1", "=", 
                RowBox[{"{", "}"}]}], ";", " ", 
               RowBox[{"Op2", "=", 
                RowBox[{"{", "}"}]}], ";", "   ", 
               RowBox[{"Op3", "=", 
                RowBox[{"{", "}"}]}], ";", " ", 
               RowBox[{"Op4", "=", 
                RowBox[{"{", "}"}]}], ";", "   ", 
               RowBox[{"Op5", "=", 
                RowBox[{"{", "}"}]}], ";", "    ", 
               RowBox[{"Op6", "=", 
                RowBox[{"{", "}"}]}], ";", "    ", 
               RowBox[{"Op7", "=", 
                RowBox[{"{", "}"}]}], ";", " ", 
               RowBox[{"Op8", "=", 
                RowBox[{"{", "}"}]}], ";", "  ", "\[IndentingNewLine]", 
               RowBox[{"Do", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], 
                    ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"Op1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"Op2", ",", 
                    RowBox[{
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}], "]"}]}], "]"}], ";"}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"j1", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"Do", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], 
                    ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"Op3", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"Op4", ",", 
                    RowBox[{
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}], "]"}]}], "]"}], ";"}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"j1", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"Op5", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], 
                    ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", "/.", 
                   RowBox[{"Null", " ", "->", " ", 
                    RowBox[{"Sequence", "[", "]"}]}]}], "\[IndentingNewLine]",
                   ",", 
                  RowBox[{"{", 
                   RowBox[{"j1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Op6", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "0", "]"}], "]"}], "=!=", "SuperDagger"}], 
                    ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}]}], "]"}], "/.", 
                   RowBox[{"Null", " ", "->", " ", 
                    RowBox[{"Sequence", "[", "]"}]}]}], "\[IndentingNewLine]",
                   ",", 
                  RowBox[{"{", 
                   RowBox[{"j1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Do", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], 
                    ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"Op7", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"Op8", ",", 
                    RowBox[{
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}], "]"}]}], "]"}], ";"}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"j1", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "Contract", " ", "the", " ", "operators", " ", "in", " ", 
                 "hamiltonian", " ", "with", " ", "the", " ", "ket"}], "*)"}],
                "\[IndentingNewLine]", 
               RowBox[{"ConHcKa", "=", 
                RowBox[{"Subsets", "[", 
                 RowBox[{
                  RowBox[{"Tuples", "[", 
                   RowBox[{"{", 
                    RowBox[{"Op3", ",", "Op8"}], "}"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "Op3", "]"}], ",", 
                    RowBox[{"Length", "[", "Op8", "]"}]}], "}"}], "]"}], 
                   "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"ConHaKc", "=", " ", 
                RowBox[{"Subsets", "[", 
                 RowBox[{
                  RowBox[{"Tuples", "[", 
                   RowBox[{"{", 
                    RowBox[{"Op4", ",", "Op7"}], "}"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "Op4", "]"}], ",", 
                    RowBox[{"Length", "[", "Op7", "]"}]}], "}"}], "]"}], 
                   "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "Check", " ", "for", " ", "the", " ", "valid", " ", 
                 "contractions", " ", "between", " ", "hamiltonian", " ", 
                 "and", " ", "ket"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"conHcKa2", "=", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"ConHcKa", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}], "]"}], "==", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "Op3", "]"}], ",", 
                    RowBox[{"Length", "[", "Op8", "]"}]}], "}"}], "]"}], "*", 
                    "2"}]}], ",", 
                    RowBox[{"ConHcKa", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", "ConHcKa", "]"}]}], "}"}]}], "]"}],
                  " ", "/.", " ", 
                 RowBox[{"Null", " ", "->", " ", 
                  RowBox[{"Sequence", "[", "]"}]}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"conHaKc2", "=", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"ConHaKc", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}], "]"}], "==", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "Op4", "]"}], ",", 
                    RowBox[{"Length", "[", "Op7", "]"}]}], "}"}], "]"}], "*", 
                    "2"}]}], ",", 
                    RowBox[{"ConHaKc", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", "ConHaKc", "]"}]}], "}"}]}], "]"}],
                  " ", "/.", " ", 
                 RowBox[{"Null", " ", "->", " ", 
                  RowBox[{"Sequence", "[", "]"}]}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "All", " ", "the", " ", "possible", " ", "convinations", " ", 
                 "between", " ", "the", " ", "valid", " ", "contractions", 
                 " ", "of", " ", "Hamiltonianand", " ", "Ket"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"ValConHK", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", "2"}], "]"}], "&"}], " ", "@", 
                   RowBox[{"Flatten", "[", "#", "]"}]}], "&"}], "/@", 
                 RowBox[{"Tuples", "[", 
                  RowBox[{"{", 
                   RowBox[{"conHcKa2", ",", "conHaKc2"}], "}"}], "]"}]}]}], 
               " ", ";", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "For", " ", "each", " ", "case", " ", "separate", " ", "the", 
                 "  ", "Hamiltonian", " ", "and", " ", "Ket", " ", 
                 "contractions", " ", "and", " ", "the", " ", "uncontracted", 
                 " ", "terms", " ", "in", " ", "the", " ", "Hamiltonian"}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{"remainOpHamiltonian", "=", 
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"ValConHK", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"Op3", ",", "Op4"}], "}"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"Op3", ",", "Op4"}], "}"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], "==", "False"}],
                     ",", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"Op3", ",", "Op4"}], "}"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"Op3", ",", "Op4"}], "}"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], " ", "/.", " ", 
                   RowBox[{"Null", "->", " ", 
                    RowBox[{"Sequence", "[", "]"}]}]}], "\[IndentingNewLine]",
                   ",", 
                  RowBox[{"{", 
                   RowBox[{"j1", ",", 
                    RowBox[{"Length", "[", "ValConHK", "]"}]}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"remainOpHamiltonian1", "=", "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{"Op3", ",", 
                    RowBox[{"remainOpHamiltonian", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{"Op4", ",", 
                    RowBox[{"remainOpHamiltonian", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", "remainOpHamiltonian", "]"}]}], 
                   "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "This", " ", "variable", " ", "is", " ", "the", " ", "must", 
                 " ", "important", " ", "since", " ", "it", " ", "checks", 
                 " ", "if", " ", "the", " ", "string", " ", "will", " ", "be",
                  " ", "zero", " ", "or", " ", "not"}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"BoolString", "=", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "===", 
                   RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "===", 
                   RowBox[{"{", "}"}]}], ",", 
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "==", 
                   RowBox[{"Length", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "===", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", 
                    RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "===", 
                    RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], "-", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"remainOpHamiltonian1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
                    
                    RowBox[{
                    RowBox[{"#", ">=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}],
                     ")"}], "+", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"remainOpHamiltonian1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"remainOpHamiltonian1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
                    
                    RowBox[{
                    RowBox[{"#", ">=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}],
                     ")"}]}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}], "<", 
                    RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}]}]}], 
                   "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"numHcont", "=", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "===", 
                   RowBox[{"{", "}"}]}], ",", 
                  RowBox[{"{", "0", "}"}], ",", 
                  RowBox[{
                   RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"remainOpHamiltonian1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
                    
                    RowBox[{
                    RowBox[{"#", ">=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "&"}]}], "]"}], 
                   "[", 
                   RowBox[{"[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], "-", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"remainOpHamiltonian1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
                    
                    RowBox[{
                    RowBox[{"#", ">=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}],
                     ")"}], "+", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"remainOpHamiltonian1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"remainOpHamiltonian1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
                    
                    RowBox[{
                    RowBox[{"#", ">=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}],
                     ")"}]}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyTermsT", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "]"}], 
                    "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "If", "  ", "BoolString", " ", "is", " ", "false", " ", 
                 "goes", " ", "to", " ", "the", " ", 
                 RowBox[{"end", ".", "  ", "If"}], " ", "it", " ", "is", " ", 
                 "true", " ", "the", " ", "string", " ", "continues", " ", 
                 "the", " ", "contraction"}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"FullContract", "=", 
                RowBox[{"If", "[", 
                 RowBox[{"BoolString", ",", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "From", " ", "the", " ", "remaining", " ", "terms", " ", 
                    "in", " ", "the", " ", "Hamiltonian", " ", "check", " ", 
                    "if", " ", "it", " ", "is", " ", "possible", " ", "to", 
                    " ", "do", " ", "one", " ", "or", " ", "multiple", " ", 
                    "contractions", " ", "wich", " ", "the", " ", "Cluster", 
                    " ", "Operators"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"ConHClust", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Tuples", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"remainOpHamiltonian1", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Op6", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{"Op5", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "}"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}]}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Op6", ",", "Op5"}], "}"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j1", ",", 
                    RowBox[{"Length", "[", "remainOpHamiltonian1", "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"{", 
                    RowBox[{"Op6", ",", "Op5"}], "}"}], "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    "All", " ", "possible", " ", "combinations", " ", "of", 
                    " ", "contraction", " ", "between", " ", "Hamiltonian", 
                    " ", "with", " ", "Cluster", " ", "Operators"}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"RandomHClust", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Subsets", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ConHClust", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"ConHClust", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "}"}], "]"}]}], ",", 
                    "numHcont"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"ConHClust", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                    ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    "Combinations", "  ", "asigned", " ", "contractions"}], 
                    "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"NonRepHTs", "=", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomHClust", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Flatten", " ", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], "&"}], "@", 
                    RowBox[{"DeleteDuplicates", "[", "#", "]"}]}], "&"}], "@", 
                    RowBox[{"Flatten", "[", "#", "]"}]}], "&"}], "/@", 
                    RowBox[{"RandomHClust", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
                    RowBox[{"2", 
                    RowBox[{"numHcont", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], "]"}], "]"}],
                     "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", "RandomHClust", "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    "Look", " ", "ath", " ", "the", " ", "possitions", " ", 
                    "of", " ", "the", " ", "connected", " ", "Hamiltonian", 
                    " ", "and", " ", "Cluster"}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"PositionConected", "=", "\[IndentingNewLine]", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], "&"}], "@", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{"i1", ",", "#"}], "]"}]}], "&"}], "@", " ", 
                    RowBox[{"Flatten", "[", "#", "]"}]}], "&"}], "/@", 
                    RowBox[{"NonRepHTs", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"Op6", ",", "Op5"}], "}"}], "]"}]}]}], "}"}]}], 
                    "]"}]}], "//", " ", "Transpose"}], ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", ">", "0"}], "&"}], ")"}]}]}], "]"}], " ", "//",
                     " ", "Flatten"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"j1", ",", 
                    RowBox[{"Length", "[", "NonRepHTs", "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    "Based", " ", "on", " ", "the", " ", "position", " ", 
                    "combine", " ", "the", " ", "possible", " ", 
                    "contractions", " ", "of", " ", "Hamiltonian", " ", "and",
                     " ", "Cluster"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"CombineHTs", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"NonRepHTs", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"PositionConected", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", "PositionConected", "]"}]}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    "For", " ", "each", " ", "combination", " ", "obtain", 
                    " ", "the", " ", "remaining", " ", "contractions", " ", 
                    "in", " ", "the", " ", "Hamiltonian", " ", "and", " ", 
                    "Cluster", " ", "Operators"}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"RemainHTs", "=", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{"#", ",", "i1"}], "]"}], "&"}], " ", "/@", " ", 
                    RowBox[{"Insert", "[", 
                    RowBox[{
                    RowBox[{"remainOpHamiltonian1", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], ",", 
                    RowBox[{"Unevaluated", "[", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Flatten", "[", "Op5", "]"}], ",", 
                    RowBox[{"Flatten", "[", "Op6", "]"}]}], "}"}]}], "]"}], 
                    ",", "1"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"CombineHTs", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}]}], "}"}]}], "]"}], " ", 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"j1", ",", 
                    RowBox[{"Length", "[", "CombineHTs", "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    "Contracting", " ", "for", " ", "the", " ", "remaining", 
                    " ", "operators"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"contBrHTs", "=", "\[IndentingNewLine]", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Subsets", "[", 
                    RowBox[{
                    RowBox[{"Tuples", "[", 
                    RowBox[{"{", 
                    RowBox[{"Op2", ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"RemainHTs", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RemainHTs", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Length", "[", "Op2", "]"}], "}"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"RemainHTs", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"j1", ",", 
                    RowBox[{"Length", "[", "RemainHTs", "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"contBrHTs2", "=", "\[IndentingNewLine]", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Subsets", "[", 
                    RowBox[{
                    RowBox[{"Tuples", "[", 
                    RowBox[{"{", 
                    RowBox[{"Op1", ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"RemainHTs", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RemainHTs", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Length", "[", "Op1", "]"}], "}"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"RemainHTs", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"j1", ",", 
                    RowBox[{"Length", "[", "RemainHTs", "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"contractBrHTs", "=", "\[IndentingNewLine]", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
                    RowBox[{"Flatten", "[", "#", "]"}]}], "&"}], "/@", 
                    RowBox[{"Tuples", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"contBrHTs", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], "&"}], "@", 
                    RowBox[{"DeleteDuplicates", "[", "#", "]"}]}], "&"}], "@", 
                    RowBox[{"Flatten", "[", "#", "]"}]}], "&"}], "/@", " ", 
                    RowBox[{
                    RowBox[{"contBrHTs", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
                    RowBox[{"2", "*", 
                    RowBox[{"Length", "[", "Op2", "]"}]}]}], "]"}], "//", 
                    "Flatten"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"contBrHTs2", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], "&"}], "@", 
                    RowBox[{"DeleteDuplicates", "[", "#", "]"}]}], "&"}], "@", 
                    RowBox[{"Flatten", "[", "#", "]"}]}], "&"}], "/@", " ", 
                    RowBox[{
                    RowBox[{"contBrHTs2", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
                    RowBox[{"2", "*", 
                    RowBox[{"Length", "[", "Op1", "]"}]}]}], "]"}], "//", 
                    "Flatten"}], "]"}], "]"}]}], "}"}], "]"}]}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"RemainHTs", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"j1", ",", 
                    RowBox[{"Length", "[", "RemainHTs", "]"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
                    RowBox[{"Flatten", "[", "#", "]"}]}], "&"}], "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"contractBrHTs", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{"ValConHK", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"CombineHTs", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}], "}"}]}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"contractBrHTs", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"j1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"CombineHTs", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"k1", ",", 
                    RowBox[{"Length", "[", "ValConHK", "]"}]}], "}"}]}], 
                    "]"}]}], ",", 
                  RowBox[{"Sequence", "[", "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"SignCont", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"sign", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"FullContract", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "}"}], ",", 
                    "ManyBodyTermsT"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"FullContract", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"FullContract", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"k1", ",", 
                    RowBox[{"Length", "[", "FullContract", "]"}]}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"FullContract", ",", "BoolString", ",", "SignCont"}], 
                "}"}]}], " ", "\[IndentingNewLine]", " ", ",", 
              RowBox[{"{", 
               RowBox[{"Z1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{"ManyBodyStrings", "[", 
                   RowBox[{"[", "X1", "]"}], "]"}], "[", 
                  RowBox[{"[", "Y1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"Y1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"ManyBodyStrings", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"X1", ",", 
            RowBox[{"Length", "[", "ManyBodyStrings", "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "ManyBodyTermsF", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "It", " ", "is", " ", "used", " ", "For", " ", "Full", " ", "Contractions",
     " ", "including", " ", "contractions", " ", "of", " ", "indexes", " ", 
    "between", " ", "the", " ", "bra", " ", "and", " ", "the", " ", "ket"}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eomcontractexternal", "[", "Strings_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ls", ",", "let1", ",", "num1", ",", "parnum", ",", "ld1", ",", "ld2", 
       ",", "ld3", ",", "ld4", ",", "ld5", ",", "ld6", ",", "ld7", ",", "ld8",
        ",", "externalcontract", ",", "delkron", ",", "a1", ",", "a2", ",", 
       "a3", ",", "a4", ",", "tup1", ",", "tup2", ",", "tup3", ",", "tup4", 
       ",", "a5", ",", "kronlength", ",", "numinbra1", ",", "numinbra2", ",", 
       "pretup1", ",", "pretup2", ",", "delkron1", ",", "delkron2", ",", 
       "deletecontracted", ",", "delcont1", ",", "pos", ",", "remlist", ",", 
       "remlist0", ",", "remlist01", ",", "remlist02", ",", "remlist1", ",", 
       "remlist2", ",", "remlist3", ",", "etet1", ",", "etet2", ",", 
       "tupdisc1", ",", "tupdisc2", ",", "nonunicdisc", ",", "pos2", ",", 
       "disconected", ",", "tabdiscon", ",", "sub", ",", "list", ",", "list2",
        ",", "list3", ",", "permbraket"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"ls", "=", 
       RowBox[{"{", "}"}]}], ";", "   ", 
      RowBox[{"let1", "=", 
       RowBox[{"{", "}"}]}], ";", " ", 
      RowBox[{"num1", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", "Strings", "]"}], "[", 
             RowBox[{"[", "i1", "]"}], "]"}], "[", 
            RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"ls", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Flatten", "[", "Strings", "]"}], "[", 
              RowBox[{"[", "i1", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"ls", ",", 
            RowBox[{
             RowBox[{"Flatten", "[", "Strings", "]"}], "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"Flatten", "[", "Strings", "]"}], "]"}]}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"let1", "=", 
       RowBox[{
        RowBox[{"ImportString", "[", 
         RowBox[{
          RowBox[{"ExportString", "[", 
           RowBox[{"ls", ",", "\"\<CSV\>\""}], "]"}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<CSV\>\"", ",", "\"\<RawData\>\""}], "}"}]}], "]"}], 
        " ", "//", "InputForm"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"let1", "=", 
       RowBox[{"Flatten", "/@", " ", "let1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"num1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"i1", ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"let1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"parnum", "=", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"let1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}]}], ";", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"ld1", "=", 
       RowBox[{"{", "}"}]}], ";", " ", 
      RowBox[{"ld2", "=", 
       RowBox[{"{", "}"}]}], ";", "   ", 
      RowBox[{"ld3", "=", 
       RowBox[{"{", "}"}]}], ";", " ", 
      RowBox[{"ld4", "=", 
       RowBox[{"{", "}"}]}], ";", "   ", 
      RowBox[{"ld5", "=", 
       RowBox[{"{", "}"}]}], ";", "    ", 
      RowBox[{"ld6", "=", 
       RowBox[{"{", "}"}]}], ";", "    ", 
      RowBox[{"ld7", "=", 
       RowBox[{"{", "}"}]}], ";", " ", 
      RowBox[{"ld8", "=", 
       RowBox[{"{", "}"}]}], ";", "  ", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Strings", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "j1", "]"}], "]"}], "[", 
             RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"ld1", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Strings", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"ld2", ",", 
             RowBox[{
              RowBox[{"Strings", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "j1", "]"}], "]"}]}], "]"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"j1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"Strings", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Strings", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", "j1", "]"}], "]"}], "[", 
             RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"ld3", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Strings", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"ld4", ",", 
             RowBox[{
              RowBox[{"Strings", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", "j1", "]"}], "]"}]}], "]"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"j1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"Strings", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Strings", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "[", 
              RowBox[{"[", "k1", "]"}], "]"}], "[", 
             RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"ld5", ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Strings", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "[", 
                RowBox[{"[", "j1", "]"}], "]"}], "[", 
               RowBox[{"[", "k1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"ld6", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Strings", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "[", 
              RowBox[{"[", "k1", "]"}], "]"}]}], "]"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"j1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"Strings", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
            RowBox[{"Strings", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "[", 
            RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Strings", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "[", 
              RowBox[{"[", "j1", "]"}], "]"}], "[", 
             RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"ld7", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Strings", "[", 
                RowBox[{"[", "4", "]"}], "]"}], "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"ld8", ",", 
             RowBox[{
              RowBox[{"Strings", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "[", 
              RowBox[{"[", "j1", "]"}], "]"}]}], "]"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"j1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"Strings", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Contractions", " ", "between", " ", "the", " ", "bra", " ", "and", 
        " ", "ket"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"externalcontract", "=", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"Strings", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Strings", "[", 
                  RowBox[{"[", "4", "]"}], "]"}], "]"}], "+", "i1"}]}], ",", 
              "Null", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Element", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", 
                   RowBox[{"Length", "[", 
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}], "-", "i1"}], ",", 
                  "NegativeIntegers"}], "]"}], ",", "Null", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"i1", "-", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ">", "2"}], ",", 
                  "Null", ",", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}], "-", "i1"}], ")"}],
                     "/", "2"}], ")"}]}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "4", ",", "6"}], "}"}]}], "}"}]}], "]"}], 
          " ", "/.", " ", 
          RowBox[{"Null", " ", "->", " ", 
           RowBox[{"Sequence", "[", "]"}]}]}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Contractions", " ", "between", " ", "the", " ", "bra", " ", "and", 
        " ", "ket"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"externalcontract", "=", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"Strings", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Strings", "[", 
                  RowBox[{"[", "4", "]"}], "]"}], "]"}], "+", "i1"}]}], ",", 
              "Null", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Element", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", 
                   RowBox[{"Length", "[", 
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}], "-", "i1"}], ",", 
                  "NegativeIntegers"}], "]"}], ",", "Null", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"i1", "<=", 
                   RowBox[{"Length", "[", 
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "Null", ",", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}], "-", "i1"}], ")"}],
                     "/", "2"}], ")"}]}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "4", ",", "6"}], "}"}]}], "}"}]}], "]"}], 
          " ", "/.", " ", 
          RowBox[{"Null", " ", "->", " ", 
           RowBox[{"Sequence", "[", "]"}]}]}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"externalcontract", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Strings", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Strings", "[", 
                RowBox[{"[", "4", "]"}], "]"}], "]"}], "+", "i1"}]}], ",", 
            "Null", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Element", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Strings", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Strings", "[", 
                   RowBox[{"[", "4", "]"}], "]"}], "]"}], "-", "i1"}], ",", 
                "NegativeIntegers"}], "]"}], ",", "Null", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}], "-", "i1"}], ")"}],
                    "/", "2"}], ")"}], ">", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Strings", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "Null", ",", 
                
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}], "-", "i1"}], ")"}],
                   "/", "2"}], ")"}]}], "]"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "4", ",", "6", ",", "8"}], "}"}]}], "}"}]}], 
         "]"}], "  ", "/.", " ", 
        RowBox[{"Null", " ", "->", " ", 
         RowBox[{"Sequence", "[", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "All", " ", "permutations", " ", "between", " ", "bra", " ", "and", 
        " ", "ket"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"delkron", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"permbraket", "=", 
           RowBox[{"Subsets", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{
               RowBox[{"Tuples", "[", 
                RowBox[{"{", 
                 RowBox[{"ld1", ",", "ld8"}], "}"}], "]"}], ",", 
               RowBox[{"Tuples", "[", 
                RowBox[{"{", 
                 RowBox[{"ld2", ",", "ld7"}], "}"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", "j1", "}"}]}], "]"}]}], " ", ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"DeleteDuplicates", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"permbraket", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}], "]"}], "==",
                 " ", 
                RowBox[{"2", "*", "j1"}]}], ",", 
               RowBox[{"permbraket", "[", 
                RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", 
               RowBox[{"Length", "[", "permbraket", "]"}]}], "}"}]}], "]"}], 
           " ", "/.", " ", 
           RowBox[{"Null", " ", "->", " ", 
            RowBox[{"Sequence", "[", "]"}]}]}]}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"{", 
          RowBox[{"j1", ",", "externalcontract"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"All", " ", "permutations", " ", "bra"}], "-", "H"}], ",", 
        " ", 
        RowBox[{"bra", "-", 
         RowBox[{
          RowBox[{"T", "'"}], "s"}]}], ",", " ", 
        RowBox[{"bra", "-", 
         RowBox[{"ket", " ", "between"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"a1", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{"ld2", ",", "ld3"}], "}"}], "]"}], ",", 
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{"ld2", ",", "ld5"}], "}"}], "]"}], ",", 
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{"ld2", ",", "ld7"}], "}"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a2", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{"ld1", ",", "ld4"}], "}"}], "]"}], ",", 
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{"ld1", ",", "ld6"}], "}"}], "]"}], ",", 
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{"ld1", ",", "ld8"}], "}"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"All", " ", "permutations", " ", "H"}], "-", 
         RowBox[{
          RowBox[{"T", "'"}], "s"}]}], ",", " ", 
        RowBox[{"H", "-", 
         RowBox[{"ket", " ", "between"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"a3", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{"ld3", ",", "ld6"}], "}"}], "]"}], ",", 
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{"ld3", ",", "ld8"}], "}"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a4", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{"ld4", ",", "ld5"}], "}"}], "]"}], ",", 
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{"ld4", ",", "ld7"}], "}"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tup1", ",", "tup2", ",", "tup3", ",", "tup4"}], "}"}], "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"j1", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", "}"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"Length", "[", "delkron", "]"}]}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ld1", "^"}], "*"}], ",", "ld2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ld3", "^"}], "*"}], ",", "ld4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ld5", "^"}], "*"}], ",", "ld6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ld7", "^"}], "*"}], ",", "ld8"}], "}"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"remove", " ", "the", " ", "indices", " ", "of", " ", "a1"}], 
        ",", " ", "a2", ",", " ", "a3", ",", " ", 
        RowBox[{"a4", " ", "that", " ", "appear", " ", "in", " ", "delkron", 
         RowBox[{"(", 
          RowBox[{"bra", "-", "ket"}], ")"}]}], " ", ",", " ", 
        RowBox[{"and", " ", "genearte", " ", "tup1"}], ",", " ", "tup2", ",", 
        " ", 
        RowBox[{
        "tup3", " ", "and", " ", "tup4", " ", "for", " ", "each", " ", 
         "deltakron", " ", "we", " ", "have", " ", "as", " ", "much", " ", 
         "list", " ", "of", " ", "tups", " ", "as", " ", "the", " ", "size", 
         " ", "of", " ", "delkron"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tup1", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], ",", 
            RowBox[{"tup2", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], "}"}], "=", 
          RowBox[{"RemoveContracted", "[", 
           RowBox[{"a1", ",", "a2", ",", 
            RowBox[{"delkron", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"tup3", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], ",", 
            RowBox[{"tup4", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], "}"}], "=", 
          RowBox[{"RemoveContracted", "[", 
           RowBox[{"a3", ",", "a4", ",", 
            RowBox[{"delkron", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i1", ",", 
          RowBox[{"Length", "[", "delkron", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Union", " ", "of", " ", "all", " ", "tuples", " ", "from", " ", 
          "bra"}], "-", "H"}], ",", " ", 
        RowBox[{"bra", "-", 
         RowBox[{
          RowBox[{"T", "'"}], "s"}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"a5", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tup3", "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"tup4", "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "[", 
              RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]",
            ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"tup3", "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j1", ",", 
           RowBox[{"Length", "[", "tup3", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"N", "[", "bra", "]"}], "-"}], "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"kronlength", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Strings", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", 
          RowBox[{"Length", "[", 
           RowBox[{
            RowBox[{"delkron", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", 
           RowBox[{"Length", "[", "delkron", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Select", " ", "wich", " ", "got", " ", "a", " ", "repeated", " ", 
         "index", " ", "either", " ", "a"}], " ", ",", " ", "b", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"...", ".", " ", "if"}], " ", "contain", " ", "both"}], " ",
          "=", 
         RowBox[{
          RowBox[{"2", " ", "if", " ", "contain", " ", "one"}], " ", "=", 
          "1"}]}], ",", "..."}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"numinbra1", "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Intersection", "[", 
             RowBox[{
              RowBox[{"DeleteDuplicates", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"tup1", "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "[", 
                 RowBox[{"[", "i1", "]"}], "]"}], "]"}], " ", "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"ld1", ",", "ld2"}], "]"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"tup1", "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j1", ",", 
           RowBox[{"Length", "[", "tup1", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Select", " ", "wich", " ", "got", " ", "a", " ", "repeated", " ", 
         "index", " ", "either", " ", "i", " ", "or", " ", "j"}], ",", " ", 
        RowBox[{
         RowBox[{"if", " ", "contain", " ", "boath"}], " ", "=", 
         RowBox[{
          RowBox[{"2", " ", "if", " ", "contain", " ", "one"}], " ", "=", 
          "1"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"numinbra2", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Intersection", "[", 
             RowBox[{
              RowBox[{"DeleteDuplicates", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"tup2", "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "[", 
                 RowBox[{"[", "i1", "]"}], "]"}], "]"}], " ", "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"ld1", ",", "ld2"}], "]"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"tup2", "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j1", ",", 
           RowBox[{"Length", "[", "tup2", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "generate", "  ", "the", " ", "subsets", " ", "of", " ", "tup1", " ", 
        "of", " ", "length", " ", "equal", " ", "the", " ", "number", " ", 
        "of", " ", "niumbra"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"pretup1", "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"DeleteDuplicates", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Subsets", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"tup1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"numinbra1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "}"}]}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}], "]"}], "==", 
                 RowBox[{"2", "*", 
                  RowBox[{
                   RowBox[{"numinbra1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}]}]}], ",", 
                RowBox[{
                 RowBox[{"Subsets", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"tup1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"numinbra1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "}"}]}], "]"}], "[", 
                 RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"Subsets", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"tup1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"numinbra1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "}"}]}], "]"}], "]"}]}], 
               "}"}]}], "]"}], " ", "/.", " ", 
            RowBox[{"Null", " ", "->", " ", 
             RowBox[{"Sequence", "[", "]"}]}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"j1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"tup1", "[", 
               RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", 
           RowBox[{"Length", "[", "tup1", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "generate", "  ", "the", " ", "subsets", " ", "of", " ", "tup1", " ", 
        "of", " ", "length", " ", "equal", " ", "the", " ", "number", " ", 
        "of", " ", "contractions", " ", "en", " ", "each", " ", "tup2_", 
        RowBox[{"{", "ijk", "}"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"pretup2", "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"DeleteDuplicates", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Subsets", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"tup2", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"numinbra2", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "}"}]}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}], "]"}], "==", 
                 RowBox[{"2", "*", 
                  RowBox[{
                   RowBox[{"numinbra2", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}]}]}], ",", 
                RowBox[{
                 RowBox[{"Subsets", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"tup2", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"numinbra2", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "}"}]}], "]"}], "[", 
                 RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"Subsets", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"tup2", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"numinbra2", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "}"}]}], "]"}], "]"}]}], 
               "}"}]}], "]"}], "  ", "/.", " ", 
            RowBox[{"Null", " ", "->", " ", 
             RowBox[{"Sequence", "[", "]"}]}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"j1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"tup2", "[", 
               RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", 
           RowBox[{"Length", "[", "tup1", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"delkron1", "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Map", "[", "Flatten", "]"}], "@", " ", 
            RowBox[{"Tuples", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"pretup1", "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"pretup2", "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}]}], "}"}], "]"}]}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"pretup1", "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j1", ",", 
           RowBox[{"Length", "[", "pretup1", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Separate", " ", "the", " ", "terms", " ", "in", " ", "pairs"}], ",", 
        " ", 
        RowBox[{
        "this", " ", "is", " ", "based", " ", "on", " ", "tup1", " ", "and", 
         " ", "tup2"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"delkron2", "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"delkron1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "]"}], ">=", "4"}], ",", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"delkron1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], ",", "2"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"delkron1", "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{"delkron1", "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"j1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"delkron1", "[", 
               RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", 
           RowBox[{"Length", "[", "delkron1", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Look", " ", "fo", " ", "the", " ", "position", " ", "of", " ", 
          "delkron2"}], "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Tuples", "[", 
            RowBox[{"pretup1", ",", "pretup2"}], "]"}], " ", "in", " ", 
           "a5"}], "=", 
          RowBox[{"tup3", " ", "U", " ", "tup4"}]}]}], ",", " ", 
        RowBox[{"this", " ", "is", " ", "based", " ", "on", " ", "a5"}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"deletecontracted", "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Floor", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"a5", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"delkron2", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], "+", "1"}], 
                    ")"}], "/", "2"}], "]"}], " ", "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"i1", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"delkron2", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], 
                "]"}], "   ", "//", " ", "Flatten"}], " ", "//", " ", 
              "DeleteDuplicates"}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{"delkron2", "[", 
                  RowBox[{"[", "l1", "]"}], "]"}], "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"delkron2", "[", 
               RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"l1", ",", 
           RowBox[{"Length", "[", "delkron2", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"deletecontracted", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"deletecontracted", "[", 
              RowBox[{"[", "l1", "]"}], "]"}], "[", 
             RowBox[{"[", "k1", "]"}], "]"}], "[", 
            RowBox[{"[", "j1", "]"}], "]"}], "[", 
           RowBox[{"[", "i1", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l1", ",", 
           RowBox[{"Length", "[", "deletecontracted", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"deletecontracted", "[", 
             RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"deletecontracted", "[", 
              RowBox[{"[", "l1", "]"}], "]"}], "[", 
             RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"deletecontracted", "[", 
               RowBox[{"[", "l1", "]"}], "]"}], "[", 
              RowBox[{"[", "k1", "]"}], "]"}], "[", 
             RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "to", " ", "avoid", " ", "repeated", " ", "indexes", " ", "remove", 
         " ", "the", " ", "delkron2", " ", "that", " ", "are", " ", "in", " ",
          "a5"}], "=", 
        RowBox[{"tup3", " ", "U", " ", "tup4"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"delcont1", "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"a5", "[", 
                 RowBox[{"[", "l1", "]"}], "]"}], "[", 
                RowBox[{"[", "k1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"deletecontracted", "[", 
                  RowBox[{"[", "l1", "]"}], "]"}], "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", "j1", "]"}], "]"}]}], "]"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{"deletecontracted", "[", 
                  RowBox[{"[", "l1", "]"}], "]"}], "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"deletecontracted", "[", 
               RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"l1", ",", 
           RowBox[{"Length", "[", "deletecontracted", "]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Look", " ", "for", " ", "the", " ", "positions", " ", "in", " ", 
        "delcont1", " ", "where", " ", "we", " ", "can", "  ", "form", " ", 
        "4", " ", "tuples", " ", "each", " ", "one", " ", "containing", " ", 
        RowBox[{"{", 
         RowBox[{"p", ",", "q", ",", "r", ",", "s"}], "}"}], " ", "a", " ", 
        "WE", " ", "NEED", " ", "TO", " ", "RECHECK", " ", "THAT", " ", 
        "FUNCTION"}], "  ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"Union", "[", 
                   RowBox[{"ld3", ",", "ld4"}], "]"}], ",", 
                  RowBox[{"DeleteDuplicates", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"delcont1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
                "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"i1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{
                   RowBox[{"delcont1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
             ",", " ", 
             RowBox[{"(", 
              RowBox[{"parnum", "-", 
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{"delkron", "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"delkron1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}], ")"}]}],
               ")"}]}], "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"j1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"delcont1", "[", 
               RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", 
           RowBox[{"Length", "[", "delcont1", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Apply", " ", "the", " ", "possition", " ", "in", " ", "delcont", " ", 
        "where", " ", "we", " ", "can", " ", "form", "  ", "4", " ", "tuples",
         " ", "each", " ", "one", " ", "containing", " ", 
        RowBox[{"{", 
         RowBox[{"p", ",", "q", ",", "r", ",", "s"}], "}"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"remlist0", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"delcont1", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", "j1", "]"}], "]"}], "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", 
               RowBox[{
                RowBox[{"pos", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", "j1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"delcont1", "[", 
               RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", 
           RowBox[{"Length", "[", "delcont1", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"remlist1", "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"delkron2", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", "j1", "]"}], "]"}], "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", 
               RowBox[{
                RowBox[{"pos", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", "j1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"delcont1", "[", 
               RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", 
           RowBox[{"Length", "[", "delcont1", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Remove", " ", "the", " ", "disconected", " ", "terms", " ", "by", 
         " ", "counting", " ", "how", " ", "many", " ", "terms", " ", "from", 
         " ", "bra", " ", "and", " ", "ket", " ", "are", " ", "in", " ", 
         "delkron2"}], "=", " ", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"pretup1", 
           RowBox[{"(", "tup1", ")"}]}], ",", 
          RowBox[{"pretup2", 
           RowBox[{"(", "tup2", ")"}]}]}], "]"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"remlist3", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"remlist1", "[", 
                RowBox[{"[", "l1", "]"}], "]"}], "[", 
               RowBox[{"[", "k1", "]"}], "]"}], "[", 
              RowBox[{"[", "j1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Union", "[", 
             RowBox[{"ld1", ",", "ld2", ",", "ld7", ",", "ld8"}], "]"}]}], 
           "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"l1", ",", 
           RowBox[{"Length", "[", "remlist1", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"remlist1", "[", 
             RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"remlist1", "[", 
              RowBox[{"[", "l1", "]"}], "]"}], "[", 
             RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos2", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"remlist3", "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"delkron1", "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"remlist3", "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j1", ",", 
           RowBox[{"Length", "[", "remlist3", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"remlist01", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"remlist0", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", "j1", "]"}], "]"}], "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", 
               RowBox[{
                RowBox[{"pos2", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", "j1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"remlist0", "[", 
               RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"k1", ",", 
           RowBox[{"Length", "[", "remlist0", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"remlist02", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"remlist1", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", "j1", "]"}], "]"}], "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", 
               RowBox[{
                RowBox[{"pos2", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", "j1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"remlist1", "[", 
               RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"k1", ",", 
           RowBox[{"Length", "[", "remlist1", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Generate", " ", "the", " ", "disconected", " ", "terms", " ", 
          "related", " ", "to", " ", "contraction"}], " ", "<", "BRA"}], "|", 
        
        RowBox[{
         RowBox[{"-", 
          RowBox[{"T", "'"}]}], "s"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"etet1", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Strings", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "[", 
                RowBox[{"[", "j1", "]"}], "]"}], "[", 
               RowBox[{"[", "k1", "]"}], "]"}], "[", 
              RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], ",", 
            "Null", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Strings", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "[", 
              RowBox[{"[", "j1", "]"}], "]"}], "[", 
             RowBox[{"[", "k1", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
          ",", 
          RowBox[{"{", 
           RowBox[{"j1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"Strings", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{"Strings", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "[", 
              RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], " ", "/.",
         " ", 
        RowBox[{"Null", " ", "->", " ", 
         RowBox[{"Sequence", "[", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"etet2", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Strings", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "[", 
                RowBox[{"[", "j1", "]"}], "]"}], "[", 
               RowBox[{"[", "k1", "]"}], "]"}], "[", 
              RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Strings", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "[", 
              RowBox[{"[", "k1", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "Null"}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"Strings", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{"Strings", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "[", 
              RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], " ", "/.",
         " ", 
        RowBox[{"Null", " ", "->", " ", 
         RowBox[{"Sequence", "[", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tupdisc1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{"ld1", ",", 
            RowBox[{"etet1", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", 
           RowBox[{"Length", "[", "etet1", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tupdisc2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{"ld2", ",", 
            RowBox[{"etet2", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", 
           RowBox[{"Length", "[", "etet2", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nonunicdisc", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Subsets", "[", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{"tupdisc1", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"tupdisc2", "[", 
              RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{"Strings", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "[", 
              RowBox[{"[", "i1", "]"}], "]"}], "]"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"Strings", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"disconected", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"selectcorrectcontract", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nonunicdisc", "[", 
                RowBox[{"[", "j1", "]"}], "]"}], "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"Strings", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "[", 
               RowBox[{"[", "j1", "]"}], "]"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"nonunicdisc", "[", 
                RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], " ",
           "/.", " ", 
          RowBox[{"Null", " ", "->", " ", 
           RowBox[{"Sequence", "[", "]"}]}]}], " ", "\[IndentingNewLine]", 
         ",", 
         RowBox[{"{", 
          RowBox[{"j1", ",", 
           RowBox[{"Length", "[", "nonunicdisc", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"tabdiscon", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"remlist02", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"disconected", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}], "]"}], "]"}], "==", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"remlist02", "[", 
                    RowBox[{"[", "m1", "]"}], "]"}], "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                   ",", "True"}], "]"}], "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"j1", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"disconected", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"k1", ",", 
                 RowBox[{"Length", "[", "disconected", "]"}]}], "}"}]}], 
              "]"}], " ", "//", " ", "Flatten"}], " ", "//", " ", "Sort"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"l1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"remlist02", "[", 
               RowBox[{"[", "m1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"m1", ",", 
           RowBox[{"Length", "[", "remlist02", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"remlist", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"remlist01", "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"Partition", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"tabdiscon", "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}], ",", "1"}], "]"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"tabdiscon", "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j1", ",", 
           RowBox[{"Length", "[", "tabdiscon", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"remlist2", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"remlist02", "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"Partition", "[", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"tabdiscon", "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}], ",", "1"}], "]"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"tabdiscon", "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j1", ",", 
           RowBox[{"Length", "[", "tabdiscon", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"sub", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Subsets", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"remlist", "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"Length", "[", 
                 RowBox[{"Intersection", "[", 
                  RowBox[{
                   RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"remlist", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}], ",", 
                   RowBox[{"Union", "[", 
                    RowBox[{"ld3", ",", "ld4"}], "]"}]}], "]"}], "]"}], 
                "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{"remlist", "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"j1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"remlist", "[", 
               RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", 
           RowBox[{"Length", "[", "remlist", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"list", "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"sub", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}], "]"}], "==", 
                   RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{"parnum", "-", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"delkron", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"delkron1", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}], 
                    ")"}]}], ")"}]}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"sub", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                   RowBox[{"[", "i1", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"sub", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
              "  ", "/.", " ", 
              RowBox[{"Null", " ", "->", " ", 
               RowBox[{"Sequence", "[", "]"}]}]}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{"sub", "[", 
                  RowBox[{"[", "l1", "]"}], "]"}], "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"sub", "[", 
               RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"l1", ",", 
           RowBox[{"Length", "[", "sub", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"The", " ", "complete", " ", "contractions"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"list2", "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"delkron", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"remlist2", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}], "}"}], "]"}], ",", 
                 "2"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{"remlist2", "[", 
                  RowBox[{"[", "l1", "]"}], "]"}], "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"delkron", "[", 
               RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"l1", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"partilal", " ", "contractions"}], " ", ",", " ", 
        RowBox[{
        "avoiding", " ", "the", " ", "external", " ", "contractrions"}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"list3", "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"remlist2", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}], "}"}], "]"}], ",", 
                 "2"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{"remlist2", "[", 
                  RowBox[{"[", "l1", "]"}], "]"}], "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"k1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"delkron", "[", 
               RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"l1", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"list2", ",", "list3", ",", "delkron"}], "}"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8740462136613283`*^9, 3.8740462696730337`*^9}, 
   3.8740463027244864`*^9, {3.874050620628778*^9, 3.874050692370591*^9}, {
   3.874050799265333*^9, 3.87405105118128*^9}, {3.874051165013463*^9, 
   3.874051177491848*^9}, 3.874051323782207*^9, {3.874051713579225*^9, 
   3.874051728954122*^9}, {3.8740519158199663`*^9, 3.874051948489339*^9}, 
   3.874055393871625*^9, {3.874056302495263*^9, 3.874056411256979*^9}, {
   3.874056495391468*^9, 3.874056524937037*^9}, {3.874060067142519*^9, 
   3.874060084727127*^9}, {3.876386213053688*^9, 3.876386225463839*^9}, {
   3.876566074564039*^9, 3.876566075782391*^9}, {3.8765661184378853`*^9, 
   3.8765661226377172`*^9}, {3.876823006921568*^9, 3.876823031048077*^9}, {
   3.876828075016243*^9, 3.876828075359166*^9}, {3.876828156078476*^9, 
   3.8768281562513027`*^9}, {3.876828424874578*^9, 3.876828438074842*^9}, {
   3.877519922125456*^9, 3.8775199299688263`*^9}, 3.8776876896047773`*^9, {
   3.877687723339065*^9, 3.877687873817952*^9}, {3.877694997211802*^9, 
   3.877694998314351*^9}, {3.87769542551853*^9, 3.8776954259697*^9}, {
   3.877757848867889*^9, 3.8777578734204063`*^9}, 3.885383274052952*^9, {
   3.88538424709728*^9, 3.885384280262682*^9}, {3.885454467319872*^9, 
   3.8854545004704227`*^9}, 3.885454993767891*^9, {3.88545704775596*^9, 
   3.885457048094132*^9}, {3.885458438282889*^9, 3.885458444462482*^9}, {
   3.885458565210349*^9, 3.88545857160496*^9}, {3.885458606779695*^9, 
   3.88545862686097*^9}, {3.885550469603838*^9, 3.885550471585639*^9}, {
   3.885550519968245*^9, 3.8855505223858128`*^9}, {3.885550569494059*^9, 
   3.8855505818537407`*^9}, 3.886059712241634*^9, 3.8865054327263107`*^9, 
   3.886576122009179*^9, {3.886577877091332*^9, 3.886577879773456*^9}, {
   3.886582132037608*^9, 3.886582139816516*^9}, {3.887433160357417*^9, 
   3.887433161589773*^9}, {3.887433199208783*^9, 3.8874332031608973`*^9}, {
   3.887433276407501*^9, 3.887433318705804*^9}, {3.887433528716878*^9, 
   3.887433529303619*^9}, {3.887453266588869*^9, 3.887453271805749*^9}, {
   3.887454533246707*^9, 3.887454535821306*^9}, {3.891057721632883*^9, 
   3.8910577217866077`*^9}, {3.891066173137312*^9, 3.891066350817617*^9}, {
   3.891332638715384*^9, 3.8913326471041193`*^9}, {3.891581717547339*^9, 
   3.891581718188017*^9}, {3.8920155605830097`*^9, 3.8920155922337303`*^9}, {
   3.8920156844049053`*^9, 3.892015686082747*^9}, {3.892015738984352*^9, 
   3.892015759568145*^9}, 3.892015868849118*^9, {3.892015916078726*^9, 
   3.8920159523868237`*^9}, {3.892016031814167*^9, 3.892016045200835*^9}, {
   3.892016235900589*^9, 3.892016247081257*^9}, {3.892016381127943*^9, 
   3.8920163876354856`*^9}, 3.892101796370564*^9, {3.892260943466346*^9, 
   3.89226098292632*^9}, {3.89226355169071*^9, 3.892263552572575*^9}, {
   3.893143417264896*^9, 3.893143428481234*^9}, {3.893145605179286*^9, 
   3.893145632805784*^9}, {3.89314856750149*^9, 3.893148574246645*^9}, 
   3.894588987600687*^9, {3.894600380191877*^9, 3.894600435173551*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"6b94466e-ee05-47fe-8420-3fe5ab532013"]
}, Closed]],

Cell[CellGroupData[{

Cell["AntSymPermut ", "Section",
 CellChangeTimes->{{3.8502124694131107`*^9, 3.850212483911498*^9}, {
   3.8508075976382303`*^9, 3.850807637386962*^9}, {3.85157491870508*^9, 
   3.8515749220559587`*^9}, {3.851575053203541*^9, 3.851575059139056*^9}, 
   3.851575661024029*^9, {3.85157970682765*^9, 3.851579715418345*^9}, {
   3.853485369144342*^9, 3.853485401318177*^9}, {3.8538499840059443`*^9, 
   3.853849987654407*^9}, {3.858858281395907*^9, 3.858858293975215*^9}, {
   3.85935042931706*^9, 3.85935043074402*^9}, 3.859354082555974*^9, {
   3.8605585516079884`*^9, 3.860558649112575*^9}, {3.886071266429615*^9, 
   3.886071271370454*^9}, {3.886071575630444*^9, 3.8860715807422743`*^9}, {
   3.892102492278777*^9, 3.892102539253099*^9}, {3.8922636450594587`*^9, 
   3.892263650924816*^9}},ExpressionUUID->"50eb3c8a-6bf8-4e01-962a-\
e0b58ba5593e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "AntSymPermut", " ", "requires", " ", "the", " ", "input", " ", 
    "quantities", " ", "DeltaKronecker"}], ",", " ", "ManyBodyStrings", ",", 
   RowBox[{"and", " ", 
    RowBox[{"Amplitudes", ".", " ", "This"}], " ", "module", " ", "applies", 
    " ", "delta", " ", "Kronecker", " ", "to", " ", "the", " ", 
    "Amplitudes"}], ",", 
   RowBox[{
    RowBox[{
    "the", " ", "elements", " ", "of", " ", "the", " ", "Fock", " ", 
     "operator", " ", "and", " ", "two"}], "-", 
    RowBox[{"electron", " ", 
     RowBox[{"integrals", ".", " ", "Then"}], " ", "the", " ", "Permutation", 
     " ", "Antisymmetry", " ", "is", " ", 
     RowBox[{"applied", "."}]}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.89226365430518*^9, 3.892263721553784*^9}, {
   3.892263828010153*^9, 3.8922638896812353`*^9}, {3.892264269666418*^9, 
   3.892264318353641*^9}, {3.8922643546083508`*^9, 3.892264477655486*^9}, {
   3.892264780803845*^9, 3.892264927348462*^9}, {3.8922674901153097`*^9, 
   3.892267496475069*^9}, 3.892267941443033*^9, {3.893143332000948*^9, 
   3.893143384013426*^9}, {3.893149054655205*^9, 3.893149063246254*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"72a1b8a2-95fe-4b33-bca5-82c82d046a4d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AntSymPermut", "[", 
     RowBox[{"DeltaKronecker_", ",", "ManyBodyStrings_", ",", "Amplitudes_"}],
      "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "DeltaKronecker1", ",", "ManyBodyStrings1", ",", "SQManyBody", ",", 
        "NumberClust", ",", "PreFactors", ",", "PositionString", ",", 
        "DelKronPosit", ",", "SQPosit", ",", "AmplPosit", ",", "SignPosit", 
        ",", "RepeatAmplitudes", ",", "DelKronPartit", ",", "IntegralsPosit", 
        ",", "KronAmplRem", ",", "SingAmpl", ",", "AmplitudesReplaced", ",", 
        "CreAnhClust", ",", "DummyCreAnh", ",", "DummyCreAnh1", ",", 
        "IntegralsAmplitudesDummy", ",", "AmplitudesDummie", ",", 
        "PositDumIntAmp", ",", "RepAntySimAmplitudes", ",", "SignAfterPermut",
         ",", "IntegralsAmplitudes", ",", "IntegralsAmplitudes2", ",", 
        "JusClusInd", ",", "LengClust", ",", "SepClusIndN", ",", "SepClusInd",
         ",", "PosRepClos", ",", "FinalPrefactor", ",", "SetForERI", ",", 
        "SQManyBodyOp", ",", "IndManyBodyOp", ",", "IndSepManyBodyOp", ",", 
        "ManyBodyTernsFinal", ",", "PosSQManyBody"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"DeltaKronecker1", "=", 
          RowBox[{"DeltaKronecker", "[", 
           RowBox[{"[", "NN", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ManyBodyStrings1", "=", 
          RowBox[{"ManyBodyStrings", "[", 
           RowBox[{"[", "NN", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"SQManyBody", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"ManyBodyStrings1", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"NumberClust", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "#", "]"}], "&"}], "/@", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "&"}], "/@", 
              RowBox[{
               RowBox[{"Amplitudes", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ";;"}], "]"}], "]"}]}], ")"}], "/", "2"}], 
           ")"}]}], " ", ";", "\[IndentingNewLine]", 
         RowBox[{"PreFactors", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"Amplitudes", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"{", "}"}]}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Times", "[", 
                 RowBox[{"Sequence", "@@", "#"}], "]"}], "&"}], "/@", " ", 
               RowBox[{"(", 
                RowBox[{"NumberClust", "/.", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"i1", "  ", "->", " ", 
                    RowBox[{"1", "/", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"i1", "!"}], ")"}], "2"]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Flatten", "[", "NumberClust", "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], ")"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Max", "[", 
                    RowBox[{"Counts", "@", "#"}], "]"}], ")"}], "!"}], 
                  ")"}]}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "&"}], "/@", 
                   RowBox[{
                    RowBox[{"Amplitudes", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], ")"}], "/", "2"}], 
                ")"}]}], ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Remove", " ", "the", " ", "terms", " ", 
            RowBox[{"HT", "'"}], "s", " ", "inside", " ", "each", " ", 
            "many"}], "-", 
           RowBox[{"body", " ", "term"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"PositionString", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"DeltaKronecker1", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                   RowBox[{"[", "i1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i1", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"ManyBodyStrings1", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
               ",", "True"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", "DeltaKronecker1", "]"}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Use", " ", "the", " ", "positions", " ", "from", " ", 
           "PositionString", " ", "and", " ", "aply", " ", "it", " ", "to", 
           " ", "DeltaKronecker1"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"DelKronPosit", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Delete", "[", 
               RowBox[{"DeltaKronecker1", ",", 
                RowBox[{"Position", "[", 
                 RowBox[{"PositionString", ",", 
                  RowBox[{"{", "}"}]}], "]"}]}], "]"}], "[", 
              RowBox[{"[", "i1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{"PositionString", ",", 
                 RowBox[{"{", "}"}]}], "]"}], "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{"PositionString", ",", 
                 RowBox[{"{", "}"}]}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Use", " ", "the", " ", "positions", " ", "from", " ", 
           "PositionString", " ", "and", " ", "aply", " ", "it", " ", "to", 
           " ", "the", " ", "second", " ", "quantization", " ", "operators"}],
           " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"SQPosit", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Delete", "[", 
               RowBox[{"ManyBodyStrings1", ",", 
                RowBox[{"Position", "[", 
                 RowBox[{"PositionString", ",", 
                  RowBox[{"{", "}"}]}], "]"}]}], "]"}], "[", 
              RowBox[{"[", "i1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{"PositionString", ",", 
                 RowBox[{"{", "}"}]}], "]"}], "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{"PositionString", ",", 
                 RowBox[{"{", "}"}]}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Use", " ", "the", " ", "positions", " ", "from", " ", 
           "PositionString", " ", "and", " ", "aply", " ", "it", " ", "to", 
           " ", "the", " ", "Amplitudes"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"AmplPosit", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Amplitudes", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{"PositionString", ",", 
                 RowBox[{"{", "}"}]}], "]"}], "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{"PositionString", ",", 
                 RowBox[{"{", "}"}]}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Use", " ", "the", " ", "positions", " ", "from", " ", 
           "PositionString", " ", "to", " ", "the", " ", "sign"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"SignPosit", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"DelKronPosit", "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "[", 
                 RowBox[{"[", "i1", "]"}], "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"DelKronPosit", "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", "DelKronPosit", "]"}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Do", " ", "the", " ", "partition", " ", "of", " ", "the", " ", 
           "Delta", " ", "Kronecker"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"DelKronPartit", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Partition", "[", 
               RowBox[{
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"DelKronPosit", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "2"}], "]"}], 
                ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"DelKronPosit", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"DelKronPosit", "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", "DelKronPosit", "]"}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Obtain", " ", "the", " ", "positions", " ", "of", " ", "the", " ", 
           "Amplitudes", " ", "that", " ", "are", " ", "repeated"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"RepeatAmplitudes", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Flatten", "[", "#", "]"}], "&"}], "@", 
                 RowBox[{"krontonint", "[", 
                  RowBox[{
                   RowBox[{"{", "#", "}"}], " ", ",", 
                   RowBox[{
                    RowBox[{"SQPosit", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", "2"}], "]"}]}], 
                "&"}], "/@", " ", 
               RowBox[{
                RowBox[{"DelKronPartit", "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}]}], " ", "\[IndentingNewLine]",
               ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"SQPosit", "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", "SQPosit", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"RepeatAmplitudes", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Flatten", "[", "#", "]"}], "&"}], "@", 
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RepeatAmplitudes", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], " ", ",", "#"}], "]"}]}],
                   "&"}], "/@", 
                 RowBox[{"DeleteDuplicates", "[", " ", 
                  RowBox[{
                   RowBox[{"RepeatAmplitudes", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                   RowBox[{"[", "i1", "]"}], "]"}], " ", "]"}]}], ")"}], "[", 
               
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"SQPosit", "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", "SQPosit", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Use", " ", "the", " ", "positions", " ", "obtained", " ", "by", 
           " ", "RepeatAmplitudes", " ", "and", " ", "apply", " ", "them", 
           " ", "to", " ", "the", " ", "integrals"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"IntegralsPosit", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"krontonint", "[", 
                    RowBox[{
                    RowBox[{"{", "#", "}"}], " ", ",", 
                    RowBox[{
                    RowBox[{"SQPosit", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", "1"}], "]"}], "&"}],
                   "/@", " ", 
                  RowBox[{
                   RowBox[{"DelKronPartit", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                   RowBox[{"[", "i1", "]"}], "]"}]}], ")"}], " ", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"RepeatAmplitudes", "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"SQPosit", "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", "SQPosit", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Use", " ", "the", " ", "positions", " ", "obtained", " ", "by", 
           " ", "AmplPosit", " ", "and", " ", "apply", " ", "them", " ", "to",
            " ", "the", " ", "remaining", " ", "kroneker", " ", "deltas"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"KronAmplRem", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"krontonint", "[", 
                   RowBox[{
                    RowBox[{"{", "#", "}"}], " ", ",", 
                    RowBox[{
                    RowBox[{"SQPosit", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", "2"}], "]"}], "&"}],
                  "/@", 
                 RowBox[{
                  RowBox[{"DelKronPartit", "[", 
                   RowBox[{"[", "j1", "]"}], "]"}], "[", 
                  RowBox[{"[", "i1", "]"}], "]"}]}], ")"}], " ", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"RepeatAmplitudes", "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "[", 
                 RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"SQPosit", "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", "SQPosit", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Use", " ", "the", " ", "positions", " ", "obtained", " ", "in", 
           " ", "AmplPosit", " ", "and", " ", "apply", " ", "them", " ", "to",
            " ", "the", " ", "sign"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"SingAmpl", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"SignPosit", "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"RepeatAmplitudes", "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "[", 
                 RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"SQPosit", "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", "SQPosit", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Use", " ", "the", " ", "delta", " ", "kronekers", " ", "form", 
            " ", "KronAmplRem", " ", "and", " ", "apply", " ", "it", " ", 
            "to", " ", "the", " ", "Amplitudes", " ", 
            RowBox[{"t1", "[", 
             RowBox[{"i", ",", "a"}], "]"}]}], ",", 
           RowBox[{"t2", "[", 
            RowBox[{"i", ",", "j", ",", "a", ",", "b"}], "]"}]}], " ", "*)"}],
          "\[IndentingNewLine]", 
         RowBox[{"AmplitudesReplaced", "=", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"AmplPosit", "[", 
                   RowBox[{"[", "l1", "]"}], "]"}], "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "/.", 
                 RowBox[{"Table", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"KronAmplRem", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}], ",", "2"}], "]"}],
                     "===", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Reverse", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"KronAmplRem", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}], ",", "2"}], 
                    "]"}]}], ")"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "->", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Reverse", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"KronAmplRem", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}], ",", "2"}], 
                    "]"}]}], ")"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"KronAmplRem", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}], ",", "2"}], "]"}],
                     "]"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"j1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{
                    RowBox[{"KronAmplRem", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"k1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"KronAmplRem", "[", 
                  RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"l1", ",", 
              RowBox[{"Length", "[", "KronAmplRem", "]"}]}], "}"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Extract", " ", "the", " ", "second", " ", "quantization", " ", 
            "indexes", " ", "from", " ", "the", " ", "Amplitudes", " ", "in", 
            " ", "order", " ", "o1"}], ",", "o2", ",", "o3", ",", "o4", ",", "...",
            ",", "v1", ",", "v2", ",", "v3", ",", "v4"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"CreAnhClust", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Flatten", " ", "[", "#", "]"}], "&"}], "/@", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"AmplPosit", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"AmplPosit", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}]}], 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"AmplPosit", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                 "]"}]}], ")"}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"k1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"KronAmplRem", "[", 
                  RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"l1", ",", 
              RowBox[{"Length", "[", "KronAmplRem", "]"}]}], "}"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "All", " ", "the", " ", "indexes", " ", "of", " ", "the", " ", 
           "Amplitudes", " ", "that", " ", "are", " ", "dummy"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"DummyCreAnh", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"AmplitudesReplaced", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "===", 
                   RowBox[{"{", "}"}]}], ",", 
                  RowBox[{"{", "}"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegralsPosit", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"AmplitudesReplaced", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}], 
                    ",", "#"}], "]"}], "&"}], "/@", " ", 
                   RowBox[{
                    RowBox[{"CreAnhClust", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}]}]}], "]"}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"i1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{
                    RowBox[{"AmplitudesReplaced", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"k1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"AmplitudesReplaced", "[", 
                  RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"l1", ",", 
              RowBox[{"Length", "[", "AmplitudesReplaced", "]"}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"DummyCreAnh1", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"CreAnhClust", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Range", "[", "#", "]"}], "&"}], "@", " ", 
                    RowBox[{"Length", "[", "#", "]"}]}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DummyCreAnh", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}]}], ")"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}], 
                  "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"CreAnhClust", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"j1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{
                    RowBox[{"DummyCreAnh", "[", 
                    RowBox[{"[", "l1", "]"}], "]"}], "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"k1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"DummyCreAnh", "[", 
                  RowBox[{"[", "l1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"l1", ",", 
              RowBox[{"Length", "[", "DummyCreAnh", "]"}]}], "}"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"IntegralsAmplitudesDummy", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"IntegralsPosit", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"AmplitudesReplaced", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "}"}], "/.", 
                 RowBox[{"AssociationThread", "[", 
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DummyCreAnh", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}], "->", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DummyCreAnh1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{
                    RowBox[{"DummyCreAnh1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"j1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"DummyCreAnh1", "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"k1", ",", 
              RowBox[{"Length", "[", "DummyCreAnh1", "]"}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AmplitudesDummie", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Insert", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"AmplitudesReplaced", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"Unevaluated", "[", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegralsPosit", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "}"}]}], "]"}], ",", 
                    "1"}], "]"}], "}"}], "/.", 
                 RowBox[{"AssociationThread", "[", 
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DummyCreAnh", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}], "->", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DummyCreAnh1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{
                    RowBox[{"DummyCreAnh1", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"j1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"DummyCreAnh1", "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"k1", ",", 
              RowBox[{"Length", "[", "DummyCreAnh1", "]"}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Find", " ", "the", " ", "possition", " ", "of", " ", "the", " ", 
           "dummy", " ", "integrals", " ", "and", " ", "Amplitudes", " ", 
           "to", " ", "remove", " ", "them"}], "*)"}], "\[IndentingNewLine]", 
         
         RowBox[{"PositDumIntAmp", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", 
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sort", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"AmplitudesDummie", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"AmplitudesDummie", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                   ",", "#"}], "]"}]}], "&"}], "/@", 
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sort", "[", "#", "]"}], "&"}], "/@", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"AmplitudesDummie", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"AmplitudesDummie", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                "]"}]}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"j1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"AmplitudesDummie", "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"k1", ",", 
              RowBox[{"Length", "[", "AmplitudesDummie", "]"}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Find", " ", "the", " ", "possition", " ", "of", " ", "the", " ", 
           "dummy", " ", "integrals", " ", "and", " ", "Amplitudes", " ", 
           "to", " ", "remove", " ", "them"}], "*)"}], "\[IndentingNewLine]", 
         
         RowBox[{"PositDumIntAmp", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", 
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sort", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"AmplitudesDummie", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"AmplitudesDummie", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                   ",", "#"}], "]"}]}], "&"}], "/@", 
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sort", "[", "#", "]"}], "&"}], "/@", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"AmplitudesDummie", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"AmplitudesDummie", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                "]"}]}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"j1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"AmplitudesDummie", "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"k1", ",", 
              RowBox[{"Length", "[", "AmplitudesDummie", "]"}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Remove", " ", "the", "  ", "terms", " ", "repeated", " ", "after", 
           " ", "anisymetricaly", " ", "permute", " ", "the", " ", 
           "integrals", " ", "and", " ", "the", " ", "Amplitudes"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"RepAntySimAmplitudes", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "#", "]"}], "&"}], "/@", 
               RowBox[{
                RowBox[{"PositDumIntAmp", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"IntegralsAmplitudesDummy", "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k1", ",", 
              RowBox[{"Length", "[", "IntegralsAmplitudesDummy", "]"}]}], 
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Obtain", " ", "the", " ", "the", " ", "sing", " ", "of", " ", 
           "the", " ", "smaller", " ", "expression"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"SignAfterPermut", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"SingAmpl", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"PositDumIntAmp", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "i1", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
               "]"}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"IntegralsAmplitudesDummy", "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k1", ",", 
              RowBox[{"Length", "[", "IntegralsAmplitudesDummy", "]"}]}], 
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Obtain", " ", "the", " ", "the", " ", "sing", " ", "of", " ", 
           "the", " ", "smaller", " ", "expression"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"FinalPrefactor", "=", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"PreFactors", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{"PositionString", ",", 
                  RowBox[{"{", "}"}]}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{"PositionString", ",", 
                  RowBox[{"{", "}"}]}], "]"}], "]"}]}], "}"}]}], "]"}], " ", 
           "RepAntySimAmplitudes", " ", "SignAfterPermut"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"IntegralsAmplitudes", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"IntegralsAmplitudesDummy", "[", 
                 RowBox[{"[", "k1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"PositDumIntAmp", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                   RowBox[{"[", "i1", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
               "]"}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"IntegralsAmplitudesDummy", "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k1", ",", 
              RowBox[{"Length", "[", "IntegralsAmplitudesDummy", "]"}]}], 
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "JusClusInd", ",", "LengClust", ",", "SepClusIndN", ",", 
           "SepClusInd", ",", "PosRepClos", ",", "eomccindx2"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "This", " ", "variable", " ", "reduce", " ", "the", " ", "number", 
            " ", "of", " ", 
            RowBox[{"t", "'"}], "s"}], ",", " ", 
           RowBox[{
            RowBox[{"v", "'"}], "s"}], ",", " ", 
           RowBox[{"and", " ", 
            RowBox[{"f", "'"}], "s", " ", "by", " ", "permuting", " ", "the", 
            " ", "number"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"IntegralsAmplitudes2", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Signature", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "&"}], "@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegralsAmplitudes", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "===", 
                 "0"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"JusClusInd", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"IntegralsAmplitudes", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"LengClust", "=", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"JusClusInd", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"SepClusIndN", "=", 
                  RowBox[{"GatherBy", "[", 
                   RowBox[{
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "[", "LengClust", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"LengClust", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"SepClusInd", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"JusClusInd", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", " ", 
                    "SepClusIndN"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", "JusClusInd", "]"}]}], "}"}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"PosRepClos", "=", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sort", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sort", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"SepClusInd", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"CreAnhClust", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "->", "Vd"}], ",", 
                    RowBox[{
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"CreAnhClust", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "->", "Od"}]}], "}"}]}],
                     ")"}]}], ",", "#"}], "]"}], " ", "&"}], "/@", " ", 
                   RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sort", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sort", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"SepClusInd", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", "/.", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"CreAnhClust", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "->", "Vd"}], ",", 
                    RowBox[{
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"CreAnhClust", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "->", "Od"}]}], "}"}]}],
                     ")"}]}], "]"}]}]}], " ", ";", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], "&"}], "/@", 
                    "PosRepClos"}], " ", ")"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FinalPrefactor", "[", 
                    RowBox[{"[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"PosRepClos", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
                    "]"}], ")"}]}], ")"}], ",", 
                   RowBox[{
                    RowBox[{"IntegralsAmplitudes", "[", 
                    RowBox[{"[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"PosRepClos", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
                    "]"}]}], "}"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"FinalPrefactor", "[", 
                   RowBox[{"[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "]"}], ",", 
                  RowBox[{"IntegralsAmplitudes", "[", 
                   RowBox[{"[", 
                    RowBox[{"k1", ",", "j1"}], "]"}], "]"}]}], "}"}]}], "]"}],
               "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"j1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"IntegralsAmplitudes", "[", 
                  RowBox[{"[", "k1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"k1", ",", 
              RowBox[{"Length", "[", "IntegralsAmplitudes", "]"}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"FinalPrefactor", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"IntegralsAmplitudes2", "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"IntegralsAmplitudes2", "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", "IntegralsAmplitudes2", "]"}]}], "}"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"IntegralsAmplitudes", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"IntegralsAmplitudes2", "[", 
                 RowBox[{"[", "j1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"IntegralsAmplitudes2", "[", 
                  RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j1", ",", 
              RowBox[{"Length", "[", "IntegralsAmplitudes2", "]"}]}], "}"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Put", " ", "F", " ", "or", " ", "ERI", " ", "dempending", " ", 
           "if", " ", "it", " ", "is", " ", "one", " ", "or", " ", "two", " ",
            "electron", " ", "integrals"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"SetForERI", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Total", "[", "#", "]"}], "&"}], "@", 
             RowBox[{"Flatten", "[", "#", "]"}]}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", "FinalPrefactor", ")"}], 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"Flatten", "[", "#", "]"}]}], "&"}], "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegralsAmplitudes", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "4"}], ",", 
                    "ERI", ",", "F"}], "]"}], "[", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "&"}], "/@", 
                  RowBox[{
                   RowBox[{"IntegralsAmplitudes", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                   RowBox[{"[", "i1", "]"}], "]"}]}], " ", 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"i1", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"IntegralsAmplitudes", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
               " ", ",", 
               RowBox[{"{", 
                RowBox[{"j1", ",", 
                 RowBox[{"Length", "[", "IntegralsAmplitudes", "]"}]}], 
                "}"}]}], "]"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Here", " ", "Apply", " ", 
           RowBox[{"the", " ", "[", 
            RowBox[{"[", " ", "]"}], "]"}], " ", "inside", " ", "the", " ", 
           "Arrays"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"SetForERI", "=", 
          RowBox[{"ChangeSqParforDSq", "[", "SetForERI", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Check", " ", "if", " ", "it", " ", "is", " ", "one", " ", 
           RowBox[{"(", "F", ")"}], " ", "or", " ", "two", " ", "electron", 
           " ", "integral", " ", 
           RowBox[{"(", "ERI", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"AllTrue", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"#", ",", "4"}], "]"}], "&"}], "@", 
                  RowBox[{"Flatten", "[", "#", "]"}]}], "&"}], "@", 
                RowBox[{"Position", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", "}"}]}], "]"}]}], "&"}], "/@", 
              "ManyBodyStrings1"}], ",", 
             RowBox[{
              RowBox[{"#", "===", "True"}], "&"}]}], "]"}], ",", 
           RowBox[{"Return", "[", "SetForERI", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"IntegralsAmplitudes", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "4"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Generate", " ", "The", " ", "manyBody", " ", "terms", " ", 
                "from", " ", "the", " ", "SQ", " ", "operators"}], " ", 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"SQManyBodyOp", "=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], "/@", 
                  RowBox[{
                   RowBox[{"ManyBodyStrings", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ")"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"IndManyBodyOp", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "0", "]"}], "]"}], "===", "SuperDagger"}], 
                    ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "&"}], 
                    "/@", " ", 
                    RowBox[{
                    RowBox[{"SQManyBodyOp", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"SQManyBodyOp", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"j1", ",", 
                    RowBox[{"Length", "[", "SQManyBodyOp", "]"}]}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"IndSepManyBodyOp", "=", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"IndManyBodyOp", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringTake", "[", " ", 
                    RowBox[{
                    RowBox[{"ToString", "[", "#", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "]"}], "===", 
                    "\"\<h\>\""}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"IndManyBodyOp", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], ",", "k1"}], "]"}], 
                    "]"}], "]"}], "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"IndManyBodyOp", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"j1", ",", 
                    RowBox[{"Length", "[", "IndManyBodyOp", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"k1", ",", 
                    RowBox[{"{", 
                    RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], "]"}], 
                 " ", "//", " ", "Transpose"}]}], ";", "\[IndentingNewLine]", 
               
               RowBox[{"ManyBodyTernsFinal", "=", 
                RowBox[{"Quiet", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["\[Chi]", 
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], "/", "2"}]], " ", " ", 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "]"}], 
                    "&"}], "/@", "IndSepManyBodyOp"}], ")"}]}], ")"}], "/.", 
                  " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["\[Chi]", "1"], "->", "\[Chi]1"}], ",", 
                    RowBox[{
                    SubscriptBox["\[Chi]", "2"], "->", "\[Chi]2"}], ",", 
                    RowBox[{
                    SubscriptBox["\[Chi]", "3"], "->", "\[Chi]3"}], ",", 
                    RowBox[{
                    SubscriptBox["\[Chi]", "4"], "->", "\[Chi]4"}], ",", 
                    RowBox[{
                    SubscriptBox["\[Chi]", "5"], "->", "\[Chi]5"}], ",", 
                    RowBox[{
                    SubscriptBox["\[Chi]", "6"], "->", "\[Chi]6"}], ",", 
                    RowBox[{
                    SubscriptBox["\[Chi]", "7"], "->", "\[Chi]7"}], ",", 
                    RowBox[{
                    SubscriptBox["\[Chi]", "8"], "->", "\[Chi]8"}]}], "}"}]}],
                  "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
              RowBox[{"Sequence", "[", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Position", " ", "of", " ", "SQManyBody"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"PosSQManyBody", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"SQManyBody", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"Delete", "[", 
                RowBox[{"SQManyBody", " ", ",", 
                 RowBox[{"Position", "[", 
                  RowBox[{"PositionString", ",", 
                   RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Return", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"IntegralsAmplitudes", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "4"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"ManyBodyTernsFinal", ",", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"SubsetQ", "[", 
                    RowBox[{"PosSQManyBody", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "SQManyBody", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "SQManyBody", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", "0"}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "SQManyBody", "]"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], ",", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"PosSQManyBody", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "->", 
                    RowBox[{"SetForERI", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", "PosSQManyBody", "]"}]}], "}"}]}], 
                    "]"}], " ", "]"}]}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ReplacePart", "[", 
                RowBox[{
                 RowBox[{"Table", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"SubsetQ", "[", 
                    RowBox[{"PosSQManyBody", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "SQManyBody", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "SQManyBody", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", "0"}], "]"}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "SQManyBody", "]"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"PosSQManyBody", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "->", 
                    RowBox[{"SetForERI", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", "PosSQManyBody", "]"}]}], "}"}]}], 
                   "]"}], " ", "]"}]}], "]"}]}], "]"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"NN", ",", 
          RowBox[{"Length", "[", "DeltaKronecker", "]"}]}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8860628702765837`*^9, 3.886062880703899*^9}, {
   3.8860629405269623`*^9, 3.88606294384328*^9}, {3.8860630071984663`*^9, 
   3.88606302284795*^9}, {3.886063053472775*^9, 3.8860630841672373`*^9}, {
   3.886063115839707*^9, 3.8860631377217913`*^9}, {3.886063175292593*^9, 
   3.8860632429678583`*^9}, {3.886063276877873*^9, 3.8860632796977167`*^9}, {
   3.886063340975194*^9, 3.88606336213799*^9}, {3.88606343303765*^9, 
   3.8860634420864153`*^9}, {3.886063504307991*^9, 3.886063554255464*^9}, {
   3.886063604470256*^9, 3.886063648885097*^9}, {3.886063894556819*^9, 
   3.886063895310685*^9}, {3.8860639997190733`*^9, 3.8860640247353363`*^9}, {
   3.886064069474101*^9, 3.886064092658533*^9}, {3.886064135991671*^9, 
   3.886064160003872*^9}, {3.886064273767416*^9, 3.8860642900539007`*^9}, {
   3.886064329907082*^9, 3.886064347360639*^9}, {3.886064408406473*^9, 
   3.886064520791869*^9}, {3.886064708258203*^9, 3.886064744159582*^9}, {
   3.886070827644452*^9, 3.886070870719316*^9}, {3.886071962818578*^9, 
   3.8860719696836987`*^9}, {3.886073849956029*^9, 3.886073866431122*^9}, {
   3.8860739619433537`*^9, 3.886073973708498*^9}, {3.886074917732397*^9, 
   3.8860749794841423`*^9}, {3.886078001468233*^9, 3.886078006599991*^9}, {
   3.886078090077388*^9, 3.886078151821027*^9}, {3.886078193791655*^9, 
   3.886078354752843*^9}, 3.8860786863263273`*^9, {3.886129466240177*^9, 
   3.886129469144033*^9}, {3.88613035157917*^9, 3.886130361944088*^9}, {
   3.886132490799782*^9, 3.886132491335733*^9}, {3.886489826154681*^9, 
   3.886489964709588*^9}, {3.886490020992407*^9, 3.886490051266398*^9}, {
   3.886490090356393*^9, 3.886490139687887*^9}, {3.886490309834961*^9, 
   3.886490357540464*^9}, 3.886490510365011*^9, {3.886490609054481*^9, 
   3.8864906138524513`*^9}, {3.886491254528427*^9, 3.886491287285247*^9}, {
   3.8864915111669073`*^9, 3.886491511218322*^9}, {3.886491650486681*^9, 
   3.886491651996566*^9}, 3.8864917981631536`*^9, {3.886492023750308*^9, 
   3.886492099068016*^9}, {3.886496638404159*^9, 3.886496642414446*^9}, {
   3.886496674046069*^9, 3.886496718262271*^9}, {3.8864967680631866`*^9, 
   3.886496776975647*^9}, {3.886582403779586*^9, 3.886582420610222*^9}, {
   3.88658724348046*^9, 3.886587249961626*^9}, {3.886587761656577*^9, 
   3.88658777106684*^9}, 3.8877975070239058`*^9, 3.8883929966211843`*^9, {
   3.8883930331173058`*^9, 3.888393128718055*^9}, 3.888394130018012*^9, {
   3.890875779195706*^9, 3.8908757899411592`*^9}, 3.8908861955910378`*^9, {
   3.8909949130695467`*^9, 3.890994940585044*^9}, 3.8909950278930063`*^9, 
   3.890995059105584*^9, {3.8909951056950283`*^9, 3.890995128145934*^9}, {
   3.891420021837028*^9, 3.891420085758833*^9}, {3.891420117550269*^9, 
   3.891420132065292*^9}, {3.8915018787374077`*^9, 3.891501891503333*^9}, {
   3.892182104890387*^9, 3.8921821111088*^9}, {3.8921821651946774`*^9, 
   3.892182166312632*^9}, {3.892182212027751*^9, 3.892182276955282*^9}, {
   3.892260984444161*^9, 3.892260990136381*^9}, {3.8926449475728807`*^9, 
   3.89264495073335*^9}, 3.892799585881109*^9, {3.8928000198026543`*^9, 
   3.8928000277985764`*^9}, {3.892800247491543*^9, 3.892800260415824*^9}, {
   3.8928004360764*^9, 3.892800444857684*^9}, {3.8931287598027983`*^9, 
   3.89312876160356*^9}, 3.893129391999078*^9, 3.893143579750568*^9, {
   3.893143789749485*^9, 3.893143790781311*^9}, {3.8931438449626417`*^9, 
   3.893143863545864*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"9f77d3e4-ac51-400e-83be-172117124189"]
}, Closed]],

Cell[CellGroupData[{

Cell["EOMCCgen", "Section",
 CellChangeTimes->{{3.8502124694131107`*^9, 3.850212483911498*^9}, {
   3.8508075976382303`*^9, 3.850807637386962*^9}, {3.85157491870508*^9, 
   3.8515749220559587`*^9}, {3.851575053203541*^9, 3.851575059139056*^9}, 
   3.851575661024029*^9, {3.85157970682765*^9, 3.851579715418345*^9}, {
   3.853485369144342*^9, 3.853485401318177*^9}, {3.8538499840059443`*^9, 
   3.853849987654407*^9}, {3.858858281395907*^9, 3.858858293975215*^9}, {
   3.858933373401108*^9, 3.8589333741657867`*^9}, 3.8593504401846657`*^9, 
   3.8593540895014963`*^9, 3.892265040971827*^9, 3.8992016189488087`*^9, 
   3.8992664447730417`*^9},ExpressionUUID->"351db9bb-909a-4a9c-96a1-\
272ff932ba99"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EOMCCgen", "[", 
     RowBox[{"ClusterOperator_", ",", "EOMOperator_", ",", 
      RowBox[{"EOMBlock", ":", 
       RowBox[{"{", 
        RowBox[{"_Integer", ",", "_Integer"}], "}"}], ":", "0"}], ",", 
      RowBox[{"ManyBodyOp", ":", 
       RowBox[{"Except", "[", 
        RowBox[{"{", "_String", "}"}], "]"}], ":", "0"}], ",", 
      RowBox[{"LeftRigthEOM", ":", 
       RowBox[{"{", "_String", "}"}], ":", "0"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Amplitudes", ",", "Strings", ",", "ManyBodyBlocks", ",", 
        "ManyBodyStrings", ",", "DeltaKronecker", ",", "ManyBodyTerms", ",", 
        "CCBoolean", ",", "time"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "ManyBodyOp", "]"}], "==", "1"}], "&&", 
          RowBox[{"StringQ", "[", "ManyBodyOp", "]"}]}], ",", 
         RowBox[{"LeftRigthEOM", "=", "ManyBodyOp"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "ManyBodyOp", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "LeftRigthEOM", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{
         RowBox[{"Timing", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", Cell["\<\
AmplStr module  generates the pre-factors, amplitudes, and second \
quantizatized strings\
\>", "Text",
            CellChangeTimes->{{3.887368635731531*^9, 3.887368728241324*^9}},
            ExpressionUUID->"b88bd470-4c28-43ee-a26e-0ff75531c13e"], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Amplitudes", ",", "Strings"}], "}"}], "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"LeftRigthEOM", "===", "0"}], ",", 
              RowBox[{"AmplStr", "[", 
               RowBox[{"ClusterOperator", ",", "EOMOperator"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AmplStr", "[", 
               RowBox[{
               "ClusterOperator", ",", "EOMOperator", ",", "LeftRigthEOM"}], 
               "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Determine", " ", "if", " ", "Coupled", " ", "Cluster", " ", 
             "EOMOoperator", " ", "is", " ", "0"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"CCBoolean", "=", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Strings", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], "===", 
             RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", Cell["\<\
ManyBodyHamiltonian module  generates the eomcc equations in terms of \
many-body terms and the set of non-redundant many body terms\
\>", "Text",
             CellChangeTimes->{{3.887368635731531*^9, 3.887368728241324*^9}},
             ExpressionUUID->"ad2fbfd3-47fd-43fc-bd49-b5a87e6b96a4"], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"CCBoolean", ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "If", " ", "EOMOoperator", " ", "is", " ", "0", " ", "do", " ", 
               "not", " ", "calculate", " ", "ManyBodyStrings"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ManyBodyOp", "=!=", "0"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"ManyBodyStrings", "=", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ManyBodyOp", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ManyBodyOp", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j1", ",", 
                    RowBox[{"Length", "[", "ManyBodyOp", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"k1", ",", 
                    RowBox[{"Length", "[", "Strings", "]"}]}], "}"}]}], 
                  "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"ManyBodyStrings", "=", "Strings"}], ";"}]}], "]"}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "If", " ", "EOMOoperator", " ", "is", " ", "diferent", " ", 
               "form", " ", "0", " ", "the", " ", "ManyBodyStrings", " ", 
               "are", " ", "calculated"}], "*)"}], "\[IndentingNewLine]", 
             "  ", ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ManyBodyOp", "=!=", "0"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"ManyBodyStrings", "=", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ManyBodyOp", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "k1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ManyBodyOp", "[", 
                    RowBox[{"[", "j1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j1", ",", 
                    RowBox[{"Length", "[", "ManyBodyOp", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"k1", ",", 
                    RowBox[{"Length", "[", "Strings", "]"}]}], "}"}]}], 
                  "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"ManyBodyBlocks", ",", "ManyBodyStrings"}], "}"}], 
                 "=", "\[IndentingNewLine]", 
                 RowBox[{"ManyBodyHamiltonian", "[", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "EOMBlock", "]"}], "==", "0"}], 
                    ",", "Strings", ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Just", " ", "a", " ", "single", " ", "block", " ", "is", 
                    "  ", "calculated"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Sequence", " ", "@@", "EOMBlock"}], "]"}], "]"}],
                     "}"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Sequence", " ", "@@", "EOMBlock"}], "]"}], "]"}],
                     "}"}], "}"}]}], "}"}]}], "]"}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"LeftRigthEOM", "===", "0"}], ",", "Null", ",", 
             RowBox[{"ManyBodyBlocks", "=", 
              RowBox[{"HrorlH", "[", 
               RowBox[{
               "LeftRigthEOM", ",", "Strings", ",", "ManyBodyBlocks"}], 
               "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", Cell["\<\
WicksContract module  generates the deltas Kronecker and the signs \
\>", "Text",
             CellChangeTimes->{{3.887368635731531*^9, 3.887368728241324*^9}},
             ExpressionUUID->"0aafc00f-e981-46f6-b0b0-f36d0ee44a72"], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"DeltaKronecker", "=", 
            RowBox[{"If", "[", 
             RowBox[{"CCBoolean", ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ManyBodyOp", "=!=", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"WicksContract", "[", "ManyBodyStrings", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"WicksContract", "[", "#", "]"}], "&"}], "/@", 
                 "ManyBodyStrings"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"WicksContract", "[", "ManyBodyStrings", "]"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", Cell["\<\
AntySymPermut Module  generates the pre-factors, amplitudes, and strings of \
second quantization\
\>", "Text",
             CellChangeTimes->{{3.887368635731531*^9, 3.887368728241324*^9}},
             ExpressionUUID->"60e83d0c-3632-4fe9-91b2-ee30622906ce"], "*)"}], 
           " ", "\[IndentingNewLine]", 
           RowBox[{"ManyBodyTerms", "=", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"CCBoolean", ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ManyBodyOp", "=!=", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"AntSymPermut", "[", 
                 RowBox[{
                 "DeltaKronecker", ",", "ManyBodyStrings", ",", 
                  "Amplitudes"}], "]"}], "\[IndentingNewLine]", ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"AntSymPermut", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeltaKronecker", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"DeltaKronecker", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyStrings", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"ManyBodyStrings", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "i1", "]"}], "]"}]}], "}"}], ",", 
                    "Amplitudes"}], "]"}], "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"i1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Strings", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"AntSymPermut", "[", 
               RowBox[{
               "DeltaKronecker", ",", "ManyBodyStrings", ",", "Amplitudes"}], 
               "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "]"}], " ", "/.",
          " ", 
         RowBox[{"Null", " ", "->", 
          RowBox[{"Sequence", "[", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", Cell["Printing options", "Text",
         CellChangeTimes->{{3.887368635731531*^9, 3.887368728241324*^9}},
         ExpressionUUID->"54a22c15-8fa6-4977-93de-2497e02de48e"], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Output\>\"", ",", "Bold", ",", "24"}], "]"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Execution Time\>\"", ",", "Bold", ",", "Blue"}], "]"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "time", "]"}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"If", "[", 
         RowBox[{"CCBoolean", ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ManyBodyOp", "=!=", "0"}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Many-body terms\>\"", ",", "Bold", ",", "Blue"}], 
             "]"}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<CC equations\>\"", ",", "Bold", ",", "Blue"}], 
             "]"}]}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Many-body terms\>\"", ",", "Bold", ",", "Blue"}], 
           "]"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"CCBoolean", ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ManyBodyOp", "=!=", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", " ", "Many"}], "-", 
             RowBox[{"body", " ", "Terms"}]}], "*)"}], "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"TableForm", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"ManyBodyTerms", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "==", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyTerms", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyTerms", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/.", " ", 
                    RowBox[{"0", " ", "->", " ", 
                    RowBox[{"Sequence", "[", "]"}]}]}], ")"}], "[", 
                  RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i1", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyTerms", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
              "]"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Print", " ", "CC"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<CC Energy\>\"", ",", "Blue"}], "]"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"Total", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"ManyBodyTerms", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "]"}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<CC Amplitude equations\>\"", ",", "Blue"}], "]"}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Total", "[", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{
                   RowBox[{"ManyBodyTerms", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i1", ",", "2", ",", 
                 RowBox[{"Length", "[", "ManyBodyTerms", "]"}]}], "}"}]}], 
              "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Print", " ", "EOMCC"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"TableForm", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"ManyBodyTerms", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "==", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyTerms", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ManyBodyTerms", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/.", " ", 
                  RowBox[{"0", " ", "->", " ", 
                   RowBox[{"Sequence", "[", "]"}]}]}], ")"}], "[", 
                RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ManyBodyTerms", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"CCBoolean", "===", "False"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<EOM-CC equations\>\"", ",", "Bold", ",", "Blue"}], 
           "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"CCBoolean", "===", "False"}], ",", 
         RowBox[{"Print", "[", "ManyBodyBlocks", "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.853480378711502*^9, {3.8534805665284567`*^9, 3.853480583482067*^9}, {
   3.85348148126723*^9, 3.853481526110957*^9}, {3.853482074962281*^9, 
   3.8534820815113497`*^9}, 3.853482127020323*^9, {3.85348217250499*^9, 
   3.853482184035735*^9}, {3.8534830556422863`*^9, 3.853483212330266*^9}, {
   3.853484619166396*^9, 3.8534846436173773`*^9}, {3.853484893226053*^9, 
   3.8534850364422073`*^9}, 3.853485092983137*^9, {3.853485207934641*^9, 
   3.853485262314402*^9}, {3.8534904164403887`*^9, 3.853490443855022*^9}, {
   3.853493843023603*^9, 3.8534938467051086`*^9}, {3.853494665757327*^9, 
   3.853494667489562*^9}, {3.8535577198001833`*^9, 3.853557723610811*^9}, {
   3.853589103268445*^9, 3.853589106310793*^9}, {3.8535895927938547`*^9, 
   3.853589597461602*^9}, {3.853589775665537*^9, 3.853589777690363*^9}, {
   3.853589948091682*^9, 3.853589970314218*^9}, {3.853822469833658*^9, 
   3.853822469941988*^9}, {3.85392731452606*^9, 3.853927315095944*^9}, {
   3.853927988060256*^9, 3.853927988858214*^9}, {3.853997254425767*^9, 
   3.85399734594383*^9}, {3.8540777037321177`*^9, 3.854077725079319*^9}, {
   3.854093985595593*^9, 3.854094015052782*^9}, {3.858858079344387*^9, 
   3.858858101543788*^9}, {3.85891509633799*^9, 3.858915099084292*^9}, 
   3.858918147404271*^9, {3.8589294455143557`*^9, 3.858929447060217*^9}, {
   3.858933411684271*^9, 3.858933553100418*^9}, {3.8593507494486847`*^9, 
   3.859350759239324*^9}, {3.859354092922209*^9, 3.859354100170932*^9}, {
   3.860658391267634*^9, 3.8606583923097153`*^9}, {3.86065858551674*^9, 
   3.860658609525893*^9}, {3.860658691305871*^9, 3.8606587113936033`*^9}, {
   3.860658757123204*^9, 3.8606587650941963`*^9}, {3.860659459782556*^9, 
   3.8606594830408173`*^9}, {3.86065978950071*^9, 3.860659792317163*^9}, {
   3.860659854695496*^9, 3.860659923049326*^9}, 3.860660008297353*^9, {
   3.860660120885869*^9, 3.860660121207405*^9}, {3.860660362607555*^9, 
   3.860660393953298*^9}, {3.8606604839103937`*^9, 3.8606605985468082`*^9}, {
   3.8606608659014597`*^9, 3.860660913850699*^9}, {3.860660990536624*^9, 
   3.860661023051462*^9}, {3.860661889547598*^9, 3.860661914007555*^9}, {
   3.860662026322112*^9, 3.8606620278127813`*^9}, {3.8763926691914177`*^9, 
   3.876392789138793*^9}, 3.876451517891654*^9, {3.8764516132618113`*^9, 
   3.876451620898875*^9}, {3.876451672363502*^9, 3.8764516947124863`*^9}, {
   3.8764517531760073`*^9, 3.876451860279558*^9}, {3.87645191522838*^9, 
   3.876451925532276*^9}, {3.876452031293944*^9, 3.8764520956987343`*^9}, {
   3.8764528524701757`*^9, 3.876452920326171*^9}, {3.876453007975161*^9, 
   3.876453010251786*^9}, {3.876453045944579*^9, 3.876453046312729*^9}, {
   3.8764531406353416`*^9, 3.876453143276493*^9}, 3.8764681727348757`*^9, {
   3.8764682098524857`*^9, 3.876468252166006*^9}, 3.876470409566757*^9, 
   3.876471430268311*^9, {3.8764774142085733`*^9, 3.876477430237659*^9}, {
   3.876477506460228*^9, 3.876477559030897*^9}, 3.876541284913409*^9, 
   3.876541378512224*^9, 3.876541825718071*^9, {3.8765422588239727`*^9, 
   3.876542291975607*^9}, {3.876542332671247*^9, 3.87654235985083*^9}, {
   3.876542432579852*^9, 3.876542505971046*^9}, {3.876542543279347*^9, 
   3.876542562913742*^9}, {3.8765426425524797`*^9, 3.876542658626173*^9}, {
   3.876542719774538*^9, 3.8765427204055243`*^9}, 3.876542759863143*^9, 
   3.876542790822418*^9, {3.8765429510515947`*^9, 3.876542952813653*^9}, {
   3.8775204418477917`*^9, 3.877520442407831*^9}, {3.885388163629043*^9, 
   3.885388166368857*^9}, {3.88736908098905*^9, 3.887369359637871*^9}, {
   3.8873693966747*^9, 3.8873694067730103`*^9}, {3.887428484746799*^9, 
   3.887428492464999*^9}, {3.8874285270525312`*^9, 3.8874285360147657`*^9}, {
   3.88742880953618*^9, 3.887428918319582*^9}, {3.8874289708541117`*^9, 
   3.887428983479742*^9}, {3.887429058188202*^9, 3.8874291083267*^9}, {
   3.887429160789589*^9, 3.8874291919086637`*^9}, {3.887430195392013*^9, 
   3.887430237095497*^9}, {3.887430288158751*^9, 3.88743029078371*^9}, {
   3.887445501265873*^9, 3.887445603093956*^9}, {3.8874532982152452`*^9, 
   3.887453304438463*^9}, {3.8874547287732153`*^9, 3.887454734877046*^9}, {
   3.887454863989217*^9, 3.8874550069493523`*^9}, {3.887785700829331*^9, 
   3.887785751310053*^9}, {3.887788105868289*^9, 3.887788118915358*^9}, {
   3.887797484907496*^9, 3.887797519820375*^9}, 3.890149766821556*^9, 
   3.890189357338543*^9, 3.8908763322500067`*^9, 3.891059496364546*^9, 
   3.891071152255864*^9, {3.8921016897563562`*^9, 3.892101701753325*^9}, {
   3.892182290196273*^9, 3.8921823014454327`*^9}, {3.892260991560626*^9, 
   3.892260998131839*^9}, {3.8922624805584497`*^9, 3.892262481485015*^9}, {
   3.892262770938198*^9, 3.892262775947632*^9}, 3.892618776096098*^9, {
   3.8926199583788157`*^9, 3.892619961995331*^9}, {3.8926202933154087`*^9, 
   3.892620300318314*^9}, {3.8926448799594927`*^9, 3.8926448838572197`*^9}, {
   3.892701488078814*^9, 3.892701488097705*^9}, {3.892701747802973*^9, 
   3.89270174860867*^9}, {3.892706698684334*^9, 3.89270674347577*^9}, {
   3.892706781799358*^9, 3.892706782641395*^9}, 3.8931265626960077`*^9, 
   3.893128957750299*^9, 3.8931293970483513`*^9, {3.893129902574432*^9, 
   3.8931299046768303`*^9}, {3.893143429950818*^9, 3.893143433025753*^9}, {
   3.893144672065371*^9, 3.8931447128301353`*^9}, {3.893145723236059*^9, 
   3.893145737664716*^9}, {3.893145850883176*^9, 3.893145851155736*^9}, {
   3.8931480561271667`*^9, 3.893148110980277*^9}, {3.893148161409761*^9, 
   3.893148162292336*^9}, {3.893149124909753*^9, 3.8931491817058477`*^9}, {
   3.894600564109481*^9, 3.894600598045607*^9}, {3.89460062827881*^9, 
   3.89460063446181*^9}, {3.8961765602113543`*^9, 3.896176562524456*^9}, {
   3.899201624236744*^9, 3.8992017288482*^9}, {3.899202012282732*^9, 
   3.8992020300450506`*^9}, 3.899202171571108*^9, {3.8992022125902324`*^9, 
   3.899202236930019*^9}, {3.899202346365059*^9, 3.8992023637014446`*^9}, {
   3.8992024616852245`*^9, 3.8992024897359695`*^9}, {3.8992025790154467`*^9, 
   3.8992025907716036`*^9}, {3.899208346917534*^9, 3.8992083849497538`*^9}, {
   3.899208436127016*^9, 3.8992084661041145`*^9}, {3.8992085049981556`*^9, 
   3.899208505373066*^9}, {3.8992091868235946`*^9, 3.899209192277727*^9}, {
   3.8992094509164753`*^9, 3.8992094767170315`*^9}, {3.8992095156134806`*^9, 
   3.899209555167358*^9}, {3.899210873049103*^9, 3.899210904662614*^9}, {
   3.899211244982892*^9, 3.8992112479844995`*^9}, {3.8992114365404854`*^9, 
   3.8992114638381634`*^9}, {3.8992562066299105`*^9, 
   3.8992562300169306`*^9}, {3.8992565877591248`*^9, 
   3.8992565950748005`*^9}, {3.8992572506460094`*^9, 
   3.8992572689918556`*^9}, {3.8992577070405293`*^9, 3.899257731995719*^9}, {
   3.8992602304002867`*^9, 3.89926023533241*^9}, {3.8992658089432917`*^9, 
   3.899265809571497*^9}, {3.8992664100101795`*^9, 3.8992664254927874`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"9e1d04a3-6cb2-4f75-8861-15f7054ac7bb"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples ", "Title",
 CellChangeTimes->{{3.858323676094317*^9, 3.858323685587489*^9}, {
   3.860053063669647*^9, 3.860053080799135*^9}, {3.8600531394052887`*^9, 
   3.860053141660288*^9}, {3.860660534554838*^9, 3.860660543565796*^9}, 
   3.8764521200458317`*^9, {3.886065021841052*^9, 3.88606505824818*^9}, {
   3.886584594929537*^9, 
   3.886584601682254*^9}},ExpressionUUID->"7833764b-06d7-45d1-9ddc-\
c3dcd8835ec3"],

Cell[CellGroupData[{

Cell["CCD", "Section",
 CellChangeTimes->{{3.8502124694131107`*^9, 3.850212483911498*^9}, {
   3.8508075976382303`*^9, 3.850807637386962*^9}, {3.85157491870508*^9, 
   3.8515749220559587`*^9}, {3.851575053203541*^9, 3.851575059139056*^9}, 
   3.851575661024029*^9, {3.85157970682765*^9, 3.851579715418345*^9}, {
   3.853485369144342*^9, 3.853485401318177*^9}, {3.8538499840059443`*^9, 
   3.853849987654407*^9}, {3.858858281395907*^9, 3.858858293975215*^9}, {
   3.858933373401108*^9, 3.8589333741657867`*^9}, 3.8593504401846657`*^9, 
   3.8593540895014963`*^9, {3.886584561380568*^9, 3.886584566436481*^9}, {
   3.886584617233329*^9, 3.88658461757227*^9}, {3.887363986138163*^9, 
   3.887363986818652*^9}, 3.887431469151123*^9, 
   3.891331174687104*^9},ExpressionUUID->"05022f5c-a52a-42b4-a6eb-\
7344c2d1674d"],

Cell[TextData[{
 StyleBox["In this example  two inputs are defined to obtain the CCD \
equations: \n1. The clusteroperator is given by {{\[OpenCurlyDoubleQuote]1h1p\
\[CloseCurlyDoubleQuote]},{\[OpenCurlyDoubleQuote]2h2p\[CloseCurlyDoubleQuote]\
}} that corresponds to ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["T", "^"], "=", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["T", "^"], "1"], "+", 
     SubscriptBox[
      OverscriptBox["T", "^"], "2"], " "}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "58a0fdca-aadc-4ba6-b42b-c4f3a74edfec"],
 StyleBox[", where  ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["T", "^"], "1"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "80a6a749-030a-414f-b28f-e64d1e23eb65"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["t", "i", "a"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "ea5033ce-3ab4-4da3-9dd5-447036897c59"],
 StyleBox[" and ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["T", "^"], "2"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "9a0ec4be-a633-43cc-a108-5e5d52c296cd"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["t", "ij", "ab"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"], 
       SuperscriptBox[
        OverscriptBox["b", "^"], "\[Dagger]"], 
       OverscriptBox["j", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "64020931-bfa2-41b2-9d4d-4f770d580625"],
 StyleBox["\n2. The eomoperator is given by {{\[OpenCurlyDoubleQuote]0h0p\
\[CloseCurlyDoubleQuote]}} that corresponds to ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["R", "^"], "=", "0", " "}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "0fcceb85-956d-4218-a64d-c39e984c179c"]
}], "Text",
 CellChangeTimes->{{3.887427592761385*^9, 3.887427677732684*^9}, {
   3.887427720661674*^9, 3.887427926139139*^9}, {3.887427969959711*^9, 
   3.887427972564579*^9}, {3.887428062263586*^9, 3.8874283967467422`*^9}, {
   3.887429267706176*^9, 3.887429274047916*^9}, {3.887429381622739*^9, 
   3.8874293936405487`*^9}, {3.887429536879528*^9, 3.887429611150378*^9}, {
   3.887431544551499*^9, 3.887431566249061*^9}, 3.888395269383792*^9, {
   3.888395453344531*^9, 3.888395456490862*^9}, {3.892701586484234*^9, 
   3.892701588107197*^9}, {3.893146504540043*^9, 3.893146509950769*^9}, {
   3.89460051148387*^9, 3.89460051454066*^9}, {3.894601156516365*^9, 
   3.894601201714703*^9}, {3.894601433621777*^9, 3.894601460693924*^9}, {
   3.8946020085723257`*^9, 3.8946020101821938`*^9}},
 Background->RGBColor[
  0.9, 1, 1],ExpressionUUID->"53f85e67-6539-4c18-a0de-ef183208db53"],

Cell["Input", "Text",
 CellChangeTimes->{{3.8874300269168243`*^9, 3.887430028958555*^9}, {
  3.887430062945299*^9, 3.887430063920225*^9}},
 FontSize->24,
 FontWeight->"Bold",ExpressionUUID->"1c77776e-de80-4cb4-b29d-6bbff4c60edb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClusterOperator", "=", 
   RowBox[{"{", 
    RowBox[{"{", "\"\<2h2p\>\"", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EOMOperator", "=", 
   RowBox[{"{", 
    RowBox[{"{", "\"\<0h0p\>\"", "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{"EOMCCgen", "[", 
  RowBox[{"ClusterOperator", ",", "EOMOperator"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8873568308852587`*^9, 3.887356833993724*^9}, {
   3.887430435429474*^9, 3.887430436531063*^9}, 3.8874315760157413`*^9, {
   3.8878604761501703`*^9, 3.8878604796282187`*^9}, {3.887860516242022*^9, 
   3.887860526463636*^9}, {3.888394983997239*^9, 3.888394999931835*^9}, {
   3.8883952168149767`*^9, 3.888395218958593*^9}, {3.890150204891739*^9, 
   3.89015024537051*^9}, {3.8908861205398197`*^9, 3.890886126171925*^9}, 
   3.891331180924046*^9, 3.8926194847835903`*^9, {3.893145872536087*^9, 
   3.893145903175889*^9}, 3.8992574946304903`*^9, 3.8992575420780115`*^9, 
   3.899257583745678*^9, {3.8992577756895375`*^9, 3.8992577926504326`*^9}, 
   3.8992664376036625`*^9},
 CellLabel->"In[93]:=",ExpressionUUID->"91acfede-76ae-4a7a-92d3-619d888343e0"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"Output\"\>",
  StripOnInput->False,
  FontSize->24,
  FontWeight->Bold]], "Print",
 CellChangeTimes->{
  3.894600491387158*^9, 3.8992115718164616`*^9, {3.8992574953607845`*^9, 
   3.899257507347927*^9}, 3.899257542724349*^9, {3.8992575733723507`*^9, 
   3.8992575846742535`*^9}, 3.8992577427625666`*^9, {3.899257776444851*^9, 
   3.899257793153757*^9}, 3.8992601489910784`*^9, 3.8992663211632223`*^9, {
   3.8992664383722258`*^9, 3.8992664536089163`*^9}, 3.8992665472897234`*^9},
 CellLabel->
  "During evaluation of \
In[93]:=",ExpressionUUID->"09e0d105-b512-4eed-a453-24fc510f4a11"],

Cell[BoxData[
 StyleBox["\<\"Execution Time\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{
  3.894600491387158*^9, 3.8992115718164616`*^9, {3.8992574953607845`*^9, 
   3.899257507347927*^9}, 3.899257542724349*^9, {3.8992575733723507`*^9, 
   3.8992575846742535`*^9}, 3.8992577427625666`*^9, {3.899257776444851*^9, 
   3.899257793153757*^9}, 3.8992601489910784`*^9, 3.8992663211632223`*^9, {
   3.8992664383722258`*^9, 3.8992664536089163`*^9}, 3.899266547303771*^9},
 CellLabel->
  "During evaluation of \
In[93]:=",ExpressionUUID->"4c399562-a8b0-4902-93cd-3cef8ef4f365"],

Cell[BoxData[
 RowBox[{"{", "3.984375`", "}"}]], "Print",
 CellChangeTimes->{
  3.894600491387158*^9, 3.8992115718164616`*^9, {3.8992574953607845`*^9, 
   3.899257507347927*^9}, 3.899257542724349*^9, {3.8992575733723507`*^9, 
   3.8992575846742535`*^9}, 3.8992577427625666`*^9, {3.899257776444851*^9, 
   3.899257793153757*^9}, 3.8992601489910784`*^9, 3.8992663211632223`*^9, {
   3.8992664383722258`*^9, 3.8992664536089163`*^9}, 3.899266547304965*^9},
 CellLabel->
  "During evaluation of \
In[93]:=",ExpressionUUID->"75b1f050-88d6-4a87-8cdc-2474a3a35396"],

Cell[BoxData[
 StyleBox["\<\"CC equations\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{
  3.894600491387158*^9, 3.8992115718164616`*^9, {3.8992574953607845`*^9, 
   3.899257507347927*^9}, 3.899257542724349*^9, {3.8992575733723507`*^9, 
   3.8992575846742535`*^9}, 3.8992577427625666`*^9, {3.899257776444851*^9, 
   3.899257793153757*^9}, 3.8992601489910784`*^9, 3.8992663211632223`*^9, {
   3.8992664383722258`*^9, 3.8992664536089163`*^9}, 3.8992665473195367`*^9},
 CellLabel->
  "During evaluation of \
In[93]:=",ExpressionUUID->"6fd47919-d3f0-4aaf-be74-e802c1711a73"],

Cell[BoxData[
 StyleBox["\<\"CC Energy\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{
  3.894600491387158*^9, 3.8992115718164616`*^9, {3.8992574953607845`*^9, 
   3.899257507347927*^9}, 3.899257542724349*^9, {3.8992575733723507`*^9, 
   3.8992575846742535`*^9}, 3.8992577427625666`*^9, {3.899257776444851*^9, 
   3.899257793153757*^9}, 3.8992601489910784`*^9, 3.8992663211632223`*^9, {
   3.8992664383722258`*^9, 3.8992664536089163`*^9}, 3.8992665473195367`*^9},
 CellLabel->
  "During evaluation of \
In[93]:=",ExpressionUUID->"fd5a1cf5-dff1-4ca9-bb2d-56c74daf5082"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"ERI", "\[LeftDoubleBracket]", 
   RowBox[{"o1", ",", "o2", ",", "v1", ",", "v2"}], "\[RightDoubleBracket]"}],
   " ", 
  RowBox[{"t2", "\[LeftDoubleBracket]", 
   RowBox[{"o1", ",", "o2", ",", "v1", ",", "v2"}], 
   "\[RightDoubleBracket]"}]}]], "Print",
 CellChangeTimes->{
  3.894600491387158*^9, 3.8992115718164616`*^9, {3.8992574953607845`*^9, 
   3.899257507347927*^9}, 3.899257542724349*^9, {3.8992575733723507`*^9, 
   3.8992575846742535`*^9}, 3.8992577427625666`*^9, {3.899257776444851*^9, 
   3.899257793153757*^9}, 3.8992601489910784`*^9, 3.8992663211632223`*^9, {
   3.8992664383722258`*^9, 3.8992664536089163`*^9}, 3.8992665473352165`*^9},
 CellLabel->
  "During evaluation of \
In[93]:=",ExpressionUUID->"0f5db609-34a5-4737-8744-3bdce44402c3"],

Cell[BoxData[
 StyleBox["\<\"CC Amplitude equations\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{
  3.894600491387158*^9, 3.8992115718164616`*^9, {3.8992574953607845`*^9, 
   3.899257507347927*^9}, 3.899257542724349*^9, {3.8992575733723507`*^9, 
   3.8992575846742535`*^9}, 3.8992577427625666`*^9, {3.899257776444851*^9, 
   3.899257793153757*^9}, 3.8992601489910784`*^9, 3.8992663211632223`*^9, {
   3.8992664383722258`*^9, 3.8992664536089163`*^9}, 3.899266547341288*^9},
 CellLabel->
  "During evaluation of \
In[93]:=",ExpressionUUID->"242bcb64-a1c8-4759-8f07-138f67baa8be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"ERI", "\[LeftDoubleBracket]", 
      RowBox[{"p2", ",", "p1", ",", "h1", ",", "h2"}], 
      "\[RightDoubleBracket]"}]}], "-", 
    RowBox[{
     RowBox[{"F", "\[LeftDoubleBracket]", 
      RowBox[{"p2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"h1", ",", "h2", ",", "v1", ",", "p1"}], 
      "\[RightDoubleBracket]"}]}], "+", 
    RowBox[{
     RowBox[{"F", "\[LeftDoubleBracket]", 
      RowBox[{"p1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"h1", ",", "h2", ",", "v1", ",", "p2"}], 
      "\[RightDoubleBracket]"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"ERI", "\[LeftDoubleBracket]", 
      RowBox[{"p2", ",", "p1", ",", "v1", ",", "v2"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"h1", ",", "h2", ",", "v1", ",", "v2"}], 
      "\[RightDoubleBracket]"}]}], "-", 
    RowBox[{
     RowBox[{"F", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "h2"}], "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "h1", ",", "p2", ",", "p1"}], 
      "\[RightDoubleBracket]"}]}], "+", 
    RowBox[{
     RowBox[{"ERI", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "p2", ",", "v1", ",", "h2"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "h1", ",", "v1", ",", "p1"}], 
      "\[RightDoubleBracket]"}]}], "-", 
    RowBox[{
     RowBox[{"ERI", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "p1", ",", "v1", ",", "h2"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "h1", ",", "v1", ",", "p2"}], 
      "\[RightDoubleBracket]"}]}], "+", 
    RowBox[{
     RowBox[{"F", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "h1"}], "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "h2", ",", "p2", ",", "p1"}], 
      "\[RightDoubleBracket]"}]}], "-", 
    RowBox[{
     RowBox[{"ERI", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "p2", ",", "v1", ",", "h1"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "h2", ",", "v1", ",", "p1"}], 
      "\[RightDoubleBracket]"}]}], "+", 
    RowBox[{
     RowBox[{"ERI", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "p1", ",", "v1", ",", "h1"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "h2", ",", "v1", ",", "p2"}], 
      "\[RightDoubleBracket]"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"ERI", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "o2", ",", "h1", ",", "h2"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "o2", ",", "p2", ",", "p1"}], 
      "\[RightDoubleBracket]"}]}], "-", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"ERI", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "o2", ",", "v1", ",", "v2"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"h1", ",", "h2", ",", "v1", ",", "v2"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "o2", ",", "p2", ",", "p1"}], 
      "\[RightDoubleBracket]"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"ERI", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "o2", ",", "v1", ",", "v2"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"h1", ",", "h2", ",", "v2", ",", "p2"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "o2", ",", "v1", ",", "p1"}], 
      "\[RightDoubleBracket]"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"ERI", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "o2", ",", "v1", ",", "v2"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"h1", ",", "h2", ",", "v2", ",", "p1"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "o2", ",", "v1", ",", "p2"}], 
      "\[RightDoubleBracket]"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"ERI", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "o2", ",", "v1", ",", "v2"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "h2", ",", "v1", ",", "v2"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"o2", ",", "h1", ",", "p2", ",", "p1"}], 
      "\[RightDoubleBracket]"}]}], "+", 
    RowBox[{
     RowBox[{"ERI", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "o2", ",", "v1", ",", "v2"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "h2", ",", "v1", ",", "p2"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"o2", ",", "h1", ",", "v2", ",", "p1"}], 
      "\[RightDoubleBracket]"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"ERI", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "o2", ",", "v1", ",", "v2"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "h1", ",", "v1", ",", "v2"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"o2", ",", "h2", ",", "p2", ",", "p1"}], 
      "\[RightDoubleBracket]"}]}], "-", 
    RowBox[{
     RowBox[{"ERI", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "o2", ",", "v1", ",", "v2"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"o1", ",", "h1", ",", "v1", ",", "p2"}], 
      "\[RightDoubleBracket]"}], " ", 
     RowBox[{"t2", "\[LeftDoubleBracket]", 
      RowBox[{"o2", ",", "h2", ",", "v2", ",", "p1"}], 
      "\[RightDoubleBracket]"}]}]}], "}"}], "}"}]], "Print",
 CellChangeTimes->{
  3.894600491387158*^9, 3.8992115718164616`*^9, {3.8992574953607845`*^9, 
   3.899257507347927*^9}, 3.899257542724349*^9, {3.8992575733723507`*^9, 
   3.8992575846742535`*^9}, 3.8992577427625666`*^9, {3.899257776444851*^9, 
   3.899257793153757*^9}, 3.8992601489910784`*^9, 3.8992663211632223`*^9, {
   3.8992664383722258`*^9, 3.8992664536089163`*^9}, 3.899266547366929*^9},
 CellLabel->
  "During evaluation of \
In[93]:=",ExpressionUUID->"0d0340a4-9f9f-4da6-a14b-e1a8fef06ad4"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["CCSD", "Section",
 CellChangeTimes->{{3.8502124694131107`*^9, 3.850212483911498*^9}, {
   3.8508075976382303`*^9, 3.850807637386962*^9}, {3.85157491870508*^9, 
   3.8515749220559587`*^9}, {3.851575053203541*^9, 3.851575059139056*^9}, 
   3.851575661024029*^9, {3.85157970682765*^9, 3.851579715418345*^9}, {
   3.853485369144342*^9, 3.853485401318177*^9}, {3.8538499840059443`*^9, 
   3.853849987654407*^9}, {3.858858281395907*^9, 3.858858293975215*^9}, {
   3.858933373401108*^9, 3.8589333741657867`*^9}, 3.8593504401846657`*^9, 
   3.8593540895014963`*^9, {3.886584561380568*^9, 3.886584566436481*^9}, {
   3.886584617233329*^9, 3.88658461757227*^9}, {3.887363986138163*^9, 
   3.887363986818652*^9}, 
   3.887431469151123*^9},ExpressionUUID->"180f5b0c-6cc6-4b38-8aab-\
7561c8d2485a"],

Cell[TextData[{
 StyleBox["In this example  two inputs are defined for CCSD: \n1. The \
clusteroperator is given by {{\[OpenCurlyDoubleQuote]1h1p\
\[CloseCurlyDoubleQuote]},{\[OpenCurlyDoubleQuote]2h2p\[CloseCurlyDoubleQuote]\
}} that corresponds to ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["T", "^"], "=", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["T", "^"], "1"], "+", 
     SubscriptBox[
      OverscriptBox["T", "^"], "2"], " "}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "54e37522-2d0c-48f1-a1ac-6d8f3b0a0489"],
 StyleBox[", where  ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["T", "^"], "1"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "0311146b-dfad-463c-9028-3c8bf6fc8787"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["t", "i", "a"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "77448da6-efed-4038-80cb-8e02b4a75cfb"],
 StyleBox[" and ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["T", "^"], "2"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "a8be4305-336b-43c4-99b2-ce32f9a7869e"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["t", "ij", "ab"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"], 
       SuperscriptBox[
        OverscriptBox["b", "^"], "\[Dagger]"], 
       OverscriptBox["j", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "6d9d8fbd-200f-44c5-8a8c-b1c8394435fc"],
 StyleBox["\n2. The eomoperator is given by {{\[OpenCurlyDoubleQuote]0h0p\
\[CloseCurlyDoubleQuote]}} that corresponds to ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["R", "^"], "=", "0", " "}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "1b72914c-3681-4f59-8708-d33d5fa8f4ee"]
}], "Text",
 CellChangeTimes->{{3.887427592761385*^9, 3.887427677732684*^9}, {
   3.887427720661674*^9, 3.887427926139139*^9}, {3.887427969959711*^9, 
   3.887427972564579*^9}, {3.887428062263586*^9, 3.8874283967467422`*^9}, {
   3.887429267706176*^9, 3.887429274047916*^9}, {3.887429381622739*^9, 
   3.8874293936405487`*^9}, {3.887429536879528*^9, 3.887429611150378*^9}, {
   3.887431544551499*^9, 3.887431566249061*^9}, 3.888395269383792*^9, {
   3.888395453344531*^9, 3.888395456490862*^9}, 3.8927015791470547`*^9, {
   3.89460121465372*^9, 3.8946012387506647`*^9}, {3.894601353292432*^9, 
   3.894601411719451*^9}, {3.8946019994601727`*^9, 3.894602000522735*^9}},
 Background->RGBColor[
  0.9, 1, 1],ExpressionUUID->"18a773b2-5d2f-4378-8b1b-ab0884b13e9a"],

Cell["Input", "Text",
 CellChangeTimes->{{3.8874300269168243`*^9, 3.887430028958555*^9}, {
  3.887430062945299*^9, 3.887430063920225*^9}},
 FontSize->24,
 FontWeight->"Bold",ExpressionUUID->"510eee9c-0c11-4493-a09c-9d55e746f315"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClusterOperator", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "\"\<1h1p\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<2h2p\>\"", "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EOMOperator", "=", 
   RowBox[{"{", 
    RowBox[{"{", "\"\<0h0p\>\"", "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{"EOMCCgen", "[", 
  RowBox[{"ClusterOperator", ",", "EOMOperator"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8873568308852587`*^9, 3.887356833993724*^9}, {
   3.887430435429474*^9, 3.887430436531063*^9}, 3.8874315760157413`*^9, {
   3.8878604761501703`*^9, 3.8878604796282187`*^9}, {3.887860516242022*^9, 
   3.887860526463636*^9}, {3.888394983997239*^9, 3.888394999931835*^9}, {
   3.8883952168149767`*^9, 3.888395218958593*^9}, {3.890150204891739*^9, 
   3.89015024537051*^9}, {3.8908861205398197`*^9, 3.890886126171925*^9}, 
   3.892619505846697*^9, 3.8926203107902803`*^9, 3.892620361945938*^9, {
   3.893146804252461*^9, 3.893146814520396*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"ef2686b3-12e1-4801-a55c-d8d1e110ce87"]
}, Closed]],

Cell[CellGroupData[{

Cell["CCSDT", "Section",
 CellChangeTimes->{{3.8502124694131107`*^9, 3.850212483911498*^9}, {
   3.8508075976382303`*^9, 3.850807637386962*^9}, {3.85157491870508*^9, 
   3.8515749220559587`*^9}, {3.851575053203541*^9, 3.851575059139056*^9}, 
   3.851575661024029*^9, {3.85157970682765*^9, 3.851579715418345*^9}, {
   3.853485369144342*^9, 3.853485401318177*^9}, {3.8538499840059443`*^9, 
   3.853849987654407*^9}, {3.858858281395907*^9, 3.858858293975215*^9}, {
   3.858933373401108*^9, 3.8589333741657867`*^9}, 3.8593504401846657`*^9, 
   3.8593540895014963`*^9, {3.886584561380568*^9, 3.886584566436481*^9}, {
   3.886584617233329*^9, 3.88658461757227*^9}, {3.887363986138163*^9, 
   3.887363986818652*^9}, 3.887431469151123*^9, 
   3.8883952893294077`*^9},ExpressionUUID->"bcca9391-f3da-40f2-8e38-\
11681bef3eb3"],

Cell[TextData[{
 StyleBox["In this example  two inputs are defined for equations CCSDT: \n1. \
The clusteroperator is given by {{\[OpenCurlyDoubleQuote]1h1p\
\[CloseCurlyDoubleQuote]},{\[OpenCurlyDoubleQuote]2h2p\[CloseCurlyDoubleQuote]\
},{\[OpenCurlyDoubleQuote]3h3p\[CloseCurlyDoubleQuote]}} that corresponds to ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["T", "^"], "=", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["T", "^"], "1"], "+", 
     SubscriptBox[
      OverscriptBox["T", "^"], "2"], " ", "+", 
     SubscriptBox[
      OverscriptBox["T", "^"], "3"]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "acbc9a20-4c75-4baf-ad9d-4308d977d4b9"],
 StyleBox[", where  ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["T", "^"], "1"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "1c5b701f-8192-414f-a1ba-20f31497f616"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["t", "i", "a"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "aa2cbfc4-cc37-42a8-9722-b66f97fb38bc"],
 StyleBox[" , ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["T", "^"], "2"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "33813558-ecc7-44f6-bc43-812c7ca644ac"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"ab", ",", "ij"}]], 
     RowBox[{
      SubsuperscriptBox["t", "ij", "ab"], 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"], 
        OverscriptBox["i", "^"], 
        SuperscriptBox[
         OverscriptBox["b", "^"], "\[Dagger]"], 
        OverscriptBox["j", "^"]}], "}"}], "  ", "and", 
      StyleBox[
       RowBox[{"   ", 
        StyleBox[" ",
         Background->RGBColor[0.9, 1, 1]]}]], 
      FormBox[
       SubscriptBox[
        OverscriptBox["T", "^"], "3"],
       TraditionalForm]}]}], 
    StyleBox["=",
     Background->RGBColor[0.9, 1, 1]], " ", 
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"abc", ",", "ijk"}]], 
     RowBox[{
      SubsuperscriptBox["t", "ijk", "abc"], 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"], 
        OverscriptBox["i", "^"], 
        SuperscriptBox[
         OverscriptBox["b", "^"], "\[Dagger]"], 
        OverscriptBox["j", "^"], 
        SuperscriptBox[
         OverscriptBox["c", "^"], "\[Dagger]"], 
        OverscriptBox["k", "^"]}], "}"}], "  ", " "}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "24807d11-2efa-484c-b7fa-4819391ca1bb"],
 StyleBox["\n2. The eomoperator is given by {{\[OpenCurlyDoubleQuote]0h0p\
\[CloseCurlyDoubleQuote]}} that corresponds to ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["R", "^"], "=", "0", " "}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "2298f920-2695-4118-b325-02bf8c4891e3"]
}], "Text",
 CellChangeTimes->{{3.887427592761385*^9, 3.887427677732684*^9}, {
   3.887427720661674*^9, 3.887427926139139*^9}, {3.887427969959711*^9, 
   3.887427972564579*^9}, {3.887428062263586*^9, 3.8874283967467422`*^9}, {
   3.887429267706176*^9, 3.887429274047916*^9}, {3.887429381622739*^9, 
   3.8874293936405487`*^9}, {3.887429536879528*^9, 3.887429611150378*^9}, {
   3.887431544551499*^9, 3.887431566249061*^9}, 3.888395269383792*^9, {
   3.888395378551498*^9, 3.888395391074271*^9}, {3.888395427150281*^9, 
   3.888395446931445*^9}, {3.892701597772222*^9, 3.892701601152279*^9}, {
   3.894600847704063*^9, 3.894600850301655*^9}, {3.894601491244986*^9, 
   3.894601517839631*^9}, {3.894601565452879*^9, 3.8946015780768967`*^9}, 
   3.894601620350133*^9, {3.894601982788566*^9, 3.894601992656344*^9}},
 Background->RGBColor[
  0.9, 1, 1],ExpressionUUID->"83e09209-0efb-4d02-ae4b-f51fe4f9a94e"],

Cell["Input", "Text",
 CellChangeTimes->{{3.8874300269168243`*^9, 3.887430028958555*^9}, {
  3.887430062945299*^9, 3.887430063920225*^9}},
 FontSize->24,
 FontWeight->"Bold",ExpressionUUID->"bb809c17-2639-4de4-8c2e-7c9a8e728969"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClusterOperator", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "\"\<1h1p\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<2h2p\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<3h3p\>\"", "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EOMOperator", "=", 
   RowBox[{"{", 
    RowBox[{"{", "\"\<0h0p\>\"", "}"}], "}"}]}], ";"}], "\n", 
 RowBox[{"EOMCCgen", "[", 
  RowBox[{"ClusterOperator", ",", "EOMOperator"}], "]"}]}], "Input",
 CellChangeTimes->{{3.890150280894596*^9, 3.8901502863198843`*^9}, 
   3.892620659964428*^9},
 CellLabel->
  "In[3325]:=",ExpressionUUID->"506e786c-58f3-4806-af8e-e85fbd536799"]
}, Closed]],

Cell[CellGroupData[{

Cell["EE-EOM-CCSD", "Section",
 CellChangeTimes->{{3.8502124694131107`*^9, 3.850212483911498*^9}, {
   3.8508075976382303`*^9, 3.850807637386962*^9}, {3.85157491870508*^9, 
   3.8515749220559587`*^9}, {3.851575053203541*^9, 3.851575059139056*^9}, 
   3.851575661024029*^9, {3.85157970682765*^9, 3.851579715418345*^9}, {
   3.853485369144342*^9, 3.853485401318177*^9}, {3.8538499840059443`*^9, 
   3.853849987654407*^9}, {3.858858281395907*^9, 3.858858293975215*^9}, {
   3.858933373401108*^9, 3.8589333741657867`*^9}, 3.8593504401846657`*^9, 
   3.8593540895014963`*^9, {3.886584561380568*^9, 3.886584566436481*^9}, {
   3.886584617233329*^9, 3.88658461757227*^9}, {3.887363986138163*^9, 
   3.887363986818652*^9}},ExpressionUUID->"d88c5ff0-3500-41a1-aa56-\
9372e73fa004"],

Cell[TextData[{
 StyleBox["In this example  two inputs are defined to obtain EE-EOM-CCSD \
equations: \n1. The ClusterOperator  is given by \
{{\[OpenCurlyDoubleQuote]1h1p\[CloseCurlyDoubleQuote]},{\
\[OpenCurlyDoubleQuote]2h2p\[CloseCurlyDoubleQuote]}} that corresponds to ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["T", "^"], "=", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["T", "^"], "1"], "+", 
     SubscriptBox[
      OverscriptBox["T", "^"], "2"], " "}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "ea5a28b9-73d3-4404-9d54-7e42c32c7cbe"],
 StyleBox[", where  ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["T", "^"], "1"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "98cba90c-dc32-4680-b38c-ba89c505a7b0"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["t", "i", "a"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "52caef39-a80f-4922-abe7-2f0608c00b5f"],
 StyleBox[" and ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["T", "^"], "2"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "de0d0e0a-b3e9-4662-b3f1-6f526da24e01"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["t", "ij", "ab"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"], 
       SuperscriptBox[
        OverscriptBox["b", "^"], "\[Dagger]"], 
       OverscriptBox["j", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "dacd8698-b943-483f-8e52-283ade7ae124"],
 StyleBox["\n2. The EOMOperator is given by {{\[OpenCurlyDoubleQuote]1h1p\
\[CloseCurlyDoubleQuote]},{\[OpenCurlyDoubleQuote]2h2p\[CloseCurlyDoubleQuote]\
}} , that corresponds to ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["R", "^"], "=", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["R", "^"], "1"], "+", 
     SubscriptBox[
      OverscriptBox["R", "^"], "2"], " "}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "6851c564-e105-4932-bc35-fcc2b520b48d"],
 StyleBox[", where  ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["R", "^"], "1"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "395f6893-829e-4f2a-a165-e90b19056f1a"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["r", "i", "a"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "fb55f0ba-b642-4a30-bc5c-8532679dfaca"],
 StyleBox[" and ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["R", "^"], "2"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "5e409c28-eb12-4d1c-984f-ed8b64d80888"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["r", "ij", "ab"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"], 
       SuperscriptBox[
        OverscriptBox["b", "^"], "\[Dagger]"], 
       OverscriptBox["j", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "b4d73cd0-ca0c-4806-b868-dd289ae3378b"]
}], "Text",
 CellChangeTimes->{{3.887427592761385*^9, 3.887427677732684*^9}, {
   3.887427720661674*^9, 3.887427926139139*^9}, {3.887427969959711*^9, 
   3.887427972564579*^9}, {3.887428062263586*^9, 3.8874283967467422`*^9}, {
   3.887429267706176*^9, 3.887429274047916*^9}, {3.887429381622739*^9, 
   3.8874293936405487`*^9}, {3.887429536879528*^9, 3.887429611150378*^9}, {
   3.887444171146409*^9, 3.887444174118609*^9}, {3.890876486199564*^9, 
   3.890876521782057*^9}, {3.890876575941691*^9, 3.890876608445751*^9}, {
   3.893143978421328*^9, 3.8931439844895697`*^9}, {3.894601119297649*^9, 
   3.894601128489725*^9}, 3.894602017712585*^9},
 Background->RGBColor[
  0.9, 1, 1],ExpressionUUID->"e2ecaeea-17a5-4677-872a-5e6992438576"],

Cell["Input", "Text",
 CellChangeTimes->{{3.8874300269168243`*^9, 3.887430028958555*^9}, {
  3.887430062945299*^9, 3.887430063920225*^9}},
 FontSize->24,
 FontWeight->"Bold",ExpressionUUID->"3ab88cab-c381-4bff-bdb0-362816892b7e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClusterOperator", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "\"\<1h1p\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<2h2p\>\"", "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EOMOperator", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "\"\<1h1p\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<2h2p\>\"", "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"EOMCCgen2", "[", 
  RowBox[{"ClusterOperator", ",", "EOMOperator"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8873568308852587`*^9, 3.887356833993724*^9}, {
   3.887430435429474*^9, 3.887430436531063*^9}, {3.8908764687465677`*^9, 
   3.89087647954723*^9}, 3.893146690822248*^9, 3.8992659023021755`*^9},
 CellLabel->"In[96]:=",ExpressionUUID->"7a8e687c-c07a-43ed-b4df-2d0e3ff95ad6"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"Output\"\>",
  StripOnInput->False,
  FontSize->24,
  FontWeight->Bold]], "Print",
 CellChangeTimes->{{3.899265896014469*^9, 3.8992659111658716`*^9}, 
   3.8992663470980883`*^9, 3.899267095668293*^9},
 CellLabel->
  "During evaluation of \
In[96]:=",ExpressionUUID->"f14bca08-a080-440e-b6b3-e8671b8e12f2"],

Cell[BoxData[
 StyleBox["\<\"Execution Time\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{{3.899265896014469*^9, 3.8992659111658716`*^9}, 
   3.8992663470980883`*^9, 3.899267095684648*^9},
 CellLabel->
  "During evaluation of \
In[96]:=",ExpressionUUID->"bd374033-5588-46ac-bf0a-8da3fb5a0ab3"],

Cell[BoxData[
 RowBox[{"{", "3.890625`", "}"}]], "Print",
 CellChangeTimes->{{3.899265896014469*^9, 3.8992659111658716`*^9}, 
   3.8992663470980883`*^9, 3.899267095699993*^9},
 CellLabel->
  "During evaluation of \
In[96]:=",ExpressionUUID->"6d4da930-ea91-46b4-9070-fe3ec4ecaec0"],

Cell[BoxData[
 StyleBox["\<\"Many-body terms\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{{3.899265896014469*^9, 3.8992659111658716`*^9}, 
   3.8992663470980883`*^9, 3.899267095699993*^9},
 CellLabel->
  "During evaluation of \
In[96]:=",ExpressionUUID->"47ef3353-6bcf-4c76-98a7-2f7c1eb0d183"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h1"}], "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "h1"}], "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "h1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"p1", ",", "p3"}], "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"F", "\[LeftDoubleBracket]", 
         RowBox[{"p1", ",", "p3"}], "\[RightDoubleBracket]"}], "-", 
        RowBox[{
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "p1", ",", "h1", ",", "p3"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "h1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "p1", ",", "h1", ",", "p3"}], 
         "\[RightDoubleBracket]"}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "p1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h1", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "p4"}], "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"F", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p4"}], "\[RightDoubleBracket]"}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "o1", ",", "v1", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "h3", ",", "h1", ",", "p4"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h3", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "v1", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "p1", ",", "p4", ",", "p3"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"t1", "\[LeftDoubleBracket]", 
           RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}]}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "o1", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p1", ",", "p4", ",", "p3"}], 
         "\[RightDoubleBracket]"}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "p2", ",", "h2", ",", "h1"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "h1", ",", "h2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "h1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "h2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "p2", ",", "h1", ",", "h2"}], 
         "\[RightDoubleBracket]"}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "p2", ",", "v1", ",", "h1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "p2", ",", "v1", ",", "h2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "p2", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h2", ",", "v1", ",", "p2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h2", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "p2", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h2", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h2", ",", "v2", ",", "p2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "h2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h1", ",", "v1", ",", "p2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h1", ",", "v2", ",", "p2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "h1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h2", ",", "v1", ",", "p2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h2", ",", "v2", ",", "p2"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"p2", ",", "p1", ",", "h2", ",", "p3"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "h2", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1", ",", "h2", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2", ",", "h2", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"p2", ",", "p1", ",", "h2", ",", "p3"}], 
         "\[RightDoubleBracket]"}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"p2", ",", "p1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h2", ",", "p2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h2", ",", "v1", ",", "p2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "h2", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "p2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "p2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "h2", ",", "p2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "h2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "h2", ",", "v1", ",", "p2"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "p2", ",", "p1", ",", "h2", ",", "h1", ",", "p3"}],
         "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"t1", "\[LeftDoubleBracket]", 
           RowBox[{"o1", ",", "p2"}], "\[RightDoubleBracket]"}]}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "p2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h2", ",", "v1", ",", "p2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "p1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h2", ",", "v1", ",", "p2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "h2", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h1", ",", "p2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h1", ",", "p2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "h1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h2", ",", "p2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h2", ",", "p2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "h3", ",", "h2", ",", "h1"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "h1", ",", "h2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "v1", ",", "h1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "v1", ",", "h2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h2", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"p2", ",", "p1", ",", "p4", ",", "p3"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"p2", ",", "p1", ",", "p4", ",", "p3"}], 
         "\[RightDoubleBracket]"}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "p2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "h3", ",", "p2", ",", "h2", ",", "h1", ",", "p4"}],
         "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h3", ",", "v1", ",", "p4"}], 
         "\[RightDoubleBracket]"}], " ", 
        RowBox[{"t2", "\[LeftDoubleBracket]", 
         RowBox[{"h1", ",", "h2", ",", "v1", ",", "p2"}], 
         "\[RightDoubleBracket]"}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "p2", ",", "p1", ",", "h2", ",", "p4", ",", "p3"}],
         "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "o1", ",", "p4", ",", "p3"}], 
         "\[RightDoubleBracket]"}], " ", 
        RowBox[{"t2", "\[LeftDoubleBracket]", 
         RowBox[{"o1", ",", "h2", ",", "p2", ",", "p1"}], 
         "\[RightDoubleBracket]"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.899265896014469*^9, 3.8992659111658716`*^9}, 
   3.8992663470980883`*^9, 3.8992670957922173`*^9},
 CellLabel->
  "During evaluation of \
In[96]:=",ExpressionUUID->"1b67d98f-a5a7-47b2-ae71-9aee1697fc0e"],

Cell[BoxData[
 StyleBox["\<\"EOM-CC equations\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{{3.899265896014469*^9, 3.8992659111658716`*^9}, 
   3.8992663470980883`*^9, 3.899267095855709*^9},
 CellLabel->
  "During evaluation of \
In[96]:=",ExpressionUUID->"95851ad1-1953-40aa-97d1-c49dc005b412"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "h1"}], "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"p1", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h3"}], "}"}]]}], ",", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "p1", ",", "h1", ",", "p3"}], 
        "\[RightDoubleBracket]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p4"}], "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "p4"}], "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "p3"}], "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h3", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "h1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p1", ",", "p4", ",", "p3"}], 
         "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "p1", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h4"}], "}"}]]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "p2", ",", "h2", ",", "h1"}], 
         "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "p1", ",", "h2", ",", "h1"}], 
          "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"p2", ",", "p1", ",", "h2", ",", "p3"}], 
         "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
          RowBox[{"p2", ",", "p1", ",", "h1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h3"}], "}"}]]}], ",", 
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "p2", ",", "p1", ",", "h2", ",", "h1", ",", "p3"}],
         "\[RightDoubleBracket]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h2"}], "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "h2"}], "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h1"}], "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "h1"}], "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"p2", ",", "p4"}], "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
          RowBox[{"p2", ",", "p4"}], "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h2"}], "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "h2"}], "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h1"}], "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "h1"}], "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
          RowBox[{"p2", ",", "p3"}], "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"p2", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
          RowBox[{"p1", ",", "p4"}], "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"p1", ",", "p4"}], "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"p1", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
          RowBox[{"p1", ",", "p3"}], "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h3", ",", "h2", ",", "h1"}], 
         "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p2", ",", "h2", ",", "p4"}], 
         "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "p2", ",", "h2", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "p2", ",", "h1", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "p2", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "h2", ",", "h1"}], 
          "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "p2", ",", "h2", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "p2", ",", "h2", ",", "p3"}], 
         "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p2", ",", "h1", ",", "p3"}], 
         "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "p2", ",", "h1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "p1", ",", "h2", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "p1", ",", "h2", ",", "p4"}], 
         "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p1", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "p1", ",", "h1", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p1", ",", "h2", ",", "p3"}], 
         "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "p1", ",", "h2", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "p1", ",", "h1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "p1", ",", "h1", ",", "p3"}], 
         "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"p2", ",", "p1", ",", "p4", ",", "p3"}], 
         "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h3"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
          RowBox[{"p2", ",", "p1", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h4"}], "}"}]], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
         RowBox[{
         "h4", ",", "h3", ",", "p2", ",", "h2", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
          RowBox[{
          "h4", ",", "h3", ",", "p2", ",", "h2", ",", "h1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
          RowBox[{
          "h4", ",", "h3", ",", "p1", ",", "h2", ",", "h1", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
         RowBox[{
         "h4", ",", "h3", ",", "p1", ",", "h2", ",", "h1", ",", "p3"}], 
         "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"p2", ",", "p4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
         RowBox[{
         "h4", ",", "p2", ",", "p1", ",", "h2", ",", "p4", ",", "p3"}], 
         "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
          RowBox[{
          "h3", ",", "p2", ",", "p1", ",", "h2", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h1", ",", "h4"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
          RowBox[{
          "h4", ",", "p2", ",", "p1", ",", "h1", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h3"}], "}"}]]}], ",", 
       RowBox[{
        RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
         RowBox[{
         "h3", ",", "p2", ",", "p1", ",", "h1", ",", "p4", ",", "p3"}], 
         "\[RightDoubleBracket]"}], " ", 
        SubscriptBox["\[Delta]", 
         RowBox[{"{", 
          RowBox[{"h2", ",", "h4"}], "}"}]]}]}], "}"}]}], "}"}]}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.899265896014469*^9, 3.8992659111658716`*^9}, 
   3.8992663470980883`*^9, 3.8992670959656534`*^9},
 CellLabel->
  "During evaluation of \
In[96]:=",ExpressionUUID->"d8139c05-ffcd-40e3-8939-d2233eaaed17"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["IP-EOM-CCSD", "Section",
 CellChangeTimes->{{3.8502124694131107`*^9, 3.850212483911498*^9}, {
   3.8508075976382303`*^9, 3.850807637386962*^9}, {3.85157491870508*^9, 
   3.8515749220559587`*^9}, {3.851575053203541*^9, 3.851575059139056*^9}, 
   3.851575661024029*^9, {3.85157970682765*^9, 3.851579715418345*^9}, {
   3.853485369144342*^9, 3.853485401318177*^9}, {3.8538499840059443`*^9, 
   3.853849987654407*^9}, {3.858858281395907*^9, 3.858858293975215*^9}, {
   3.858933373401108*^9, 3.8589333741657867`*^9}, 3.8593504401846657`*^9, 
   3.8593540895014963`*^9, {3.886584561380568*^9, 3.886584566436481*^9}, {
   3.886584617233329*^9, 3.88658461757227*^9}, {3.887363986138163*^9, 
   3.887363986818652*^9}, {3.8874297540337133`*^9, 
   3.887429754384246*^9}},ExpressionUUID->"c061895f-84f6-4a30-b78a-\
fa6a2f12f5a8"],

Cell[TextData[{
 StyleBox["In this example  two inputs are defined to obtain the IP-EOM-CCSD \
equations: \n1. The clusteroperator is given by {{\[OpenCurlyDoubleQuote]1h1p\
\[CloseCurlyDoubleQuote]},{\[OpenCurlyDoubleQuote]2h2p\[CloseCurlyDoubleQuote]\
}}, that corresponds to ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["T", "^"], "=", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["T", "^"], "1"], "+", 
     SubscriptBox[
      OverscriptBox["T", "^"], "2"], " "}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "c1295c53-1c33-4392-9259-0578cfee8ae8"],
 StyleBox[", where  ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["T", "^"], "1"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "b34e7b1f-0b46-474b-94dd-7acdd1162373"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["t", "i", "a"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "19ecc60f-c297-4bde-be22-14e89a80b8c2"],
 StyleBox[" and ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["T", "^"], "2"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "94686b84-91f3-48c0-9724-0352e11f7db3"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["t", "ij", "ab"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"], 
       SuperscriptBox[
        OverscriptBox["b", "^"], "\[Dagger]"], 
       OverscriptBox["j", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "b3094d66-7008-44e8-8a96-e07e5d1a7ab9"],
 StyleBox["\n2. The eomoperator is given by {{\[OpenCurlyDoubleQuote]1h0p\
\[CloseCurlyDoubleQuote]},{\[OpenCurlyDoubleQuote]2h1p\[CloseCurlyDoubleQuote]\
}}, that corresponds to ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["R", "^"], "=", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["R", "^"], "1"], "+", 
     SubscriptBox[
      OverscriptBox["R", "^"], "2"], " "}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "f991cc9f-664c-4d7d-9c7c-dfdc49421892"],
 StyleBox[", where  ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["R", "^"], "1"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "71c0a743-defd-442f-8cee-eb0f90e863b6"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", "i"], 
    RowBox[{
     SubscriptBox["r", "i"], 
     RowBox[{"{", 
      OverscriptBox["i", "^"], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "0810363d-7776-402d-a9fd-9a518256670a"],
 StyleBox[" and ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["R", "^"], "2"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "41dcfbc4-7ce3-44e2-9f98-39d12fb4c3b7"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "ij"}]], 
    RowBox[{
     SubsuperscriptBox["r", "ij", "a"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"], 
       OverscriptBox["j", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "fab86875-f0fb-4c0d-af95-4fee07b3400a"]
}], "Text",
 CellChangeTimes->{{3.887427592761385*^9, 3.887427677732684*^9}, {
   3.887427720661674*^9, 3.887427926139139*^9}, {3.887427969959711*^9, 
   3.887427972564579*^9}, {3.887428062263586*^9, 3.8874283967467422`*^9}, {
   3.887429267706176*^9, 3.887429274047916*^9}, {3.887429381622739*^9, 
   3.8874293936405487`*^9}, {3.887429536879528*^9, 3.887429611150378*^9}, {
   3.8874296515842247`*^9, 3.887429657891182*^9}, {3.887429690476225*^9, 
   3.887429715784561*^9}, {3.8874299400444736`*^9, 3.8874299480649347`*^9}, {
   3.8874441603537807`*^9, 3.887444164056137*^9}, {3.890876847169753*^9, 
   3.890876915577117*^9}, {3.893143942809774*^9, 3.8931439560744143`*^9}, {
   3.89460110527728*^9, 3.894601113558326*^9}, 3.8946020261576567`*^9},
 Background->RGBColor[
  0.9, 1, 1],ExpressionUUID->"18ab3d57-a769-4214-bae1-4f88692bb65a"],

Cell["Input", "Text",
 CellChangeTimes->{{3.8874300269168243`*^9, 3.887430028958555*^9}, {
  3.887430062945299*^9, 3.887430063920225*^9}},
 FontSize->24,
 FontWeight->"Bold",ExpressionUUID->"cfabcbeb-6859-4196-91c3-5b0890c48b65"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClusterOperator", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "\"\<1h1p\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<2h2p\>\"", "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EOMOperator", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "\"\<1h0p\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<2h1p\>\"", "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"EOMCCgen2", "[", 
  RowBox[{"ClusterOperator", ",", "EOMOperator"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8873568308852587`*^9, 3.887356833993724*^9}, {
   3.8874296784339*^9, 3.887429681470037*^9}, {3.887430388563098*^9, 
   3.8874303895261*^9}, 3.890876838193375*^9, {3.890876886789391*^9, 
   3.8908769264634037`*^9}, 3.8992602913175135`*^9},
 CellLabel->
  "In[2117]:=",ExpressionUUID->"21384d8f-23b4-45a5-b3b9-5de401fde13d"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"Output\"\>",
  StripOnInput->False,
  FontSize->24,
  FontWeight->Bold]], "Print",
 CellChangeTimes->{3.899260293462202*^9, 3.8992658859466777`*^9},
 CellLabel->
  "During evaluation of \
In[2117]:=",ExpressionUUID->"5916bbe0-a460-4dc3-8b77-a9c3c273f188"],

Cell[BoxData[
 StyleBox["\<\"Execution Time\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.899260293462202*^9, 3.8992658859775367`*^9},
 CellLabel->
  "During evaluation of \
In[2117]:=",ExpressionUUID->"2bc9c952-f0f8-4edf-8b8e-d3ad5bb8257c"],

Cell[BoxData[
 RowBox[{"{", "2.1875`", "}"}]], "Print",
 CellChangeTimes->{3.899260293462202*^9, 3.8992658860086393`*^9},
 CellLabel->
  "During evaluation of \
In[2117]:=",ExpressionUUID->"528f9eff-e4cd-4663-a099-e035823fc16c"],

Cell[BoxData[
 StyleBox["\<\"Many-body terms\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.899260293462202*^9, 3.899265886022659*^9},
 CellLabel->
  "During evaluation of \
In[2117]:=",ExpressionUUID->"0adf0242-6fd6-4266-8a1a-50630dc7d75b"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h1"}], "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "h1"}], "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "h1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "p3"}], "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"F", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p3"}], "\[RightDoubleBracket]"}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "o1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "h3", ",", "h1", ",", "p3"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h3", ",", "h1", ",", "p3"}], 
         "\[RightDoubleBracket]"}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "p1", ",", "h2", ",", "h1"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "h1", ",", "h2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "h1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "h2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "p1", ",", "h1", ",", "h2"}], 
         "\[RightDoubleBracket]"}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "p1", ",", "v1", ",", "h1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "p1", ",", "v1", ",", "h2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "p1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h2", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "p1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h2", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h2", ",", "v2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "h2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h1", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h1", ",", "v2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "h1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h2", ",", "v2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"p1", ",", "p3"}], "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"F", "\[LeftDoubleBracket]", 
         RowBox[{"p1", ",", "p3"}], "\[RightDoubleBracket]"}], "-", 
        RowBox[{
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "h3", ",", "h2", ",", "h1"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "h1", ",", "h2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "v1", ",", "h1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "v1", ",", "h2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h2", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "p1", ",", "h2", ",", "p3"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "o1", ",", "h2", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "o1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p1", ",", "h2", ",", "p3"}], 
         "\[RightDoubleBracket]"}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "p1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "o1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "h3", ",", "p1", ",", "h2", ",", "h1", ",", "p3"}],
         "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h3", ",", "v1", ",", "p3"}], 
         "\[RightDoubleBracket]"}], " ", 
        RowBox[{"t2", "\[LeftDoubleBracket]", 
         RowBox[{"h1", ",", "h2", ",", "v1", ",", "p1"}], 
         "\[RightDoubleBracket]"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{3.899260293462202*^9, 3.899265886085154*^9},
 CellLabel->
  "During evaluation of \
In[2117]:=",ExpressionUUID->"2411ef38-0ae3-4a07-a5fb-a479c46cd9b6"],

Cell[BoxData[
 StyleBox["\<\"EOM-CC equations\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.899260293462202*^9, 3.8992658861480265`*^9},
 CellLabel->
  "During evaluation of \
In[2117]:=",ExpressionUUID->"54a9d160-a85a-4e95-a93a-97fa36647bd6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
       RowBox[{"h3", ",", "h1"}], "\[RightDoubleBracket]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h3"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p3"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h4"}]},
          "KroneckerDeltaSeq"]}], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "p3"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "h3", ",", "h1", ",", "p3"}], 
        "\[RightDoubleBracket]"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
       RowBox[{"h3", ",", "p1", ",", "h2", ",", "h1"}], 
       "\[RightDoubleBracket]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h3"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p3"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h2"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h4"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p3"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "h2"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h2", ",", "h3"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p3"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h1"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h2", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p3"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "h1"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h3"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"p1", ",", "p3"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h4"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h3"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"p1", ",", "p3"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"p1", ",", "p3"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h3", ",", "h2", ",", "h1"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h3"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p1", ",", "h2", ",", "p3"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h4"}]},
          "KroneckerDeltaSeq"]}], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "p1", ",", "h2", ",", "p3"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h2", ",", "h3"}]},
          "KroneckerDeltaSeq"]}], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p1", ",", "h1", ",", "p3"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h2", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "p1", ",", "h1", ",", "p3"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "h3", ",", "p1", ",", "h2", ",", "h1", ",", "p3"}],
         "\[RightDoubleBracket]"}]}], "}"}]}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.899260293462202*^9, 3.899265886198501*^9},
 CellLabel->
  "During evaluation of \
In[2117]:=",ExpressionUUID->"1661ec3e-91b2-401e-b53b-cf0da46cd2a2"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["DIP-EOM-CCSD", "Section",
 CellChangeTimes->{{3.8502124694131107`*^9, 3.850212483911498*^9}, {
   3.8508075976382303`*^9, 3.850807637386962*^9}, {3.85157491870508*^9, 
   3.8515749220559587`*^9}, {3.851575053203541*^9, 3.851575059139056*^9}, 
   3.851575661024029*^9, {3.85157970682765*^9, 3.851579715418345*^9}, {
   3.853485369144342*^9, 3.853485401318177*^9}, {3.8538499840059443`*^9, 
   3.853849987654407*^9}, {3.858858281395907*^9, 3.858858293975215*^9}, {
   3.858933373401108*^9, 3.8589333741657867`*^9}, 3.8593504401846657`*^9, 
   3.8593540895014963`*^9, {3.886584561380568*^9, 3.886584566436481*^9}, {
   3.886584617233329*^9, 3.88658461757227*^9}, {3.887363986138163*^9, 
   3.887363986818652*^9}, {3.8874297540337133`*^9, 3.887429754384246*^9}, 
   3.8874472020000963`*^9},ExpressionUUID->"9305573d-67c7-4786-9711-\
8a6519bc635c"],

Cell[TextData[{
 StyleBox["In this example  two inputs are defined to obtain the DIP-EOM-CCSD \
equations: \n1. The clusteroperator is given by  \
{{\[OpenCurlyDoubleQuote]1h1p\[CloseCurlyDoubleQuote]},{\
\[OpenCurlyDoubleQuote]2h2p\[CloseCurlyDoubleQuote]}}, that corresponds to ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["T", "^"], "=", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["T", "^"], "1"], "+", 
     SubscriptBox[
      OverscriptBox["T", "^"], "2"], " "}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "ecc19f97-851b-4ff5-a910-98546e335a48"],
 StyleBox[", where  ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["T", "^"], "1"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "cd8cb198-3351-4a1b-85b7-f5f09a2ecf71"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["t", "i", "a"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "3ef20a67-d4d7-4826-8439-6995f2532e35"],
 StyleBox[" and ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["T", "^"], "2"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "7f04b623-064d-4313-914c-fc51de67f537"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["t", "ij", "ab"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"], 
       SuperscriptBox[
        OverscriptBox["b", "^"], "\[Dagger]"], 
       OverscriptBox["j", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "8c09c293-4362-4833-9216-e225d3023191"],
 StyleBox["\n2. The eomoperator is given by {{\[OpenCurlyDoubleQuote]2h0p\
\[CloseCurlyDoubleQuote]},{\[OpenCurlyDoubleQuote]3h1p\[CloseCurlyDoubleQuote]\
}}, that corresponds to ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["R", "^"], "=", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["R", "^"], "1"], "+", 
     SubscriptBox[
      OverscriptBox["R", "^"], "2"], " "}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "63e18bba-f163-40d7-b411-31c3a944e3ab"],
 StyleBox[", where  ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["R", "^"], "1"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "1c88de74-5300-4385-ae0e-ec609c489017"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", "ij"], 
    RowBox[{
     SubscriptBox["r", "ij"], 
     RowBox[{"{", 
      RowBox[{
       OverscriptBox["i", "^"], 
       OverscriptBox["j", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "be931da1-6402-4f80-a973-efd017e4700e"],
 StyleBox[" and ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["R", "^"], "2"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "2c1db6c5-6c1d-4d8c-8d63-4e1d78db1bfa"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "ijk"}]], 
    RowBox[{
     SubsuperscriptBox["r", "ijk", "a"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"], 
       OverscriptBox["j", "^"], 
       OverscriptBox["k", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "4cd4c939-ca78-48fe-aa98-beaf820ccad9"]
}], "Text",
 CellChangeTimes->{{3.887427592761385*^9, 3.887427677732684*^9}, {
   3.887427720661674*^9, 3.887427926139139*^9}, {3.887427969959711*^9, 
   3.887427972564579*^9}, {3.887428062263586*^9, 3.8874283967467422`*^9}, {
   3.887429267706176*^9, 3.887429274047916*^9}, {3.887429381622739*^9, 
   3.8874293936405487`*^9}, {3.887429536879528*^9, 3.887429611150378*^9}, {
   3.8874296515842247`*^9, 3.887429657891182*^9}, {3.887429690476225*^9, 
   3.887429715784561*^9}, {3.8874299400444736`*^9, 3.8874299480649347`*^9}, {
   3.8874441603537807`*^9, 3.887444164056137*^9}, {3.887448041883161*^9, 
   3.88744809955201*^9}, 3.892701641073942*^9, {3.893143923496167*^9, 
   3.893143933647176*^9}, {3.894601081822154*^9, 3.894601089824494*^9}, {
   3.894601651145578*^9, 3.8946016843866262`*^9}, 3.894602035665771*^9},
 Background->RGBColor[
  0.9, 1, 1],ExpressionUUID->"673bfef8-56f6-427e-9460-2781c6f446ff"],

Cell["Input", "Text",
 CellChangeTimes->{{3.8874300269168243`*^9, 3.887430028958555*^9}, {
  3.887430062945299*^9, 3.887430063920225*^9}},
 FontSize->24,
 FontWeight->"Bold",ExpressionUUID->"9571b3eb-a4a5-430f-b3e1-98d470a65c01"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClusterOperator", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "\"\<1h1p\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<2h2p\>\"", "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EOMOperator", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "\"\<2h0p\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<3h1p\>\"", "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"EOMCCgen2", "[", 
  RowBox[{"ClusterOperator", ",", "EOMOperator"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8873568308852587`*^9, 3.887356833993724*^9}, {
   3.8874296784339*^9, 3.887429681470037*^9}, {3.887430388563098*^9, 
   3.8874303895261*^9}, {3.887447211734489*^9, 3.887447220161126*^9}, {
   3.8908777262162933`*^9, 3.8908777368296547`*^9}, 3.8992115462052565`*^9},
 CellLabel->
  "In[2114]:=",ExpressionUUID->"c52d5431-f4f9-4514-8586-9a34ea0bcbee"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"Output\"\>",
  StripOnInput->False,
  FontSize->24,
  FontWeight->Bold]], "Print",
 CellChangeTimes->{3.8992115483453627`*^9, 3.899265871890171*^9},
 CellLabel->
  "During evaluation of \
In[2114]:=",ExpressionUUID->"9fcdaa09-6ceb-4167-95ec-c6d9a0cf7851"],

Cell[BoxData[
 StyleBox["\<\"Execution Time\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.8992115483453627`*^9, 3.899265871949643*^9},
 CellLabel->
  "During evaluation of \
In[2114]:=",ExpressionUUID->"ed06d3cf-0518-47e5-8b29-46343d185faa"],

Cell[BoxData[
 RowBox[{"{", "2.46875`", "}"}]], "Print",
 CellChangeTimes->{3.8992115483453627`*^9, 3.899265871999595*^9},
 CellLabel->
  "During evaluation of \
In[2114]:=",ExpressionUUID->"91aecc64-6311-4143-abe6-246e2f4635bb"],

Cell[BoxData[
 StyleBox["\<\"Many-body terms\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.8992115483453627`*^9, 3.8992658720216217`*^9},
 CellLabel->
  "During evaluation of \
In[2114]:=",ExpressionUUID->"b64a5798-9aa0-44a1-9749-7900c2d5c6bc"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h5", ",", "h2"}], "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "h2"}], "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "o1", ",", "v1", ",", "h2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h2", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h5", ",", "h4", ",", "h2", ",", "h1"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "h4", ",", "h1", ",", "h2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "h4", ",", "v1", ",", "h1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "h4", ",", "v1", ",", "h2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "h4", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "h4", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h2", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h6", ",", "p4"}], "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"F", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "p4"}], "\[RightDoubleBracket]"}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h6", ",", "o1", ",", "v1", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h6", ",", "h5", ",", "h2", ",", "p4"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "h5", ",", "h2", ",", "p4"}], 
         "\[RightDoubleBracket]"}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h6", ",", "h5", ",", "v1", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h5", ",", "p1", ",", "h3", ",", "h2"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "o1", ",", "h2", ",", "h3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "o1", ",", "v1", ",", "h2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "o1", ",", "v1", ",", "h3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "p1", ",", "h2", ",", "h3"}], 
         "\[RightDoubleBracket]"}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "p1", ",", "v1", ",", "h2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "p1", ",", "v1", ",", "h3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "p1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "h3", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "h3", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "p1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "h3", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "h3", ",", "v2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "o1", ",", "v1", ",", "h3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h2", ",", "v2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "o1", ",", "v1", ",", "h2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h3", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h3", ",", "v2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h5", ",", "h4", ",", "p1", ",", "h3", ",", "h2", ",", "h1"}],
         "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "h4", ",", "v1", ",", "h3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "h4", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h2", ",", "v2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "h4", ",", "v1", ",", "h2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h3", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "h4", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h3", ",", "v2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "h4", ",", "v1", ",", "h1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "h3", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h5", ",", "h4", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "h3", ",", "v2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"p1", ",", "p4"}], "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"F", "\[LeftDoubleBracket]", 
         RowBox[{"p1", ",", "p4"}], "\[RightDoubleBracket]"}], "-", 
        RowBox[{
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p4"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1", ",", "v1", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p4"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h6", ",", "p1", ",", "h3", ",", "p4"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h6", ",", "o1", ",", "h3", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h6", ",", "o1", ",", "v1", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "p1", ",", "h3", ",", "p4"}], 
         "\[RightDoubleBracket]"}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h6", ",", "p1", ",", "v1", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h6", ",", "o1", ",", "v1", ",", "p4"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h3", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h6", ",", "h5", ",", "p1", ",", "h3", ",", "h2", ",", "p4"}],
         "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "h5", ",", "v1", ",", "p4"}], 
         "\[RightDoubleBracket]"}], " ", 
        RowBox[{"t2", "\[LeftDoubleBracket]", 
         RowBox[{"h2", ",", "h3", ",", "v1", ",", "p1"}], 
         "\[RightDoubleBracket]"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{3.8992115483453627`*^9, 3.8992658720832095`*^9},
 CellLabel->
  "During evaluation of \
In[2114]:=",ExpressionUUID->"ed5e6cde-6d1c-4a75-a1d8-6b88383e05b2"],

Cell[BoxData[
 StyleBox["\<\"EOM-CC equations\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.8992115483453627`*^9, 3.8992658721481857`*^9},
 CellLabel->
  "During evaluation of \
In[2114]:=",ExpressionUUID->"b101024e-b540-4213-a6d7-a1f23b845ece"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "h2"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h5"}]},
          "KroneckerDeltaSeq"]}], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h2"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h2", ",", "h4"}]},
          "KroneckerDeltaSeq"]}], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "h1"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h2", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h1"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h5", ",", "h4", ",", "h2", ",", "h1"}], 
        "\[RightDoubleBracket]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "p4"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h4"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "p4"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h5"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "p4"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p4"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "p4"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h6"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p4"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "h5", ",", "h2", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h5"}]},
          "KroneckerDeltaSeq"]}], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "h4", ",", "h2", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "h4", ",", "h2", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h2", ",", "h4"}]},
          "KroneckerDeltaSeq"]}], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "h5", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h2", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "h4", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h2", ",", "h6"}]},
          "KroneckerDeltaSeq"]}], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "h4", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "p1", ",", "h3", ",", "h2"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h5"}]},
          "KroneckerDeltaSeq"]}], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p1", ",", "h3", ",", "h2"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h2", ",", "h4"}]},
          "KroneckerDeltaSeq"]}], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "p1", ",", "h3", ",", "h1"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h2", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p1", ",", "h3", ",", "h1"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h3", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "p1", ",", "h2", ",", "h1"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h3", ",", "h5"}]},
          "KroneckerDeltaSeq"]}], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p1", ",", "h2", ",", "h1"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h5", ",", "h4", ",", "p1", ",", "h3", ",", "h2", ",", "h1"}],
         "\[RightDoubleBracket]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "h3"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h4"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "h3"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h4"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "h2"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "h2"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h5"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "h3"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h3"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "h2"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h5"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h2"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "h3"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h6"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h3"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h6"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "h2"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h2"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h2", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "h1"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h2", ",", "h4"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "h1"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h2", ",", "h5"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "h1"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h2", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h1"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h2", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "h1"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h2", ",", "h6"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h1"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"p1", ",", "p4"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h4"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"p1", ",", "p4"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h5"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"p1", ",", "p4"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"p1", ",", "p4"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"p1", ",", "p4"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h6"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
         RowBox[{"p1", ",", "p4"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "h5", ",", "h3", ",", "h2"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h5"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "h4", ",", "h3", ",", "h2"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "h4", ",", "h3", ",", "h2"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h2", ",", "h4"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "h5", ",", "h3", ",", "h1"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h2", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "h4", ",", "h3", ",", "h1"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h2", ",", "h6"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "h4", ",", "h3", ",", "h1"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h3", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "h5", ",", "h2", ",", "h1"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h3", ",", "h5"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "h4", ",", "h2", ",", "h1"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h3", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"p1", ",", "p4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "h4", ",", "h2", ",", "h1"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "p1", ",", "h3", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h4"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "p1", ",", "h3", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h4"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "p1", ",", "h2", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "p1", ",", "h2", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h5"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "p1", ",", "h3", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p1", ",", "h3", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "p1", ",", "h2", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h5"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p1", ",", "h2", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "p1", ",", "h3", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h6"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h2", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p1", ",", "h3", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h6"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "p1", ",", "h2", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p1", ",", "h2", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h2", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "p1", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h2", ",", "h4"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "p1", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h2", ",", "h5"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h6", ",", "p1", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h2", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p1", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h2", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h5", ",", "p1", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h2", ",", "h6"}]},
          "KroneckerDeltaSeq"]}], " ", 
        TemplateBox[{
          RowBox[{"h3", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p1", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
         RowBox[{
         "h6", ",", "h5", ",", "p1", ",", "h3", ",", "h2", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h1", ",", "h5"}]},
          "KroneckerDeltaSeq"]}], " ", 
        RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
         RowBox[{
         "h6", ",", "h4", ",", "p1", ",", "h3", ",", "h2", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h1", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
         RowBox[{
         "h5", ",", "h4", ",", "p1", ",", "h3", ",", "h2", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h2", ",", "h4"}]},
          "KroneckerDeltaSeq"]}], " ", 
        RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
         RowBox[{
         "h6", ",", "h5", ",", "p1", ",", "h3", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h2", ",", "h5"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
         RowBox[{
         "h6", ",", "h4", ",", "p1", ",", "h3", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h2", ",", "h6"}]},
          "KroneckerDeltaSeq"]}], " ", 
        RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
         RowBox[{
         "h5", ",", "h4", ",", "p1", ",", "h3", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h3", ",", "h4"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
         RowBox[{
         "h6", ",", "h5", ",", "p1", ",", "h2", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         TemplateBox[{
           RowBox[{"h3", ",", "h5"}]},
          "KroneckerDeltaSeq"]}], " ", 
        RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
         RowBox[{
         "h6", ",", "h4", ",", "p1", ",", "h2", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        TemplateBox[{
          RowBox[{"h3", ",", "h6"}]},
         "KroneckerDeltaSeq"], " ", 
        RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
         RowBox[{
         "h5", ",", "h4", ",", "p1", ",", "h2", ",", "h1", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}]}], "}"}]}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.8992115483453627`*^9, 3.8992658722260666`*^9},
 CellLabel->
  "During evaluation of \
In[2114]:=",ExpressionUUID->"315c9e30-f1f3-4a2e-8562-f7f509548f5f"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Block ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     SubsuperscriptBox["\[Phi]", "ij", "a"]},
    "Bra"], 
   OverscriptBox["\[ScriptCapitalH]", "_"], 
   TemplateBox[{
     SubsuperscriptBox["\[Phi]", "kl", "b"]},
    "Ket"]}]],ExpressionUUID->"f9031a43-6a96-4f01-9465-82503cdaf2a6"],
 " of the IP-EOM-CCSD matrix "
}], "Section",
 CellChangeTimes->{{3.8502124694131107`*^9, 3.850212483911498*^9}, {
   3.8508075976382303`*^9, 3.850807637386962*^9}, {3.85157491870508*^9, 
   3.8515749220559587`*^9}, {3.851575053203541*^9, 3.851575059139056*^9}, 
   3.851575661024029*^9, {3.85157970682765*^9, 3.851579715418345*^9}, {
   3.853485369144342*^9, 3.853485401318177*^9}, {3.8538499840059443`*^9, 
   3.853849987654407*^9}, {3.858858281395907*^9, 3.858858293975215*^9}, {
   3.858933373401108*^9, 3.8589333741657867`*^9}, 3.8593504401846657`*^9, 
   3.8593540895014963`*^9, {3.886584561380568*^9, 3.886584566436481*^9}, {
   3.886584617233329*^9, 3.88658461757227*^9}, {3.887363986138163*^9, 
   3.887363986818652*^9}, 3.887431469151123*^9, {3.887431987466086*^9, 
   3.887431998356406*^9}, {3.887432811337199*^9, 3.887432811604763*^9}, {
   3.887441350578339*^9, 3.887441352790237*^9}, {3.887441414331935*^9, 
   3.887441436452364*^9}, {3.887441542116475*^9, 3.887441544956053*^9}, {
   3.891656481781907*^9, 3.8916565004698973`*^9}, {3.8916566909113293`*^9, 
   3.891656725109528*^9}, {3.8916579587113*^9, 3.891657986399193*^9}, {
   3.891661218809699*^9, 3.891661220711855*^9}, {3.894601793543352*^9, 
   3.894601803616433*^9}},ExpressionUUID->"872d938d-6067-43ba-9b44-\
d0d02fd01b54"],

Cell[TextData[{
 StyleBox["In this example, we evaluate the block   ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     SubsuperscriptBox["\[Phi]", "ij", "a"]},
    "Bra"], 
   OverscriptBox["\[ScriptCapitalH]", "_"], 
   TemplateBox[{
     SubsuperscriptBox["\[Phi]", "kl", "b"]},
    "Ket"]}]],ExpressionUUID->"f70a9306-6764-4f2b-ad37-d41b636edde0"],
 StyleBox[" of the IP-EOM-CCSD.\n1.    The cluster operator is given by {{\
\[OpenCurlyDoubleQuote]1h1p\[CloseCurlyDoubleQuote]},{\[OpenCurlyDoubleQuote]\
2h2p\[CloseCurlyDoubleQuote]}} , which corresponds to ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["T", "^"], "=", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["T", "^"], "1"], "+", 
     SubscriptBox[
      OverscriptBox["T", "^"], "2"], " "}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "6b8518cc-a297-4b9f-8ce9-416b47acbf3e"],
 StyleBox[", where  ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["T", "^"], "1"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "3e5dd085-9f23-4a6a-9eab-6c63a16e75cb"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["t", "i", "a"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "d297af17-e116-4733-8412-cd73a407b5d8"],
 StyleBox[" and ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["T", "^"], "2"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "33a33c89-db6a-4104-94ee-c85ceae860ba"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["t", "ij", "ab"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"], 
       SuperscriptBox[
        OverscriptBox["b", "^"], "\[Dagger]"], 
       OverscriptBox["j", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "cd9ebae1-b05b-4186-acbf-1048b41eaeaf"],
 StyleBox[".\n2.    The EOM operator is given by \
{{\[OpenCurlyDoubleQuote]1h0p\[CloseCurlyDoubleQuote]},{\
\[OpenCurlyDoubleQuote]2h1p\[CloseCurlyDoubleQuote]}}, which is ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["R", "^"], "=", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["R", "^"], "1"], "+", 
     SubscriptBox[
      OverscriptBox["R", "^"], "2"], " "}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "8167364f-2766-42b5-ab86-7f2dad07cab3"],
 StyleBox[", where  ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["R", "^"], "1"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "25dcc35b-9bb0-43ff-b8c4-6294a171ab8c"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", "i"], 
    RowBox[{
     SubscriptBox["r", "i"], 
     RowBox[{"{", 
      OverscriptBox["i", "^"], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "42a2565d-4771-47d5-a41f-4f916d53a709"],
 StyleBox[" and ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["R", "^"], "2"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "53e3ad6e-4798-4204-9bb1-e56c4ccb9fc4"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "ij"}]], 
    RowBox[{
     SubsuperscriptBox["r", "ij", "a"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"], 
       OverscriptBox["j", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "e9c6d08c-a8ee-4182-b5e0-bd0a1d5ed017"],
 StyleBox[".\n 3.   The block of the IP-EOM-CCSD matrix we are interested in \
is given by {2,2}.",
  Background->RGBColor[0.9, 1, 1]]
}], "Text",
 CellChangeTimes->{{3.887427592761385*^9, 3.887427677732684*^9}, {
   3.887427720661674*^9, 3.887427926139139*^9}, {3.887427969959711*^9, 
   3.887427972564579*^9}, {3.887428062263586*^9, 3.8874283967467422`*^9}, {
   3.887429267706176*^9, 3.887429274047916*^9}, {3.887429381622739*^9, 
   3.8874293936405487`*^9}, {3.887429536879528*^9, 3.887429611150378*^9}, {
   3.887431544551499*^9, 3.887431566249061*^9}, {3.887432005829743*^9, 
   3.887432058872601*^9}, {3.887432113125527*^9, 3.88743212528463*^9}, {
   3.8874321569853487`*^9, 3.8874321656651382`*^9}, {3.8874322789770203`*^9, 
   3.887432423706667*^9}, {3.8874412545709963`*^9, 3.887441343186265*^9}, {
   3.887859306080262*^9, 3.8878593476418657`*^9}, {3.887859705689024*^9, 
   3.887860033126234*^9}, {3.887860386592795*^9, 3.8878604078497753`*^9}, {
   3.892265532122266*^9, 3.892265567863847*^9}, {3.892268315258397*^9, 
   3.892268451579702*^9}, {3.893145176716514*^9, 3.8931451785990353`*^9}, {
   3.8946017106944733`*^9, 3.8946018203433323`*^9}, 3.8946018511247377`*^9},
 Background->RGBColor[
  0.9, 1, 1],ExpressionUUID->"8140ee5f-c240-43b2-96ca-79a58b4bc4d1"],

Cell["Input", "Text",
 CellChangeTimes->{{3.8874300269168243`*^9, 3.887430028958555*^9}, {
  3.887430062945299*^9, 3.887430063920225*^9}},
 FontSize->24,
 FontWeight->"Bold",ExpressionUUID->"263849d7-0049-4d14-8896-c0af058429e2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClusterOperator", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "\"\<1h1p\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<2h2p\>\"", "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EOMOperator", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "\"\<1h0p\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<2h1p\>\"", "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EOMBlock", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"EOMCCgen2", "[", 
  RowBox[{"ClusterOperator", ",", "EOMOperator", ",", "EOMBlock"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.88744120427204*^9, 3.8874412292958317`*^9}, {
   3.887441361616248*^9, 3.887441368017454*^9}, 3.887859287950007*^9, {
   3.890149906286141*^9, 3.890149914540007*^9}, {3.890149997215972*^9, 
   3.89015000471555*^9}, 3.890150193674296*^9, {3.891069357019848*^9, 
   3.891069362424624*^9}, 3.892619434342211*^9, 3.8946018447949457`*^9, 
   3.899210698291157*^9},
 CellLabel->"In[99]:=",ExpressionUUID->"54a2f717-a5b6-4d2f-8130-910cd43638aa"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"Output\"\>",
  StripOnInput->False,
  FontSize->24,
  FontWeight->Bold]], "Print",
 CellChangeTimes->{3.899210702071184*^9, 3.8992602751867847`*^9, 
  3.899267120151599*^9},
 CellLabel->
  "During evaluation of \
In[99]:=",ExpressionUUID->"3314c020-b6d8-4af7-a311-09c6b84881cb"],

Cell[BoxData[
 StyleBox["\<\"Execution Time\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.899210702071184*^9, 3.8992602751867847`*^9, 
  3.899267120164612*^9},
 CellLabel->
  "During evaluation of \
In[99]:=",ExpressionUUID->"9ae7bd5f-a0e8-4782-ad6a-e149a3b8817b"],

Cell[BoxData[
 RowBox[{"{", "0.59375`", "}"}]], "Print",
 CellChangeTimes->{3.899210702071184*^9, 3.8992602751867847`*^9, 
  3.8992671201802435`*^9},
 CellLabel->
  "During evaluation of \
In[99]:=",ExpressionUUID->"7f698c93-1f03-4502-948f-5a5a419e7d33"],

Cell[BoxData[
 StyleBox["\<\"Many-body terms\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.899210702071184*^9, 3.8992602751867847`*^9, 
  3.8992671201959057`*^9},
 CellLabel->
  "During evaluation of \
In[99]:=",ExpressionUUID->"0e98682d-4144-4fe0-ba33-d5582054ec54"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "h2"}], "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h2"}], "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "o1", ",", "v1", ",", "h2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h2", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"p1", ",", "p3"}], "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"F", "\[LeftDoubleBracket]", 
         RowBox[{"p1", ",", "p3"}], "\[RightDoubleBracket]"}], "-", 
        RowBox[{
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "h3", ",", "h2", ",", "h1"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "h1", ",", "h2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "v1", ",", "h1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "v1", ",", "h2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "h3", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h2", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "p1", ",", "h2", ",", "p3"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "o1", ",", "h2", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "o1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "p1", ",", "h2", ",", "p3"}], 
         "\[RightDoubleBracket]"}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "p1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "o1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "h3", ",", "p1", ",", "h2", ",", "h1", ",", "p3"}],
         "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h4", ",", "h3", ",", "v1", ",", "p3"}], 
         "\[RightDoubleBracket]"}], " ", 
        RowBox[{"t2", "\[LeftDoubleBracket]", 
         RowBox[{"h1", ",", "h2", ",", "v1", ",", "p1"}], 
         "\[RightDoubleBracket]"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{3.899210702071184*^9, 3.8992602751867847`*^9, 
  3.8992671202433763`*^9},
 CellLabel->
  "During evaluation of \
In[99]:=",ExpressionUUID->"72953571-3bd1-4b03-a588-9544ea3b9a27"],

Cell[BoxData[
 StyleBox["\<\"EOM-CC equations\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{3.899210702071184*^9, 3.8992602751867847`*^9, 
  3.8992671203071847`*^9},
 CellLabel->
  "During evaluation of \
In[99]:=",ExpressionUUID->"ecf5bedc-51b9-445d-bc0d-a416cd22a9f2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
       RowBox[{"h4", ",", "h2"}], "\[RightDoubleBracket]"}], " ", 
      SubscriptBox["\[Delta]", 
       RowBox[{"{", 
        RowBox[{"h1", ",", "h3"}], "}"}]], " ", 
      SubscriptBox["\[Delta]", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "p3"}], "}"}]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h2"}], "\[RightDoubleBracket]"}]}], " ", 
      SubscriptBox["\[Delta]", 
       RowBox[{"{", 
        RowBox[{"h1", ",", "h4"}], "}"}]], " ", 
      SubscriptBox["\[Delta]", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "p3"}], "}"}]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "h1"}], "\[RightDoubleBracket]"}]}], " ", 
      SubscriptBox["\[Delta]", 
       RowBox[{"{", 
        RowBox[{"h2", ",", "h3"}], "}"}]], " ", 
      SubscriptBox["\[Delta]", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "p3"}], "}"}]]}], ",", 
     RowBox[{
      RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
       RowBox[{"h3", ",", "h1"}], "\[RightDoubleBracket]"}], " ", 
      SubscriptBox["\[Delta]", 
       RowBox[{"{", 
        RowBox[{"h2", ",", "h4"}], "}"}]], " ", 
      SubscriptBox["\[Delta]", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "p3"}], "}"}]]}], ",", 
     RowBox[{
      RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
       RowBox[{"p1", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
      SubscriptBox["\[Delta]", 
       RowBox[{"{", 
        RowBox[{"h1", ",", "h3"}], "}"}]], " ", 
      SubscriptBox["\[Delta]", 
       RowBox[{"{", 
        RowBox[{"h2", ",", "h4"}], "}"}]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"p1", ",", "p3"}], "\[RightDoubleBracket]"}]}], " ", 
      SubscriptBox["\[Delta]", 
       RowBox[{"{", 
        RowBox[{"h1", ",", "h4"}], "}"}]], " ", 
      SubscriptBox["\[Delta]", 
       RowBox[{"{", 
        RowBox[{"h2", ",", "h3"}], "}"}]]}], ",", 
     RowBox[{
      RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
       RowBox[{"h4", ",", "h3", ",", "h2", ",", "h1"}], 
       "\[RightDoubleBracket]"}], " ", 
      SubscriptBox["\[Delta]", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "p3"}], "}"}]]}], ",", 
     RowBox[{
      RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
       RowBox[{"h4", ",", "p1", ",", "h2", ",", "p3"}], 
       "\[RightDoubleBracket]"}], " ", 
      SubscriptBox["\[Delta]", 
       RowBox[{"{", 
        RowBox[{"h1", ",", "h3"}], "}"}]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "p1", ",", "h2", ",", "p3"}], 
        "\[RightDoubleBracket]"}]}], " ", 
      SubscriptBox["\[Delta]", 
       RowBox[{"{", 
        RowBox[{"h1", ",", "h4"}], "}"}]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h4", ",", "p1", ",", "h1", ",", "p3"}], 
        "\[RightDoubleBracket]"}]}], " ", 
      SubscriptBox["\[Delta]", 
       RowBox[{"{", 
        RowBox[{"h2", ",", "h3"}], "}"}]]}], ",", 
     RowBox[{
      RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
       RowBox[{"h3", ",", "p1", ",", "h1", ",", "p3"}], 
       "\[RightDoubleBracket]"}], " ", 
      SubscriptBox["\[Delta]", 
       RowBox[{"{", 
        RowBox[{"h2", ",", "h4"}], "}"}]]}], ",", 
     RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
      RowBox[{"h4", ",", "h3", ",", "p1", ",", "h2", ",", "h1", ",", "p3"}], 
      "\[RightDoubleBracket]"}]}], "}"}], "}"}], "}"}]], "Print",
 CellChangeTimes->{3.899210702071184*^9, 3.8992602751867847`*^9, 
  3.899267120337373*^9},
 CellLabel->
  "During evaluation of \
In[99]:=",ExpressionUUID->"c0875e17-7cb4-4032-8c70-3840ad82648c"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8873568308852587`*^9, 3.887356833993724*^9}, {
   3.887430435429474*^9, 3.887430436531063*^9}, 3.8874315760157413`*^9, {
   3.887432076999713*^9, 3.887432109835281*^9}, {3.887441198366856*^9, 
   3.8874412409074297`*^9}, 
   3.8874413597572927`*^9},ExpressionUUID->"1f5478b1-7dee-4b11-a50c-\
4f6ae98d2e71"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Many-body terms ",
 Cell[BoxData[
  SubsuperscriptBox["\[Chi]2", "p3p4", "p1h3"]],ExpressionUUID->
  "7c2e7b1f-02c8-4901-a379-28dacdf9d37a"],
 " and ",
 Cell[BoxData[
  SubsuperscriptBox["\[Chi]2", "h1p3", "p1p2"]],ExpressionUUID->
  "75fa4422-f0b5-4759-ae1a-8e9beb0e25fc"],
 " "
}], "Section",
 CellChangeTimes->{{3.8502124694131107`*^9, 3.850212483911498*^9}, {
   3.8508075976382303`*^9, 3.850807637386962*^9}, {3.85157491870508*^9, 
   3.8515749220559587`*^9}, {3.851575053203541*^9, 3.851575059139056*^9}, 
   3.851575661024029*^9, {3.85157970682765*^9, 3.851579715418345*^9}, {
   3.853485369144342*^9, 3.853485401318177*^9}, {3.8538499840059443`*^9, 
   3.853849987654407*^9}, {3.858858281395907*^9, 3.858858293975215*^9}, {
   3.858933373401108*^9, 3.8589333741657867`*^9}, 3.8593504401846657`*^9, 
   3.8593540895014963`*^9, {3.886584561380568*^9, 3.886584566436481*^9}, {
   3.886584617233329*^9, 3.88658461757227*^9}, {3.887363986138163*^9, 
   3.887363986818652*^9}, 3.887429919287883*^9, {3.891576240671155*^9, 
   3.891576252957996*^9}, {3.892265600017*^9, 3.8922656010837*^9}, {
   3.892265752694623*^9, 3.892265835828897*^9}, {3.892265878430479*^9, 
   3.892265930993951*^9}, {3.892266311273357*^9, 3.892266313947382*^9}, {
   3.893144014177617*^9, 
   3.8931440276910477`*^9}},ExpressionUUID->"9b7c84b1-75ef-4661-b553-\
be68bcdef511"],

Cell[TextData[{
 StyleBox["In this example require  three inputs are required to obtain the \
expression for   ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  SubsuperscriptBox["\[Chi]2", "p3p4", "p1h3"]],ExpressionUUID->
  "09462726-f4ab-4ffd-9634-9dd846b9e82b"],
 StyleBox["  and ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  SubsuperscriptBox["\[Chi]2", "h1p3", "p1p2"]],ExpressionUUID->
  "6a62d706-3285-426d-965b-e567b1f9bcec"],
 StyleBox[" : \n1.  The cluster operator is given by \
{{\[OpenCurlyDoubleQuote]1h1p\[CloseCurlyDoubleQuote]},{\
\[OpenCurlyDoubleQuote]2h2p\[CloseCurlyDoubleQuote]}}, that corresponds to ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["T", "^"], "=", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["T", "^"], "1"], "+", 
     SubscriptBox[
      OverscriptBox["T", "^"], "2"], " "}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "d80aca93-861f-4866-84c9-ababfa8263ae"],
 StyleBox[", where  ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["T", "^"], "1"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "02a3f375-b09d-404a-9cf9-97eb6cea61f6"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["t", "i", "a"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "6d715b26-510b-4f9c-8b6e-82a72b77d956"],
 StyleBox[" , ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["T", "^"], "2"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "ddac0b58-9148-4e1e-ac3f-be465e86b60d"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"ab", ",", "ij"}]], 
    RowBox[{
     SubsuperscriptBox["t", "ij", "ab"], 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox["a", "^"], "\[Dagger]"], 
        OverscriptBox["i", "^"], 
        SuperscriptBox[
         OverscriptBox["b", "^"], "\[Dagger]"], 
        OverscriptBox["j", "^"]}], "}"}], " ", ".", 
      StyleBox[
       RowBox[{"    ", 
        StyleBox[" ",
         Background->RGBColor[0.9, 1, 1]], "   "}]]}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "44ee127e-9efe-4259-a396-aeb843ad7e93"],
 StyleBox["\n2. The second quantized structure of the many-body terms  are \
the following:  ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  RowBox[{
   SubsuperscriptBox["\[Chi]", "p3p4", "p1h3"], "=", 
   TemplateBox[{
     SuperscriptBox["\[CapitalPhi]", "p1"]},
    "Bra"]}]],ExpressionUUID->"655e965c-1515-453d-9546-ff11b4c9f3e4"],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["H", "_"], "N"], TraditionalForm]],ExpressionUUID->
  "ea646ccd-5080-464d-99ab-d278b67b7793"],
 Cell[BoxData[
  SubscriptBox[
   TemplateBox[{
     SubsuperscriptBox["\[CapitalPhi]", "h3", "p3p4"]},
    "Ket"], "in"]],ExpressionUUID->"d5ec478f-5cab-487b-80ac-238821c62e57"],
 " and ",
 Cell[BoxData[
  RowBox[{
   SubsuperscriptBox["\[Chi]", "h1p3", "p1p2"], "=", 
   TemplateBox[{
     SubsuperscriptBox["\[CapitalPhi]", "h1", "p1p2"]},
    "Bra"]}]],ExpressionUUID->"bba6dc50-d113-4a16-8b40-605c152dcabd"],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["H", "_"], "N"], TraditionalForm]],ExpressionUUID->
  "fbf8ca8a-1469-4f93-a51e-93effebbb655"],
 Cell[BoxData[
  SubscriptBox[
   TemplateBox[{
     SuperscriptBox["\[CapitalPhi]", "p3"]},
    "Ket"], "in"]],ExpressionUUID->"b0bebaee-adc9-491e-bd59-3b2fe135168b"],
 " \n3. The EOM operator is simply {{\[OpenCurlyDoubleQuote]0h0p\
\[CloseCurlyDoubleQuote]}}."
}], "Text",
 CellChangeTimes->{{3.887427592761385*^9, 3.887427677732684*^9}, {
   3.887427720661674*^9, 3.887427926139139*^9}, {3.887427969959711*^9, 
   3.887427972564579*^9}, {3.887428062263586*^9, 3.8874283967467422`*^9}, {
   3.887429267706176*^9, 3.887429274047916*^9}, {3.887429381622739*^9, 
   3.8874293936405487`*^9}, {3.887429536879528*^9, 3.887429611150378*^9}, 
   3.8874299238344517`*^9, {3.887430812188911*^9, 3.8874309977976637`*^9}, {
   3.887444139329073*^9, 3.8874441433298483`*^9}, {3.8901894951238823`*^9, 
   3.890189514735512*^9}, {3.890876683169842*^9, 3.890876731028802*^9}, {
   3.891576352384365*^9, 3.891576388231876*^9}, {3.891578519708733*^9, 
   3.891578898573498*^9}, {3.89226594028483*^9, 3.8922659708105717`*^9}, {
   3.892266025386065*^9, 3.892266108205636*^9}, {3.8922734231449738`*^9, 
   3.892273500912376*^9}, {3.893146860673347*^9, 3.8931468967351503`*^9}, {
   3.8931469976881733`*^9, 3.8931470462885857`*^9}, {3.8946010003690434`*^9, 
   3.89460100915877*^9}, {3.894601869961258*^9, 3.894601892872316*^9}},
 Background->RGBColor[
  0.9, 1, 1],ExpressionUUID->"d334f8c7-ad1c-4f3f-b249-514123bfeb5a"],

Cell["Input", "Text",
 CellChangeTimes->{{3.8874300269168243`*^9, 3.887430028958555*^9}, {
  3.887430062945299*^9, 3.887430063920225*^9}},
 FontSize->24,
 FontWeight->"Bold",ExpressionUUID->"ff747f9b-bd7d-460e-864e-1afdeeed9688"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClusterOperator", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "\"\<1h1p\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<2h2p\>\"", "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EOMOperator", "=", 
   RowBox[{"{", 
    RowBox[{"{", "\"\<0h0\>\"", "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ManyBodyOp", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "p1", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["p3", "\[Dagger]"], ",", 
         SuperscriptBox["p4", "\[Dagger]"], ",", "h3"}], "}"}]}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["h1", "\[Dagger]"], ",", "p2", ",", "p1"}], "}"}], 
       ",", 
       RowBox[{"{", 
        SuperscriptBox["p3", "\[Dagger]"], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"EOMCCgen2", "[", 
  RowBox[{"ClusterOperator", ",", "EOMOperator", ",", "ManyBodyOp"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.89157629002946*^9, 3.891576295105332*^9}, 
   3.8915764887114887`*^9, 3.893145792808779*^9, {3.894601901968453*^9, 
   3.894601905316249*^9}, 3.8992107159022455`*^9, {3.899210818764987*^9, 
   3.8992108229055653`*^9}, 3.8992112956798134`*^9, 3.8992113923644533`*^9, 
   3.8992573899547157`*^9, 3.8992603221185675`*^9},
 CellLabel->
  "In[103]:=",ExpressionUUID->"d030f460-3e65-47f6-9ea7-c0ec0d19b77f"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"Output\"\>",
  StripOnInput->False,
  FontSize->24,
  FontWeight->Bold]], "Print",
 CellChangeTimes->{{3.8992107167458096`*^9, 3.8992107290112624`*^9}, 
   3.899210791101594*^9, 3.8992108237036724`*^9, {3.899210911527187*^9, 
   3.8992109157225485`*^9}, 3.899210954078447*^9, 3.899211037562372*^9, {
   3.899211280408264*^9, 3.8992112975702715`*^9}, 3.89921139333315*^9, 
   3.8992114726972957`*^9, 3.8992115843946176`*^9, 3.8992119958251424`*^9, 
   3.8992562508701115`*^9, 3.899256337154422*^9, 3.8992572950449343`*^9, {
   3.8992573865025268`*^9, 3.8992573905193644`*^9}, {3.8992603095129876`*^9, 
   3.899260322872328*^9}, 3.8992663908748446`*^9, 3.899267134110303*^9},
 CellLabel->
  "During evaluation of \
In[103]:=",ExpressionUUID->"22830975-68e4-4c1d-9af2-04f73d1a4d11"],

Cell[BoxData[
 StyleBox["\<\"Execution Time\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{{3.8992107167458096`*^9, 3.8992107290112624`*^9}, 
   3.899210791101594*^9, 3.8992108237036724`*^9, {3.899210911527187*^9, 
   3.8992109157225485`*^9}, 3.899210954078447*^9, 3.899211037562372*^9, {
   3.899211280408264*^9, 3.8992112975702715`*^9}, 3.89921139333315*^9, 
   3.8992114726972957`*^9, 3.8992115843946176`*^9, 3.8992119958251424`*^9, 
   3.8992562508701115`*^9, 3.899256337154422*^9, 3.8992572950449343`*^9, {
   3.8992573865025268`*^9, 3.8992573905193644`*^9}, {3.8992603095129876`*^9, 
   3.899260322872328*^9}, 3.8992663908748446`*^9, 3.899267134125927*^9},
 CellLabel->
  "During evaluation of \
In[103]:=",ExpressionUUID->"9baee5e9-7ad4-4b29-b3ab-432a6cfddb8e"],

Cell[BoxData[
 RowBox[{"{", "1.078125`", "}"}]], "Print",
 CellChangeTimes->{{3.8992107167458096`*^9, 3.8992107290112624`*^9}, 
   3.899210791101594*^9, 3.8992108237036724`*^9, {3.899210911527187*^9, 
   3.8992109157225485`*^9}, 3.899210954078447*^9, 3.899211037562372*^9, {
   3.899211280408264*^9, 3.8992112975702715`*^9}, 3.89921139333315*^9, 
   3.8992114726972957`*^9, 3.8992115843946176`*^9, 3.8992119958251424`*^9, 
   3.8992562508701115`*^9, 3.899256337154422*^9, 3.8992572950449343`*^9, {
   3.8992573865025268`*^9, 3.8992573905193644`*^9}, {3.8992603095129876`*^9, 
   3.899260322872328*^9}, 3.8992663908748446`*^9, 3.899267134125927*^9},
 CellLabel->
  "During evaluation of \
In[103]:=",ExpressionUUID->"4cfbfc2c-c8de-4369-9aa6-84c6b72be4c6"],

Cell[BoxData[
 StyleBox["\<\"Many-body terms\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{{3.8992107167458096`*^9, 3.8992107290112624`*^9}, 
   3.899210791101594*^9, 3.8992108237036724`*^9, {3.899210911527187*^9, 
   3.8992109157225485`*^9}, 3.899210954078447*^9, 3.899211037562372*^9, {
   3.899211280408264*^9, 3.8992112975702715`*^9}, 3.89921139333315*^9, 
   3.8992114726972957`*^9, 3.8992115843946176`*^9, 3.8992119958251424`*^9, 
   3.8992562508701115`*^9, 3.899256337154422*^9, 3.8992572950449343`*^9, {
   3.8992573865025268`*^9, 3.8992573905193644`*^9}, {3.8992603095129876`*^9, 
   3.899260322872328*^9}, 3.8992663908748446`*^9, 3.899267134141548*^9},
 CellLabel->
  "During evaluation of \
In[103]:=",ExpressionUUID->"01de4fad-0743-492c-8ebd-085c786cc7ed"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "p1", ",", "p4", ",", "p3"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"t1", "\[LeftDoubleBracket]", 
           RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}]}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "o1", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "p1", ",", "p4", ",", "p3"}], 
         "\[RightDoubleBracket]"}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"p2", ",", "p1", ",", "h1", ",", "p3"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "h1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1", ",", "h1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2", ",", "h1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"p2", ",", "p1", ",", "h1", ",", "p3"}], 
         "\[RightDoubleBracket]"}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"p2", ",", "p1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h1", ",", "p2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h1", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h1", ",", "v1", ",", "p2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "h1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "p2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "p2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "h1", ",", "p2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "h1", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "h1", ",", "v1", ",", "p2"}], 
          "\[RightDoubleBracket]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.8992107167458096`*^9, 3.8992107290112624`*^9}, 
   3.899210791101594*^9, 3.8992108237036724`*^9, {3.899210911527187*^9, 
   3.8992109157225485`*^9}, 3.899210954078447*^9, 3.899211037562372*^9, {
   3.899211280408264*^9, 3.8992112975702715`*^9}, 3.89921139333315*^9, 
   3.8992114726972957`*^9, 3.8992115843946176`*^9, 3.8992119958251424`*^9, 
   3.8992562508701115`*^9, 3.899256337154422*^9, 3.8992572950449343`*^9, {
   3.8992573865025268`*^9, 3.8992573905193644`*^9}, {3.8992603095129876`*^9, 
   3.899260322872328*^9}, 3.8992663908748446`*^9, 3.8992671341571684`*^9},
 CellLabel->
  "During evaluation of \
In[103]:=",ExpressionUUID->"77e045bc-e724-4179-97e8-8e8a6d3035f8"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{
  3.891578018434493*^9},ExpressionUUID->"23e67742-4882-4af1-9917-\
4f0a2b19831b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Wick\[CloseCurlyQuote]s theorem to a normal ordered second quantized \
string", "Section",
 CellChangeTimes->{{3.8502124694131107`*^9, 3.850212483911498*^9}, {
   3.8508075976382303`*^9, 3.850807637386962*^9}, {3.85157491870508*^9, 
   3.8515749220559587`*^9}, {3.851575053203541*^9, 3.851575059139056*^9}, 
   3.851575661024029*^9, {3.85157970682765*^9, 3.851579715418345*^9}, {
   3.853485369144342*^9, 3.853485401318177*^9}, {3.8538499840059443`*^9, 
   3.853849987654407*^9}, {3.858858281395907*^9, 3.858858293975215*^9}, {
   3.858933373401108*^9, 3.8589333741657867`*^9}, 3.8593504401846657`*^9, 
   3.8593540895014963`*^9, {3.886584561380568*^9, 3.886584566436481*^9}, {
   3.886584617233329*^9, 3.88658461757227*^9}, {3.887363986138163*^9, 
   3.887363986818652*^9}, 3.887431469151123*^9, {3.887431987466086*^9, 
   3.887431998356406*^9}, {3.887432811337199*^9, 3.887432811604763*^9}, {
   3.887441350578339*^9, 3.887441352790237*^9}, {3.892265102688031*^9, 
   3.892265126686202*^9}, 
   3.893148478594543*^9},ExpressionUUID->"2ae60356-2566-4b17-a6c0-\
8526567dd940"],

Cell[TextData[{
 "In this example, we evaluate a normal-ordered second-quantized string using \
Wick\[CloseCurlyQuote]s Theorem. The string ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["h1", "\[Dagger]"], 
        StyleBox[",",
         Background->RGBColor[0.9, 1, 1]], 
        SuperscriptBox["h2", "\[Dagger]"], 
        StyleBox[",",
         Background->RGBColor[0.9, 1, 1]], 
        StyleBox["p2",
         Background->RGBColor[0.9, 1, 1]], 
        StyleBox[",",
         Background->RGBColor[0.9, 1, 1]], 
        StyleBox["p1",
         Background->RGBColor[0.9, 1, 1]]}], 
       StyleBox["}",
        Background->RGBColor[0.9, 1, 1]]}], 
      RowBox[{
       StyleBox["{",
        Background->RGBColor[0.9, 1, 1]], 
       RowBox[{
        SuperscriptBox["q1", "\[Dagger]"], ",", 
        SuperscriptBox["q2", "\[Dagger]"], 
        StyleBox[",",
         Background->RGBColor[0.9, 1, 1]], 
        StyleBox["q4",
         Background->RGBColor[0.9, 1, 1]], 
        StyleBox[",",
         Background->RGBColor[0.9, 1, 1]], 
        StyleBox["q3",
         Background->RGBColor[0.9, 1, 1]]}], 
       StyleBox["}",
        Background->RGBColor[0.9, 1, 1]]}]}], 
     StyleBox[",",
      Background->RGBColor[0.9, 1, 1]], 
     RowBox[{
      StyleBox["{",
       Background->RGBColor[0.9, 1, 1]], 
      RowBox[{
       StyleBox["{",
        Background->RGBColor[0.9, 1, 1]], 
       RowBox[{
        SuperscriptBox["v1", "\[Dagger]"], ",", 
        StyleBox["o1",
         Background->RGBColor[0.9, 1, 1]]}], 
       StyleBox["}",
        Background->RGBColor[0.9, 1, 1]]}], 
      StyleBox["}",
       Background->RGBColor[0.9, 1, 1]]}], 
     StyleBox[",",
      Background->RGBColor[0.9, 1, 1]], 
     RowBox[{
      StyleBox["{",
       Background->RGBColor[0.9, 1, 1]], 
      RowBox[{
       SuperscriptBox["p3", "\[Dagger]"], 
       StyleBox[",",
        Background->RGBColor[0.9, 1, 1]], 
       StyleBox["h3",
        Background->RGBColor[0.9, 1, 1]]}], 
      StyleBox["}",
       Background->RGBColor[0.9, 1, 1]]}]}], 
    StyleBox["}",
     Background->RGBColor[0.9, 1, 1]]}], TraditionalForm]], "Input",
  ExpressionUUID->"f5e48ba9-a44c-4949-9ef7-9003d7a79a1c"],
 "  must be composed of four parts: the first part corresponds to the bra, \
the second to ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    OverscriptBox["F", "^"], "N"], " ", "or", " ", 
   SubscriptBox[
    OverscriptBox["V", "^"], "N"], " "}]], "Input",
  CellChangeTimes->{{3.892268047205635*^9, 3.89226804722158*^9}},
  ExpressionUUID->"f05f95c6-dec9-49e7-be1a-a398e01762d1"],
 ", the third to the cluster operators ",
 Cell[BoxData[
  RowBox[{" ", 
   OverscriptBox["T", "^"], " "}]], "Input",
  CellChangeTimes->{{3.892268047205635*^9, 3.89226804722158*^9}},
  ExpressionUUID->"1b7c8455-6d03-460a-b09f-f9636a31bbe5"],
 ", and the last one to the EOM-CC excitation operator ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["R", "^"], TraditionalForm]], "Input",
  CellChangeTimes->{{3.892268047205635*^9, 3.89226804722158*^9}},
  ExpressionUUID->"70efafb6-2184-4811-a564-6866efd36742"],
 "."
}], "Text",
 CellChangeTimes->{{3.887427592761385*^9, 3.887427677732684*^9}, {
   3.887427720661674*^9, 3.887427926139139*^9}, {3.887427969959711*^9, 
   3.887427972564579*^9}, {3.887428062263586*^9, 3.8874283967467422`*^9}, {
   3.887429267706176*^9, 3.887429274047916*^9}, {3.887429381622739*^9, 
   3.8874293936405487`*^9}, {3.887429536879528*^9, 3.887429611150378*^9}, {
   3.887431544551499*^9, 3.887431566249061*^9}, {3.887432005829743*^9, 
   3.887432058872601*^9}, {3.887432113125527*^9, 3.88743212528463*^9}, {
   3.8874321569853487`*^9, 3.8874321656651382`*^9}, {3.8874322789770203`*^9, 
   3.887432423706667*^9}, {3.8874412545709963`*^9, 3.887441343186265*^9}, {
   3.8874457759080133`*^9, 3.887445784160296*^9}, {3.8910578997532597`*^9, 
   3.8910579581851797`*^9}, {3.892265142272456*^9, 3.892265161101411*^9}, {
   3.892265223593602*^9, 3.892265282300646*^9}, {3.892265312654071*^9, 
   3.892265464848319*^9}, 3.8922679618545322`*^9, 3.89226802235955*^9, {
   3.892268065575841*^9, 3.89226811484569*^9}, {3.8927016962587137`*^9, 
   3.8927016995491657`*^9}},
 Background->RGBColor[
  0.9, 1, 1],ExpressionUUID->"bdcdf471-9ffb-42bf-9b1b-81dbbf8a4600"],

Cell["Input", "Text",
 CellChangeTimes->{{3.8874300269168243`*^9, 3.887430028958555*^9}, {
  3.887430062945299*^9, 3.887430063920225*^9}},
 FontSize->24,
 FontWeight->"Bold",ExpressionUUID->"835aa760-0d7c-4113-a810-cd188079d28f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SQstring", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["h1", "\[Dagger]"], ",", "p2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["q1", "\[Dagger]"], ",", 
       SuperscriptBox["q2", "\[Dagger]"], ",", "q4", ",", "q3"}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["v1", "\[Dagger]"], ",", "o1"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["p3", "\[Dagger]"], ",", "h3"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"CWick", "[", "SQstring", "]"}]}], "Input",
 CellChangeTimes->{{3.88744120427204*^9, 3.8874412292958317`*^9}, {
   3.887441361616248*^9, 3.887441368017454*^9}, 3.891057747100666*^9, {
   3.891057808738068*^9, 3.891057859591456*^9}, {3.8915809056938543`*^9, 
   3.891580924459826*^9}, {3.891581808320017*^9, 3.891581827850312*^9}, {
   3.891581991123907*^9, 3.8915819914797707`*^9}, {3.891582036326461*^9, 
   3.8915820404667997`*^9}, {3.8915822590763893`*^9, 3.891582280779862*^9}, {
   3.891582479106861*^9, 3.891582481672844*^9}, {3.8992662129032125`*^9, 
   3.8992662145347943`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"826f49a1-ffa2-4f41-9a58-968da73533fb"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"Output\"\>",
  StripOnInput->False,
  FontSize->24,
  FontWeight->Bold]], "Print",
 CellChangeTimes->{3.8992658455812426`*^9, 3.899266235215047*^9, 
  3.899267150952362*^9},
 CellLabel->
  "During evaluation of \
In[107]:=",ExpressionUUID->"363f6db1-0d8a-49f6-bc16-14f64ffcec8e"],

Cell[BoxData[
 StyleBox["\<\"Fully contrated term\"\>",
  StripOnInput->False,
  LineColor->RGBColor[1, 0.5, 0],
  FrontFaceColor->RGBColor[1, 0.5, 0],
  BackFaceColor->RGBColor[1, 0.5, 0],
  GraphicsColor->RGBColor[1, 0.5, 0],
  FontWeight->Bold,
  FontColor->RGBColor[1, 0.5, 0]]], "Print",
 CellChangeTimes->{3.8992658455812426`*^9, 3.899266235215047*^9, 
  3.899267150952362*^9},
 CellLabel->
  "During evaluation of \
In[107]:=",ExpressionUUID->"16237d52-a7de-48e5-90b9-793deb6ed076"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"h1", ",", "h3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "q1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q2", ",", "o1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q3", ",", "p3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q4", ",", "v1"}], "}"}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["\[Delta]", 
      RowBox[{"{", 
       RowBox[{"h1", ",", "h3"}], "}"}]]}], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "q1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q2", ",", "o1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q3", ",", "v1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q4", ",", "p3"}], "}"}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["\[Delta]", 
      RowBox[{"{", 
       RowBox[{"h1", ",", "h3"}], "}"}]]}], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "q2"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q1", ",", "o1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q3", ",", "p3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q4", ",", "v1"}], "}"}]]}], ",", 
   RowBox[{
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"h1", ",", "h3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "q2"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q1", ",", "o1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q3", ",", "v1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q4", ",", "p3"}], "}"}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["\[Delta]", 
      RowBox[{"{", 
       RowBox[{"h1", ",", "q3"}], "}"}]]}], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q1", ",", "h3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q2", ",", "o1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q4", ",", "v1"}], "}"}]]}], ",", 
   RowBox[{
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"h1", ",", "q3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q1", ",", "o1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q2", ",", "h3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q4", ",", "v1"}], "}"}]]}], ",", 
   RowBox[{
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"h1", ",", "q4"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q1", ",", "h3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q2", ",", "o1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q3", ",", "v1"}], "}"}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["\[Delta]", 
      RowBox[{"{", 
       RowBox[{"h1", ",", "q4"}], "}"}]]}], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "p3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q1", ",", "o1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q2", ",", "h3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q3", ",", "v1"}], "}"}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["\[Delta]", 
      RowBox[{"{", 
       RowBox[{"h1", ",", "o1"}], "}"}]]}], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "q1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q2", ",", "h3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q3", ",", "p3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q4", ",", "v1"}], "}"}]]}], ",", 
   RowBox[{
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"h1", ",", "o1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "q1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q2", ",", "h3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q3", ",", "v1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q4", ",", "p3"}], "}"}]]}], ",", 
   RowBox[{
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"h1", ",", "o1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "q2"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q1", ",", "h3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q3", ",", "p3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q4", ",", "v1"}], "}"}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["\[Delta]", 
      RowBox[{"{", 
       RowBox[{"h1", ",", "o1"}], "}"}]]}], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "q2"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q1", ",", "h3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q3", ",", "v1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q4", ",", "p3"}], "}"}]]}], ",", 
   RowBox[{
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"h1", ",", "q3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "v1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q1", ",", "h3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q2", ",", "o1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q4", ",", "p3"}], "}"}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["\[Delta]", 
      RowBox[{"{", 
       RowBox[{"h1", ",", "q3"}], "}"}]]}], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "v1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q1", ",", "o1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q2", ",", "h3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q4", ",", "p3"}], "}"}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["\[Delta]", 
      RowBox[{"{", 
       RowBox[{"h1", ",", "q4"}], "}"}]]}], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "v1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q1", ",", "h3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q2", ",", "o1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q3", ",", "p3"}], "}"}]]}], ",", 
   RowBox[{
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"h1", ",", "q4"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "v1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q1", ",", "o1"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q2", ",", "h3"}], "}"}]], " ", 
    SubscriptBox["\[Delta]", 
     RowBox[{"{", 
      RowBox[{"q3", ",", "p3"}], "}"}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.899265845939082*^9, 3.899266235387302*^9, 
  3.899267151279977*^9},
 CellLabel->
  "Out[108]=",ExpressionUUID->"dd48c20b-52b3-40bd-a0ed-782977ccb1e9"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["l-EE-EOM-CCSD ", "Section",
 CellChangeTimes->{{3.8502124694131107`*^9, 3.850212483911498*^9}, {
   3.8508075976382303`*^9, 3.850807637386962*^9}, {3.85157491870508*^9, 
   3.8515749220559587`*^9}, {3.851575053203541*^9, 3.851575059139056*^9}, 
   3.851575661024029*^9, {3.85157970682765*^9, 3.851579715418345*^9}, {
   3.853485369144342*^9, 3.853485401318177*^9}, {3.8538499840059443`*^9, 
   3.853849987654407*^9}, {3.858858281395907*^9, 3.858858293975215*^9}, {
   3.858933373401108*^9, 3.8589333741657867`*^9}, 3.8593504401846657`*^9, 
   3.8593540895014963`*^9, {3.886584561380568*^9, 3.886584566436481*^9}, {
   3.886584617233329*^9, 3.88658461757227*^9}, {3.887363986138163*^9, 
   3.887363986818652*^9}, {3.8992017575056486`*^9, 3.8992017596375046`*^9}, {
   3.8992019802185483`*^9, 3.89920198323304*^9}, 3.899211516321908*^9, {
   3.8992582564088755`*^9, 
   3.899258261983621*^9}},ExpressionUUID->"e9d120b0-f171-4e2c-9612-\
fcb1ed404546"],

Cell[TextData[{
 StyleBox["In this example  two inputs are defined to obtain the left \
EE-EOM-CCSD equations: \n1. The ClusterOperator  is given by {{\
\[OpenCurlyDoubleQuote]1h1p\[CloseCurlyDoubleQuote]},{\[OpenCurlyDoubleQuote]\
2h2p\[CloseCurlyDoubleQuote]}} that corresponds to ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["T", "^"], "=", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["T", "^"], "1"], "+", 
     SubscriptBox[
      OverscriptBox["T", "^"], "2"], " "}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "f871668e-d3c3-49ff-a2f9-b22537592d8b"],
 StyleBox[", where  ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["T", "^"], "1"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "c7d52bad-97e5-4579-a9dd-3bfcef2d2398"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["t", "i", "a"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "1abeba76-7293-41cf-adec-04882e96ddf5"],
 StyleBox[" and ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["T", "^"], "2"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "091fa20d-e0e1-4a7c-b34b-17cb82c01b48"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["t", "ij", "ab"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"], 
       SuperscriptBox[
        OverscriptBox["b", "^"], "\[Dagger]"], 
       OverscriptBox["j", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "7cb76ce2-00e4-4401-9b00-ecee22381bf7"],
 StyleBox["\n2. The EOMOperator is given by {{\[OpenCurlyDoubleQuote]1h1p\
\[CloseCurlyDoubleQuote]},{\[OpenCurlyDoubleQuote]2h2p\[CloseCurlyDoubleQuote]\
}} , that corresponds to ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["R", "^"], "=", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["R", "^"], "1"], "+", 
     SubscriptBox[
      OverscriptBox["R", "^"], "2"], " "}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "7edbc6d5-925c-45b5-81ed-58a0edde5048"],
 StyleBox[", where  ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["R", "^"], "1"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "e7f3917e-ba7f-4a7b-a317-38a28c751ce5"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["r", "i", "a"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "52f53681-90a2-4d94-91cb-0cd401ba8ea5"],
 StyleBox[" and ",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["R", "^"], "2"], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "0637b231-83af-4601-86ac-e416b4f1e9b5"],
 StyleBox["=",
  Background->RGBColor[0.9, 1, 1]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", 
     RowBox[{"a", ",", "i"}]], 
    RowBox[{
     SubsuperscriptBox["r", "ij", "ab"], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        OverscriptBox["a", "^"], "\[Dagger]"], 
       OverscriptBox["i", "^"], 
       SuperscriptBox[
        OverscriptBox["b", "^"], "\[Dagger]"], 
       OverscriptBox["j", "^"]}], "}"}]}]}], TraditionalForm]],
  Background->RGBColor[0.9, 1, 1],ExpressionUUID->
  "71e1fac8-5cbb-4f4e-a9f8-31f371f6073d"],
 "\n3. The parameter LeftRigthEOM establish if it is a right-hand side (",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    StyleBox["H",
     FontWeight->"Bold",
     FontSlant->"Plain"], "_"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "813c9cc4-2c22-4b99-bff0-c82af5342e20"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     StyleBox["r",
      FontWeight->"Bold",
      FontSlant->"Plain"], "k"], "=", 
    RowBox[{
     SubscriptBox["\[CapitalOmega]", "k"], 
     SubscriptBox[
      StyleBox["r",
       FontWeight->"Bold",
       FontSlant->"Plain"], "k"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "60850dfa-4fec-4683-978a-7daa016baf82"],
 ") or left hand-side  (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     StyleBox["l",
      FontWeight->"Bold",
      FontSlant->"Plain"], "k"], 
    OverscriptBox[
     StyleBox["H",
      FontWeight->"Bold",
      FontSlant->"Plain"], "_"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "4fd5f152-ca4e-449b-a71f-dc86dbddf7bf"],
 Cell[BoxData[
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox[
      StyleBox["l",
       FontWeight->"Bold",
       FontSlant->"Plain"], "k"], 
     SubscriptBox["\[CapitalOmega]", "k"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a45f6854-00d5-47d7-a5f4-075dc90eb79e"],
 ") eigenvalue equations and is either {\[OpenCurlyDoubleQuote]L\
\[CloseCurlyDoubleQuote]} for left-side or {\[OpenCurlyDoubleQuote]R\
\[CloseCurlyDoubleQuote]} for right side. In this case is {\
\[OpenCurlyDoubleQuote]L\[CloseCurlyDoubleQuote]}"
}], "Text",
 CellChangeTimes->{{3.887427592761385*^9, 3.887427677732684*^9}, {
   3.887427720661674*^9, 3.887427926139139*^9}, {3.887427969959711*^9, 
   3.887427972564579*^9}, {3.887428062263586*^9, 3.8874283967467422`*^9}, {
   3.887429267706176*^9, 3.887429274047916*^9}, {3.887429381622739*^9, 
   3.8874293936405487`*^9}, {3.887429536879528*^9, 3.887429611150378*^9}, {
   3.887444171146409*^9, 3.887444174118609*^9}, {3.890876486199564*^9, 
   3.890876521782057*^9}, {3.890876575941691*^9, 3.890876608445751*^9}, {
   3.893143978421328*^9, 3.8931439844895697`*^9}, {3.894601119297649*^9, 
   3.894601128489725*^9}, 3.894602017712585*^9, {3.8992672069377775`*^9, 
   3.899267217285536*^9}, {3.8992707295162067`*^9, 3.899270810836297*^9}, {
   3.8992709107506104`*^9, 3.8992709143046627`*^9}, {3.899270964826689*^9, 
   3.8992710644332204`*^9}, {3.899271299087552*^9, 3.899271408434558*^9}},
 Background->RGBColor[
  0.9, 1, 1],ExpressionUUID->"2e1db08c-bb24-4764-b7dd-ff3bc28d5712"],

Cell["Input", "Text",
 CellChangeTimes->{{3.8874300269168243`*^9, 3.887430028958555*^9}, {
  3.887430062945299*^9, 3.887430063920225*^9}},
 FontSize->24,
 FontWeight->"Bold",ExpressionUUID->"9f9d905a-02ba-4f2f-a42e-50133ea81940"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClusterOperator", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "\"\<1h1p\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<2h2p\>\"", "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EOMOperator", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "\"\<1h1p\>\"", "}"}], ",", 
     RowBox[{"{", "\"\<2h2p\>\"", "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LeftRigthEOM", "=", 
   RowBox[{"{", "\"\<L\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"EOMCCgen", "[", 
  RowBox[{"ClusterOperator", ",", "EOMOperator", ",", "LeftRigthEOM"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8873568308852587`*^9, 3.887356833993724*^9}, {
   3.887430435429474*^9, 3.887430436531063*^9}, {3.8908764687465677`*^9, 
   3.89087647954723*^9}, 3.893146690822248*^9, {3.8992017781478443`*^9, 
   3.8992017925649014`*^9}, 3.8992020937031317`*^9, 3.8992023002354975`*^9, {
   3.8992023785768623`*^9, 3.899202384705967*^9}, {3.89920854343778*^9, 
   3.899208544829161*^9}, {3.8992085816412535`*^9, 3.8992085821570005`*^9}, {
   3.8992095938761587`*^9, 3.899209594423427*^9}, {3.8992105683416853`*^9, 
   3.8992105688931837`*^9}, {3.8992115198743467`*^9, 3.89921152071994*^9}, {
   3.8992601915882*^9, 3.8992601925357575`*^9}, {3.899265930951471*^9, 
   3.899265931464155*^9}, 3.8992707080157313`*^9},
 CellLabel->
  "In[113]:=",ExpressionUUID->"d7ab83ee-36c3-4041-b5e4-94a00e4fba4c"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"Output\"\>",
  StripOnInput->False,
  FontSize->24,
  FontWeight->Bold]], "Print",
 CellChangeTimes->{{3.89874637655299*^9, 3.898746402688467*^9}, 
   3.898746522460187*^9, 3.8987465620431337`*^9, 3.8987470839570646`*^9, 
   3.8992017953698635`*^9, 3.899201843835621*^9, 3.899202036440138*^9, {
   3.8992020880887513`*^9, 3.8992020944912877`*^9}, 3.8992021776985364`*^9, 
   3.899202243034651*^9, 3.8992023008915977`*^9, {3.899202370634394*^9, 
   3.8992023855201535`*^9}, 3.899202501660928*^9, 3.899202596523346*^9, 
   3.8992084801196165`*^9, {3.899208515591901*^9, 3.899208545485196*^9}, 
   3.8992085831564665`*^9, 3.899208778723919*^9, {3.8992095809697275`*^9, 
   3.8992095994094114`*^9}, 3.8992105738461304`*^9, 3.899211491176545*^9, 
   3.8992115257860117`*^9, 3.8992563679097843`*^9, 3.89925727746766*^9, {
   3.8992601737507596`*^9, 3.899260193357189*^9}, 3.8992602530379076`*^9, {
   3.89926593867724*^9, 3.8992659557556686`*^9}, 3.8992659963166018`*^9, 
   3.8992660405917573`*^9, 3.8992662271843195`*^9, 3.8992663735878396`*^9, 
   3.899267170334112*^9, 3.8992707155913224`*^9},
 CellLabel->
  "During evaluation of \
In[113]:=",ExpressionUUID->"317261b6-2aa6-4249-9582-e5c93c29d601"],

Cell[BoxData[
 StyleBox["\<\"Execution Time\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{{3.89874637655299*^9, 3.898746402688467*^9}, 
   3.898746522460187*^9, 3.8987465620431337`*^9, 3.8987470839570646`*^9, 
   3.8992017953698635`*^9, 3.899201843835621*^9, 3.899202036440138*^9, {
   3.8992020880887513`*^9, 3.8992020944912877`*^9}, 3.8992021776985364`*^9, 
   3.899202243034651*^9, 3.8992023008915977`*^9, {3.899202370634394*^9, 
   3.8992023855201535`*^9}, 3.899202501660928*^9, 3.899202596523346*^9, 
   3.8992084801196165`*^9, {3.899208515591901*^9, 3.899208545485196*^9}, 
   3.8992085831564665`*^9, 3.899208778723919*^9, {3.8992095809697275`*^9, 
   3.8992095994094114`*^9}, 3.8992105738461304`*^9, 3.899211491176545*^9, 
   3.8992115257860117`*^9, 3.8992563679097843`*^9, 3.89925727746766*^9, {
   3.8992601737507596`*^9, 3.899260193357189*^9}, 3.8992602530379076`*^9, {
   3.89926593867724*^9, 3.8992659557556686`*^9}, 3.8992659963166018`*^9, 
   3.8992660405917573`*^9, 3.8992662271843195`*^9, 3.8992663735878396`*^9, 
   3.899267170334112*^9, 3.8992707156219935`*^9},
 CellLabel->
  "During evaluation of \
In[113]:=",ExpressionUUID->"8e80ac26-8380-4f36-ae26-edd5b344226a"],

Cell[BoxData[
 RowBox[{"{", "3.21875`", "}"}]], "Print",
 CellChangeTimes->{{3.89874637655299*^9, 3.898746402688467*^9}, 
   3.898746522460187*^9, 3.8987465620431337`*^9, 3.8987470839570646`*^9, 
   3.8992017953698635`*^9, 3.899201843835621*^9, 3.899202036440138*^9, {
   3.8992020880887513`*^9, 3.8992020944912877`*^9}, 3.8992021776985364`*^9, 
   3.899202243034651*^9, 3.8992023008915977`*^9, {3.899202370634394*^9, 
   3.8992023855201535`*^9}, 3.899202501660928*^9, 3.899202596523346*^9, 
   3.8992084801196165`*^9, {3.899208515591901*^9, 3.899208545485196*^9}, 
   3.8992085831564665`*^9, 3.899208778723919*^9, {3.8992095809697275`*^9, 
   3.8992095994094114`*^9}, 3.8992105738461304`*^9, 3.899211491176545*^9, 
   3.8992115257860117`*^9, 3.8992563679097843`*^9, 3.89925727746766*^9, {
   3.8992601737507596`*^9, 3.899260193357189*^9}, 3.8992602530379076`*^9, {
   3.89926593867724*^9, 3.8992659557556686`*^9}, 3.8992659963166018`*^9, 
   3.8992660405917573`*^9, 3.8992662271843195`*^9, 3.8992663735878396`*^9, 
   3.899267170334112*^9, 3.8992707156376915`*^9},
 CellLabel->
  "During evaluation of \
In[113]:=",ExpressionUUID->"f9f447aa-9d96-4277-9fcc-09f8a18f4a33"],

Cell[BoxData[
 StyleBox["\<\"Many-body terms\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{{3.89874637655299*^9, 3.898746402688467*^9}, 
   3.898746522460187*^9, 3.8987465620431337`*^9, 3.8987470839570646`*^9, 
   3.8992017953698635`*^9, 3.899201843835621*^9, 3.899202036440138*^9, {
   3.8992020880887513`*^9, 3.8992020944912877`*^9}, 3.8992021776985364`*^9, 
   3.899202243034651*^9, 3.8992023008915977`*^9, {3.899202370634394*^9, 
   3.8992023855201535`*^9}, 3.899202501660928*^9, 3.899202596523346*^9, 
   3.8992084801196165`*^9, {3.899208515591901*^9, 3.899208545485196*^9}, 
   3.8992085831564665`*^9, 3.899208778723919*^9, {3.8992095809697275`*^9, 
   3.8992095994094114`*^9}, 3.8992105738461304`*^9, 3.899211491176545*^9, 
   3.8992115257860117`*^9, 3.8992563679097843`*^9, 3.89925727746766*^9, {
   3.8992601737507596`*^9, 3.899260193357189*^9}, 3.8992602530379076`*^9, {
   3.89926593867724*^9, 3.8992659557556686`*^9}, 3.8992659963166018`*^9, 
   3.8992660405917573`*^9, 3.8992662271843195`*^9, 3.8992663735878396`*^9, 
   3.899267170334112*^9, 3.899270715653299*^9},
 CellLabel->
  "During evaluation of \
In[113]:=",ExpressionUUID->"56c570b5-941a-4d66-9ca0-9d1f20cbf914"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h3"}], "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "h3"}], "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "v1", ",", "h3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h3", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"p3", ",", "p1"}], "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"F", "\[LeftDoubleBracket]", 
         RowBox[{"p3", ",", "p1"}], "\[RightDoubleBracket]"}], "-", 
        RowBox[{
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p3"}], "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p3", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p3", ",", "h3", ",", "p1"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "h3", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h1", ",", "p3", ",", "h3", ",", "p1"}], 
         "\[RightDoubleBracket]"}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "p3", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h3", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p2"}], "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"F", "\[LeftDoubleBracket]", 
         RowBox[{"h2", ",", "p2"}], "\[RightDoubleBracket]"}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "o1", ",", "v1", ",", "p2"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h1", ",", "h3", ",", "p2"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h2", ",", "h1", ",", "h3", ",", "p2"}], 
         "\[RightDoubleBracket]"}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "h1", ",", "v1", ",", "p2"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p3", ",", "p2", ",", "p1"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"t1", "\[LeftDoubleBracket]", 
           RowBox[{"o1", ",", "p3"}], "\[RightDoubleBracket]"}]}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "o1", ",", "p2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h2", ",", "p3", ",", "p2", ",", "p1"}], 
         "\[RightDoubleBracket]"}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p4", ",", "h4", ",", "h3"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p4"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "h3", ",", "h4"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p4"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "v1", ",", "h3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p4"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "v1", ",", "h4"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "v2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p4"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h1", ",", "p4", ",", "h3", ",", "h4"}], 
         "\[RightDoubleBracket]"}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "p4", ",", "v1", ",", "h3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "p4", ",", "v1", ",", "h4"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "v2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "p4", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "h4", ",", "v1", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p4"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "h4", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "p4", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "h4", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "h4", ",", "v2", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "v1", ",", "h4"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h3", ",", "v1", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h3", ",", "v2", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "v1", ",", "h3"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h4", ",", "v1", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h4", ",", "v2", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"p4", ",", "p3", ",", "h4", ",", "p1"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p4"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "h4", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p4"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p4"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p3", ",", "h4", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p4"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p3", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p4", ",", "h4", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p4", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"p4", ",", "p3", ",", "h4", ",", "p1"}], 
         "\[RightDoubleBracket]"}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"p4", ",", "p3", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"F", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h4", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p4", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h4", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p3", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h4", ",", "v1", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "h4", ",", "p1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "h4", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p4"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "h4", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "h4", ",", "v1", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p4", ",", "p3", ",", "h4", ",", "h3", ",", "p1"}],
         "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"t1", "\[LeftDoubleBracket]", 
           RowBox[{"o1", ",", "p4"}], "\[RightDoubleBracket]"}]}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "h4", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "p4", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "h4", ",", "v1", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "h4", ",", "v1", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "p3", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "h4", ",", "v1", ",", "p4"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "h4", ",", "p1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h3", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h3", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "h3", ",", "p1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h4", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h1", ",", "o1", ",", "v1", ",", "p1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "h4", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h1", ",", "h4", ",", "h3"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "h1", ",", "h3", ",", "h4"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "h1", ",", "v1", ",", "h3"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "h1", ",", "v1", ",", "h4"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "v1"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"h4", ",", "v2"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "h1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"h2", ",", "h1", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"h3", ",", "h4", ",", "v1", ",", "v2"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"p4", ",", "p3", ",", "p2", ",", "p1"}], 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p4"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o2", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "p2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p4"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p3", ",", "p2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{
         RowBox[{"t1", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "p4", ",", "p2", ",", "p1"}], 
          "\[RightDoubleBracket]"}]}], "+", 
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"p4", ",", "p3", ",", "p2", ",", "p1"}], 
         "\[RightDoubleBracket]"}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"ERI", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "p2", ",", "p1"}], 
          "\[RightDoubleBracket]"}], " ", 
         RowBox[{"t2", "\[LeftDoubleBracket]", 
          RowBox[{"o1", ",", "o2", ",", "p4", ",", "p3"}], 
          "\[RightDoubleBracket]"}]}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h1", ",", "p4", ",", "h4", ",", "h3", ",", "p2"}],
         "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h2", ",", "h1", ",", "v1", ",", "p2"}], 
         "\[RightDoubleBracket]"}], " ", 
        RowBox[{"t2", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "h4", ",", "v1", ",", "p4"}], 
         "\[RightDoubleBracket]"}]}]}]},
     {
      RowBox[{
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p4", ",", "p3", ",", "h4", ",", "p2", ",", "p1"}],
         "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"ERI", "\[LeftDoubleBracket]", 
         RowBox[{"h2", ",", "o1", ",", "p2", ",", "p1"}], 
         "\[RightDoubleBracket]"}], " ", 
        RowBox[{"t2", "\[LeftDoubleBracket]", 
         RowBox[{"o1", ",", "h4", ",", "p4", ",", "p3"}], 
         "\[RightDoubleBracket]"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.89874637655299*^9, 3.898746402688467*^9}, 
   3.898746522460187*^9, 3.8987465620431337`*^9, 3.8987470839570646`*^9, 
   3.8992017953698635`*^9, 3.899201843835621*^9, 3.899202036440138*^9, {
   3.8992020880887513`*^9, 3.8992020944912877`*^9}, 3.8992021776985364`*^9, 
   3.899202243034651*^9, 3.8992023008915977`*^9, {3.899202370634394*^9, 
   3.8992023855201535`*^9}, 3.899202501660928*^9, 3.899202596523346*^9, 
   3.8992084801196165`*^9, {3.899208515591901*^9, 3.899208545485196*^9}, 
   3.8992085831564665`*^9, 3.899208778723919*^9, {3.8992095809697275`*^9, 
   3.8992095994094114`*^9}, 3.8992105738461304`*^9, 3.899211491176545*^9, 
   3.8992115257860117`*^9, 3.8992563679097843`*^9, 3.89925727746766*^9, {
   3.8992601737507596`*^9, 3.899260193357189*^9}, 3.8992602530379076`*^9, {
   3.89926593867724*^9, 3.8992659557556686`*^9}, 3.8992659963166018`*^9, 
   3.8992660405917573`*^9, 3.8992662271843195`*^9, 3.8992663735878396`*^9, 
   3.899267170334112*^9, 3.8992707157478433`*^9},
 CellLabel->
  "During evaluation of \
In[113]:=",ExpressionUUID->"3e1ec056-6371-4ce8-b899-3fed5226d643"],

Cell[BoxData[
 StyleBox["\<\"EOM-CC equations\"\>",
  StripOnInput->False,
  LineColor->RGBColor[0, 0, 1],
  FrontFaceColor->RGBColor[0, 0, 1],
  BackFaceColor->RGBColor[0, 0, 1],
  GraphicsColor->RGBColor[0, 0, 1],
  FontWeight->Bold,
  FontColor->RGBColor[0, 0, 1]]], "Print",
 CellChangeTimes->{{3.89874637655299*^9, 3.898746402688467*^9}, 
   3.898746522460187*^9, 3.8987465620431337`*^9, 3.8987470839570646`*^9, 
   3.8992017953698635`*^9, 3.899201843835621*^9, 3.899202036440138*^9, {
   3.8992020880887513`*^9, 3.8992020944912877`*^9}, 3.8992021776985364`*^9, 
   3.899202243034651*^9, 3.8992023008915977`*^9, {3.899202370634394*^9, 
   3.8992023855201535`*^9}, 3.899202501660928*^9, 3.899202596523346*^9, 
   3.8992084801196165`*^9, {3.899208515591901*^9, 3.899208545485196*^9}, 
   3.8992085831564665`*^9, 3.899208778723919*^9, {3.8992095809697275`*^9, 
   3.8992095994094114`*^9}, 3.8992105738461304`*^9, 3.899211491176545*^9, 
   3.8992115257860117`*^9, 3.8992563679097843`*^9, 3.89925727746766*^9, {
   3.8992601737507596`*^9, 3.899260193357189*^9}, 3.8992602530379076`*^9, {
   3.89926593867724*^9, 3.8992659557556686`*^9}, 3.8992659963166018`*^9, 
   3.8992660405917573`*^9, 3.8992662271843195`*^9, 3.8992663735878396`*^9, 
   3.899267170334112*^9, 3.899270715763507*^9},
 CellLabel->
  "During evaluation of \
In[113]:=",ExpressionUUID->"26ab97c5-c949-4e13-9c1c-91b79159b36d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h3"}], "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"p3", ",", "p1"}], "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p3", ",", "h3", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p1"}], "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p2"}], "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p1"}], "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p2"}], "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p3", ",", "p2", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h1", ",", "h3", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h1", ",", "h3", ",", "p2"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p3"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p3", ",", "p2", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"l", "\[LeftDoubleBracket]", 
         RowBox[{"h3", ",", "h4", ",", "p3", ",", "p1"}], 
         "\[RightDoubleBracket]"}]}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p3", ",", "h4", ",", "h3"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h4", ",", "p1", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p4", ",", "h4", ",", "h3"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h1", ",", "p3", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"p4", ",", "p3", ",", "h3", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h4", ",", "p3", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"p4", ",", "p3", ",", "h4", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h4", ",", "p3", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p4", ",", "p3", ",", "h4", ",", "h3", ",", "p1"}],
         "\[RightDoubleBracket]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"p4", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h2", ",", "p1", ",", "p4"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"p4", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h2", ",", "p2", ",", "p4"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"p3", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h2", ",", "p3", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"p3", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h2", ",", "p3", ",", "p2"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h4"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h4", ",", "p1", ",", "p2"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h4"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h4", ",", "p2", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"p4", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h1", ",", "p1", ",", "p4"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"p4", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h1", ",", "p2", ",", "p4"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"p3", ",", "p2"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h1", ",", "p3", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"p3", ",", "p1"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h1", ",", "p3", ",", "p2"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h4"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h4", ",", "p1", ",", "p2"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h4"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h4", ",", "p2", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h3"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h1", ",", "p1", ",", "p2"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h3"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h1", ",", "p2", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h3"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h2", ",", "p1", ",", "p2"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"\[Chi]1", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h3"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h2", ",", "p2", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h2", ",", "p3", ",", "p2"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p3", ",", "h3", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h2", ",", "p3", ",", "p1"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p3", ",", "h3", ",", "p2"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h4", ",", "p3", ",", "p2"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p3", ",", "h4", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h4", ",", "p3", ",", "p1"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p3", ",", "h4", ",", "p2"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h2", ",", "p2", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p4", ",", "h3", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h2", ",", "p1", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p4", ",", "h3", ",", "p2"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h4", ",", "p2", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p4", ",", "h4", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h4", ",", "p1", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p4", ",", "h4", ",", "p2"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h4", ",", "p1", ",", "p2"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h1", ",", "h4", ",", "h3"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h4", ",", "p2", ",", "p1"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h1", ",", "h4", ",", "h3"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h1", ",", "p3", ",", "p2"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p3", ",", "h3", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h1", ",", "p3", ",", "p1"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p3", ",", "h3", ",", "p2"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h4", ",", "p3", ",", "p2"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p3", ",", "h4", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h4", ",", "p3", ",", "p1"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p3", ",", "h4", ",", "p2"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h1", ",", "p2", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p4", ",", "h3", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h1", ",", "p1", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p4", ",", "h3", ",", "p2"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h4", ",", "p2", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p4", ",", "h4", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h4", ",", "p1", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p4", ",", "h4", ",", "p2"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h2", ",", "p3", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"p4", ",", "p3", ",", "p2", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h1", ",", "p3", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]2", "\[LeftDoubleBracket]", 
        RowBox[{"p4", ",", "p3", ",", "p2", ",", "p1"}], 
        "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h2", ",", "p3", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p4", ",", "p3", ",", "h3", ",", "p2", ",", "p1"}],
         "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h4", ",", "p3", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "p4", ",", "p3", ",", "h4", ",", "p2", ",", "p1"}],
         "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h4", ",", "p3", ",", "p2"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h1", ",", "p3", ",", "h4", ",", "h3", ",", "p1"}],
         "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h4", ",", "p3", ",", "p1"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h1", ",", "p3", ",", "h4", ",", "h3", ",", "p2"}],
         "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h4", ",", "p2", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h1", ",", "p4", ",", "h4", ",", "h3", ",", "p1"}],
         "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h4", ",", "p1", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "h1", ",", "p4", ",", "h4", ",", "h3", ",", "p2"}],
         "\[RightDoubleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h3", ",", "h1", ",", "p3", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p4", ",", "p3", ",", "h3", ",", "p2", ",", "p1"}],
         "\[RightDoubleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", 
        RowBox[{"h1", ",", "h4", ",", "p3", ",", "p4"}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"\[Chi]3", "\[LeftDoubleBracket]", 
        RowBox[{"h2", ",", "p4", ",", "p3", ",", "h4", ",", "p2", ",", "p1"}],
         "\[RightDoubleBracket]"}]}]}]}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.89874637655299*^9, 3.898746402688467*^9}, 
   3.898746522460187*^9, 3.8987465620431337`*^9, 3.8987470839570646`*^9, 
   3.8992017953698635`*^9, 3.899201843835621*^9, 3.899202036440138*^9, {
   3.8992020880887513`*^9, 3.8992020944912877`*^9}, 3.8992021776985364`*^9, 
   3.899202243034651*^9, 3.8992023008915977`*^9, {3.899202370634394*^9, 
   3.8992023855201535`*^9}, 3.899202501660928*^9, 3.899202596523346*^9, 
   3.8992084801196165`*^9, {3.899208515591901*^9, 3.899208545485196*^9}, 
   3.8992085831564665`*^9, 3.899208778723919*^9, {3.8992095809697275`*^9, 
   3.8992095994094114`*^9}, 3.8992105738461304`*^9, 3.899211491176545*^9, 
   3.8992115257860117`*^9, 3.8992563679097843`*^9, 3.89925727746766*^9, {
   3.8992601737507596`*^9, 3.899260193357189*^9}, 3.8992602530379076`*^9, {
   3.89926593867724*^9, 3.8992659557556686`*^9}, 3.8992659963166018`*^9, 
   3.8992660405917573`*^9, 3.8992662271843195`*^9, 3.8992663735878396`*^9, 
   3.899267170334112*^9, 3.899270715826016*^9},
 CellLabel->
  "During evaluation of \
In[113]:=",ExpressionUUID->"79dde96c-28b3-46e7-85d8-6460a8ece970"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{742.6666666666666, 460.3333333333333},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>0.75 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3b353370-a811-443f-9aa0-f7a1bba5b481"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 539, 8, 74, "Title",ExpressionUUID->"60337e77-32f7-4c0c-ad67-85dc0cdc42d1"],
Cell[CellGroupData[{
Cell[986, 27, 593, 9, 50, "Section",ExpressionUUID->"1b8c064c-e9a6-48fb-b021-965f16e7d98c"],
Cell[1582, 38, 8747, 219, 391, "Input",ExpressionUUID->"3f0aec66-9050-44b2-ae2c-5c06ec05ac87",
 InitializationCell->True],
Cell[10332, 259, 12902, 300, 435, "Input",ExpressionUUID->"640196ee-c3f9-4f5b-a744-91a3bfc0728c",
 InitializationCell->True],
Cell[23237, 561, 2787, 73, 138, "Input",ExpressionUUID->"d84f8c34-9ce1-486e-b049-5642d8cbda76",
 InitializationCell->True],
Cell[26027, 636, 14834, 306, 478, "Input",ExpressionUUID->"ad2d5759-89d8-40d3-a748-224610d23fcc",
 InitializationCell->True],
Cell[40864, 944, 12603, 308, 549, "Input",ExpressionUUID->"8815d0e0-14e8-4c59-8dc4-657854ebcb50",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[53504, 1257, 630, 10, 40, "Section",ExpressionUUID->"45305d48-fb62-4d1f-b210-5af8db641bcf",
 InitializationCell->True],
Cell[54137, 1269, 784, 15, 36, "Input",ExpressionUUID->"273c427f-a4ec-4188-91d7-53b2719b7f78"],
Cell[54924, 1286, 35012, 821, 1339, "Input",ExpressionUUID->"ca81e8f7-53c9-4895-bc77-7844713abb6f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[89973, 2112, 613, 10, 40, "Section",ExpressionUUID->"5c729b93-e4ec-40a4-bfbd-8ff5fa424dcf",
 InitializationCell->True],
Cell[90589, 2124, 1076, 26, 38, "Input",ExpressionUUID->"3f09b14d-1926-4c2f-8030-c8d745e0bf99"],
Cell[91668, 2152, 114198, 2752, 3778, "Input",ExpressionUUID->"86f446cc-8121-424b-969b-991b96e89d63",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[205903, 4909, 960, 14, 40, "Section",ExpressionUUID->"e9f99a08-7c66-4f0d-adeb-d35819a90a9c",
 InitializationCell->True],
Cell[206866, 4925, 1096, 19, 39, "Input",ExpressionUUID->"9d08ad4c-3daf-4aab-b14e-7fac1e7f4a5d"],
Cell[207965, 4946, 132832, 3088, 4799, "Input",ExpressionUUID->"6b94466e-ee05-47fe-8420-3fe5ab532013",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[340834, 8039, 847, 12, 40, "Section",ExpressionUUID->"50eb3c8a-6bf8-4e01-962a-e0b58ba5593e"],
Cell[341684, 8053, 1261, 24, 50, "Input",ExpressionUUID->"72a1b8a2-95fe-4b33-bca5-82c82d046a4d"],
Cell[342948, 8079, 82512, 1853, 2860, "Input",ExpressionUUID->"9f77d3e4-ac51-400e-83be-172117124189",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[425497, 9937, 698, 10, 40, "Section",ExpressionUUID->"351db9bb-909a-4a9c-96a1-272ff932ba99"],
Cell[426198, 9949, 30174, 613, 1370, "Input",ExpressionUUID->"9e1d04a3-6cb2-4f75-8861-15f7054ac7bb",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[456421, 10568, 424, 7, 74, "Title",ExpressionUUID->"7833764b-06d7-45d1-9ddc-c3dcd8835ec3"],
Cell[CellGroupData[{
Cell[456870, 10579, 812, 12, 50, "Section",ExpressionUUID->"05022f5c-a52a-42b4-a6eb-7344c2d1674d"],
Cell[457685, 10593, 3404, 90, 81, "Text",ExpressionUUID->"53f85e67-6539-4c18-a0de-ef183208db53"],
Cell[461092, 10685, 229, 4, 34, "Text",ExpressionUUID->"1c77776e-de80-4cb4-b29d-6bbff4c60edb"],
Cell[CellGroupData[{
Cell[461346, 10693, 1145, 21, 50, "Input",ExpressionUUID->"91acfede-76ae-4a7a-92d3-619d888343e0"],
Cell[CellGroupData[{
Cell[462516, 10718, 613, 13, 27, "Print",ExpressionUUID->"09e0d105-b512-4eed-a453-24fc510f4a11"],
Cell[463132, 10733, 776, 17, 18, "Print",ExpressionUUID->"4c399562-a8b0-4902-93cd-3cef8ef4f365"],
Cell[463911, 10752, 557, 10, 18, "Print",ExpressionUUID->"75b1f050-88d6-4a87-8cdc-2474a3a35396"],
Cell[464471, 10764, 776, 17, 18, "Print",ExpressionUUID->"6fd47919-d3f0-4aaf-be74-e802c1711a73"],
Cell[465250, 10783, 753, 16, 18, "Print",ExpressionUUID->"fd5a1cf5-dff1-4ca9-bb2d-56c74daf5082"],
Cell[466006, 10801, 822, 17, 31, "Print",ExpressionUUID->"0f5db609-34a5-4737-8744-3bdce44402c3"],
Cell[466831, 10820, 764, 16, 18, "Print",ExpressionUUID->"242bcb64-a1c8-4759-8f07-138f67baa8be"],
Cell[467598, 10838, 6821, 159, 172, "Print",ExpressionUUID->"0d0340a4-9f9f-4da6-a14b-e1a8fef06ad4"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[474480, 11004, 791, 12, 40, "Section",ExpressionUUID->"180f5b0c-6cc6-4b38-8aab-7561c8d2485a"],
Cell[475274, 11018, 3264, 88, 81, "Text",ExpressionUUID->"18a773b2-5d2f-4378-8b1b-ab0884b13e9a"],
Cell[478541, 11108, 229, 4, 34, "Text",ExpressionUUID->"510eee9c-0c11-4493-a09c-9d55e746f315"],
Cell[478773, 11114, 1081, 22, 50, "Input",ExpressionUUID->"ef2686b3-12e1-4801-a55c-d8d1e110ce87"]
}, Closed]],
Cell[CellGroupData[{
Cell[479891, 11141, 816, 12, 40, "Section",ExpressionUUID->"bcca9391-f3da-40f2-8e38-11681bef3eb3"],
Cell[480710, 11155, 4365, 119, 104, "Text",ExpressionUUID->"83e09209-0efb-4d02-ae4b-f51fe4f9a94e"],
Cell[485078, 11276, 229, 4, 34, "Text",ExpressionUUID->"bb809c17-2639-4de4-8c2e-7c9a8e728969"],
Cell[485310, 11282, 664, 18, 50, "Input",ExpressionUUID->"506e786c-58f3-4806-af8e-e85fbd536799"]
}, Closed]],
Cell[CellGroupData[{
Cell[486011, 11305, 772, 11, 40, "Section",ExpressionUUID->"d88c5ff0-3500-41a1-aa56-9372e73fa004"],
Cell[486786, 11318, 4982, 145, 85, "Text",ExpressionUUID->"e2ecaeea-17a5-4677-872a-5e6992438576"],
Cell[491771, 11465, 229, 4, 34, "Text",ExpressionUUID->"3ab88cab-c381-4bff-bdb0-362816892b7e"],
Cell[CellGroupData[{
Cell[492025, 11473, 817, 20, 50, "Input",ExpressionUUID->"7a8e687c-c07a-43ed-b4df-2d0e3ff95ad6"],
Cell[CellGroupData[{
Cell[492867, 11497, 334, 9, 27, "Print",ExpressionUUID->"f14bca08-a080-440e-b6b3-e8671b8e12f2"],
Cell[493204, 11508, 499, 13, 18, "Print",ExpressionUUID->"bd374033-5588-46ac-bf0a-8da3fb5a0ab3"],
Cell[493706, 11523, 280, 6, 18, "Print",ExpressionUUID->"6d4da930-ea91-46b4-9070-fe3ec4ecaec0"],
Cell[493989, 11531, 500, 13, 18, "Print",ExpressionUUID->"47ef3353-6bcf-4c76-98a7-2f7c1eb0d183"],
Cell[494492, 11546, 27175, 590, 216, "Print",ExpressionUUID->"1b67d98f-a5a7-47b2-ae71-9aee1697fc0e"],
Cell[521670, 12138, 501, 13, 18, "Print",ExpressionUUID->"95851ad1-1953-40aa-97d1-c49dc005b412"],
Cell[522174, 12153, 23384, 614, 288, "Print",ExpressionUUID->"d8139c05-ffcd-40e3-8939-d2233eaaed17"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[545619, 12774, 824, 12, 40, "Section",ExpressionUUID->"c061895f-84f6-4a30-b78a-fa6a2f12f5a8"],
Cell[546446, 12788, 4894, 140, 84, "Text",ExpressionUUID->"18ab3d57-a769-4214-bae1-4f88692bb65a"],
Cell[551343, 12930, 229, 4, 34, "Text",ExpressionUUID->"cfabcbeb-6859-4196-91c3-5b0890c48b65"],
Cell[CellGroupData[{
Cell[551597, 12938, 869, 22, 50, "Input",ExpressionUUID->"21384d8f-23b4-45a5-b3b9-5de401fde13d"],
Cell[CellGroupData[{
Cell[552491, 12964, 284, 8, 27, "Print",ExpressionUUID->"5916bbe0-a460-4dc3-8b77-a9c3c273f188"],
Cell[552778, 12974, 449, 12, 18, "Print",ExpressionUUID->"2bc9c952-f0f8-4edf-8b8e-d3ad5bb8257c"],
Cell[553230, 12988, 228, 5, 18, "Print",ExpressionUUID->"528f9eff-e4cd-4663-a099-e035823fc16c"],
Cell[553461, 12995, 448, 12, 18, "Print",ExpressionUUID->"0adf0242-6fd6-4266-8a1a-50630dc7d75b"],
Cell[553912, 13009, 14925, 327, 137, "Print",ExpressionUUID->"2411ef38-0ae3-4a07-a5fb-a479c46cd9b6"],
Cell[568840, 13338, 451, 12, 18, "Print",ExpressionUUID->"54a9d160-a85a-4e95-a93a-97fa36647bd6"],
Cell[569294, 13352, 4997, 134, 63, "Print",ExpressionUUID->"1661ec3e-91b2-401e-b53b-cf0da46cd2a2"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[574352, 13493, 849, 12, 40, "Section",ExpressionUUID->"9305573d-67c7-4786-9711-8a6519bc635c"],
Cell[575204, 13507, 5054, 144, 84, "Text",ExpressionUUID->"673bfef8-56f6-427e-9460-2781c6f446ff"],
Cell[580261, 13653, 229, 4, 34, "Text",ExpressionUUID->"9571b3eb-a4a5-430f-b3e1-98d470a65c01"],
Cell[CellGroupData[{
Cell[580515, 13661, 895, 22, 50, "Input",ExpressionUUID->"c52d5431-f4f9-4514-8586-9a34ea0bcbee"],
Cell[CellGroupData[{
Cell[581435, 13687, 284, 8, 27, "Print",ExpressionUUID->"9fcdaa09-6ceb-4167-95ec-c6d9a0cf7851"],
Cell[581722, 13697, 449, 12, 18, "Print",ExpressionUUID->"ed06d3cf-0518-47e5-8b29-46343d185faa"],
Cell[582174, 13711, 229, 5, 18, "Print",ExpressionUUID->"91aecc64-6311-4143-abe6-246e2f4635bb"],
Cell[582406, 13718, 452, 12, 18, "Print",ExpressionUUID->"b64a5798-9aa0-44a1-9749-7900c2d5c6bc"],
Cell[582861, 13732, 17431, 381, 149, "Print",ExpressionUUID->"ed5e6cde-6d1c-4a75-a1d8-6b88383e05b2"],
Cell[600295, 14115, 453, 12, 18, "Print",ExpressionUUID->"b101024e-b540-4213-a6d7-a1f23b845ece"],
Cell[600751, 14129, 30912, 856, 318, "Print",ExpressionUUID->"315c9e30-f1f3-4a2e-8562-f7f509548f5f"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[631724, 14992, 1607, 30, 45, "Section",ExpressionUUID->"872d938d-6067-43ba-9b44-d0d02fd01b54"],
Cell[633334, 15024, 5643, 157, 128, "Text",ExpressionUUID->"8140ee5f-c240-43b2-96ca-79a58b4bc4d1"],
Cell[638980, 15183, 229, 4, 34, "Text",ExpressionUUID->"263849d7-0049-4d14-8896-c0af058429e2"],
Cell[CellGroupData[{
Cell[639234, 15191, 1128, 28, 64, "Input",ExpressionUUID->"54a2f717-a5b6-4d2f-8130-910cd43638aa"],
Cell[CellGroupData[{
Cell[640387, 15223, 307, 9, 27, "Print",ExpressionUUID->"3314c020-b6d8-4af7-a311-09c6b84881cb"],
Cell[640697, 15234, 472, 13, 18, "Print",ExpressionUUID->"9ae7bd5f-a0e8-4782-ad6a-e149a3b8817b"],
Cell[641172, 15249, 254, 6, 18, "Print",ExpressionUUID->"7f698c93-1f03-4502-948f-5a5a419e7d33"],
Cell[641429, 15257, 475, 13, 18, "Print",ExpressionUUID->"0e98682d-4144-4fe0-ba33-d5582054ec54"],
Cell[641907, 15272, 7708, 174, 91, "Print",ExpressionUUID->"72953571-3bd1-4b03-a588-9544ea3b9a27"],
Cell[649618, 15448, 476, 13, 18, "Print",ExpressionUUID->"ecf5bedc-51b9-445d-bc0d-a416cd22a9f2"],
Cell[650097, 15463, 3932, 106, 48, "Print",ExpressionUUID->"c0875e17-7cb4-4032-8c70-3840ad82648c"]
}, Open  ]]
}, Open  ]],
Cell[654056, 15573, 355, 6, 21, "Input",ExpressionUUID->"1f5478b1-7dee-4b11-a50c-4f6ae98d2e71"]
}, Closed]],
Cell[CellGroupData[{
Cell[654448, 15584, 1369, 26, 46, "Section",ExpressionUUID->"9b7c84b1-75ef-4661-b553-be68bcdef511"],
Cell[655820, 15612, 5161, 137, 154, "Text",ExpressionUUID->"d334f8c7-ad1c-4f3f-b249-514123bfeb5a"],
Cell[660984, 15751, 229, 4, 34, "Text",ExpressionUUID->"ff747f9b-bd7d-460e-864e-1afdeeed9688"],
Cell[CellGroupData[{
Cell[661238, 15759, 1507, 43, 66, "Input",ExpressionUUID->"d030f460-3e65-47f6-9ea7-c0ec0d19b77f"],
Cell[CellGroupData[{
Cell[662770, 15806, 808, 15, 27, "Print",ExpressionUUID->"22830975-68e4-4c1d-9af2-04f73d1a4d11"],
Cell[663581, 15823, 973, 19, 18, "Print",ExpressionUUID->"9baee5e9-7ad4-4b29-b3ab-432a6cfddb8e"],
Cell[664557, 15844, 754, 12, 18, "Print",ExpressionUUID->"4cfbfc2c-c8de-4369-9aa6-84c6b72be4c6"],
Cell[665314, 15858, 974, 19, 18, "Print",ExpressionUUID->"01de4fad-0743-492c-8ebd-085c786cc7ed"],
Cell[666291, 15879, 7833, 167, 37, "Print",ExpressionUUID->"77e045bc-e724-4179-97e8-8e8a6d3035f8"]
}, Open  ]]
}, Open  ]],
Cell[674151, 16050, 129, 3, 21, "Input",ExpressionUUID->"23e67742-4882-4af1-9917-4f0a2b19831b"]
}, Closed]],
Cell[CellGroupData[{
Cell[674317, 16058, 1082, 16, 40, "Section",ExpressionUUID->"2ae60356-2566-4b17-a6c0-8526567dd940"],
Cell[675402, 16076, 4337, 112, 76, "Text",ExpressionUUID->"bdcdf471-9ffb-42bf-9b1b-81dbbf8a4600"],
Cell[679742, 16190, 229, 4, 34, "Text",ExpressionUUID->"835aa760-0d7c-4113-a810-cd188079d28f"],
Cell[CellGroupData[{
Cell[679996, 16198, 1302, 31, 38, "Input",ExpressionUUID->"826f49a1-ffa2-4f41-9a58-968da73533fb"],
Cell[CellGroupData[{
Cell[681323, 16233, 308, 9, 27, "Print",ExpressionUUID->"363f6db1-0d8a-49f6-bc16-14f64ffcec8e"],
Cell[681634, 16244, 489, 13, 18, "Print",ExpressionUUID->"16237d52-a7de-48e5-90b9-793deb6ed076"]
}, Open  ]],
Cell[682138, 16260, 8313, 270, 132, "Output",ExpressionUUID->"dd48c20b-52b3-40bd-a0ed-782977ccb1e9"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[690500, 16536, 954, 14, 40, "Section",ExpressionUUID->"e9d120b0-f171-4e2c-9612-fcb1ed404546"],
Cell[691457, 16552, 6888, 201, 121, "Text",ExpressionUUID->"2e1db08c-bb24-4764-b7dd-ff3bc28d5712"],
Cell[698348, 16755, 229, 4, 34, "Text",ExpressionUUID->"9f9d905a-02ba-4f2f-a42e-50133ea81940"],
Cell[CellGroupData[{
Cell[698602, 16763, 1461, 32, 64, "Input",ExpressionUUID->"d7ab83ee-36c3-4041-b5e4-94a00e4fba4c"],
Cell[CellGroupData[{
Cell[700088, 16799, 1226, 21, 27, "Print",ExpressionUUID->"317261b6-2aa6-4249-9582-e5c93c29d601"],
Cell[701317, 16822, 1391, 25, 18, "Print",ExpressionUUID->"8e80ac26-8380-4f36-ae26-edd5b344226a"],
Cell[702711, 16849, 1171, 18, 18, "Print",ExpressionUUID->"f9f447aa-9d96-4277-9fcc-09f8a18f4a33"],
Cell[703885, 16869, 1390, 25, 18, "Print",ExpressionUUID->"56c570b5-941a-4d66-9ca0-9d1f20cbf914"],
Cell[705278, 16896, 28065, 602, 216, "Print",ExpressionUUID->"3e1ec056-6371-4ce8-b899-3fed5226d643"],
Cell[733346, 17500, 1391, 25, 18, "Print",ExpressionUUID->"26ab97c5-c949-4e13-9c1c-91b79159b36d"],
Cell[734740, 17527, 19168, 415, 267, "Print",ExpressionUUID->"79dde96c-28b3-46e7-85d8-6460a8ece970"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

